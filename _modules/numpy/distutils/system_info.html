

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>numpy.distutils.system_info &mdash; Numpy API</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Numpy API" href="../../../index.html"/>
        <link rel="up" title="numpy" href="../../numpy.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Numpy API
          

          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.html">1. NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.doc.html">2. <code class="docutils literal"><span class="pre">numpy.doc</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.lib.html">3. <code class="docutils literal"><span class="pre">numpy.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.random.html">4. <code class="docutils literal"><span class="pre">numpy.random</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.linalg.html">5. <code class="docutils literal"><span class="pre">numpy.linalg</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.fft.html">6. Discrete Fourier Transform (<code class="docutils literal"><span class="pre">numpy.fft</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.polynomial.html">7. <code class="docutils literal"><span class="pre">numpy.polynomial</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.testing.html">8. <code class="docutils literal"><span class="pre">numpy.testing</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.f2py.html">9. <code class="docutils literal"><span class="pre">numpy.f2py</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.distutils.html">10. <code class="docutils literal"><span class="pre">numpy.distutils</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/index.html">11. NumPy Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">12. Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Numpy API</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../numpy.html">numpy</a> &raquo;</li>
        
      <li>numpy.distutils.system_info</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for numpy.distutils.system_info</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This file defines a set of system_info classes for getting</span>
<span class="sd">information about various resources (libraries, library directories,</span>
<span class="sd">include directories, etc.) in the system. Currently, the following</span>
<span class="sd">classes are available:</span>

<span class="sd">  atlas_info</span>
<span class="sd">  atlas_threads_info</span>
<span class="sd">  atlas_blas_info</span>
<span class="sd">  atlas_blas_threads_info</span>
<span class="sd">  lapack_atlas_info</span>
<span class="sd">  lapack_atlas_threads_info</span>
<span class="sd">  atlas_3_10_info</span>
<span class="sd">  atlas_3_10_threads_info</span>
<span class="sd">  atlas_3_10_blas_info,</span>
<span class="sd">  atlas_3_10_blas_threads_info,</span>
<span class="sd">  lapack_atlas_3_10_info</span>
<span class="sd">  lapack_atlas_3_10_threads_info</span>
<span class="sd">  blas_info</span>
<span class="sd">  lapack_info</span>
<span class="sd">  openblas_info</span>
<span class="sd">  blas_opt_info       # usage recommended</span>
<span class="sd">  lapack_opt_info     # usage recommended</span>
<span class="sd">  fftw_info,dfftw_info,sfftw_info</span>
<span class="sd">  fftw_threads_info,dfftw_threads_info,sfftw_threads_info</span>
<span class="sd">  djbfft_info</span>
<span class="sd">  x11_info</span>
<span class="sd">  lapack_src_info</span>
<span class="sd">  blas_src_info</span>
<span class="sd">  numpy_info</span>
<span class="sd">  numarray_info</span>
<span class="sd">  numpy_info</span>
<span class="sd">  boost_python_info</span>
<span class="sd">  agg2_info</span>
<span class="sd">  wx_info</span>
<span class="sd">  gdk_pixbuf_xlib_2_info</span>
<span class="sd">  gdk_pixbuf_2_info</span>
<span class="sd">  gdk_x11_2_info</span>
<span class="sd">  gtkp_x11_2_info</span>
<span class="sd">  gtkp_2_info</span>
<span class="sd">  xft_info</span>
<span class="sd">  freetype2_info</span>
<span class="sd">  umfpack_info</span>

<span class="sd">Usage:</span>
<span class="sd">    info_dict = get_info(&lt;name&gt;)</span>
<span class="sd">  where &lt;name&gt; is a string &#39;atlas&#39;,&#39;x11&#39;,&#39;fftw&#39;,&#39;lapack&#39;,&#39;blas&#39;,</span>
<span class="sd">  &#39;lapack_src&#39;, &#39;blas_src&#39;, etc. For a complete list of allowed names,</span>
<span class="sd">  see the definition of get_info() function below.</span>

<span class="sd">  Returned info_dict is a dictionary which is compatible with</span>
<span class="sd">  distutils.setup keyword arguments. If info_dict == {}, then the</span>
<span class="sd">  asked resource is not available (system_info could not find it).</span>

<span class="sd">  Several *_info classes specify an environment variable to specify</span>
<span class="sd">  the locations of software. When setting the corresponding environment</span>
<span class="sd">  variable to &#39;None&#39; then the software will be ignored, even when it</span>
<span class="sd">  is available in system.</span>

<span class="sd">Global parameters:</span>
<span class="sd">  system_info.search_static_first - search static libraries (.a)</span>
<span class="sd">             in precedence to shared ones (.so, .sl) if enabled.</span>
<span class="sd">  system_info.verbosity - output the results to stdout if enabled.</span>

<span class="sd">The file &#39;site.cfg&#39; is looked for in</span>

<span class="sd">1) Directory of main setup.py file being run.</span>
<span class="sd">2) Home directory of user running the setup.py file as ~/.numpy-site.cfg</span>
<span class="sd">3) System wide directory (location of this file...)</span>

<span class="sd">The first one found is used to get system configuration options The</span>
<span class="sd">format is that used by ConfigParser (i.e., Windows .INI style). The</span>
<span class="sd">section ALL has options that are the default for each section. The</span>
<span class="sd">available sections are fftw, atlas, and x11. Appropiate defaults are</span>
<span class="sd">used if nothing is specified.</span>

<span class="sd">The order of finding the locations of resources is the following:</span>
<span class="sd"> 1. environment variable</span>
<span class="sd"> 2. section in site.cfg</span>
<span class="sd"> 3. ALL section in site.cfg</span>
<span class="sd">Only the first complete match is returned.</span>

<span class="sd">Example:</span>
<span class="sd">----------</span>
<span class="sd">[ALL]</span>
<span class="sd">library_dirs = /usr/lib:/usr/local/lib:/opt/lib</span>
<span class="sd">include_dirs = /usr/include:/usr/local/include:/opt/include</span>
<span class="sd">src_dirs = /usr/local/src:/opt/src</span>
<span class="sd"># search static libraries (.a) in preference to shared ones (.so)</span>
<span class="sd">search_static_first = 0</span>

<span class="sd">[fftw]</span>
<span class="sd">fftw_libs = rfftw, fftw</span>
<span class="sd">fftw_opt_libs = rfftw_threaded, fftw_threaded</span>
<span class="sd"># if the above aren&#39;t found, look for {s,d}fftw_libs and {s,d}fftw_opt_libs</span>

<span class="sd">[atlas]</span>
<span class="sd">library_dirs = /usr/lib/3dnow:/usr/lib/3dnow/atlas</span>
<span class="sd"># for overriding the names of the atlas libraries</span>
<span class="sd">atlas_libs = lapack, f77blas, cblas, atlas</span>

<span class="sd">[x11]</span>
<span class="sd">library_dirs = /usr/X11R6/lib</span>
<span class="sd">include_dirs = /usr/X11R6/include</span>
<span class="sd">----------</span>

<span class="sd">Authors:</span>
<span class="sd">  Pearu Peterson &lt;pearu@cens.ioc.ee&gt;, February 2002</span>
<span class="sd">  David M. Cooke &lt;cookedm@physics.mcmaster.ca&gt;, April 2002</span>

<span class="sd">Copyright 2002 Pearu Peterson all rights reserved,</span>
<span class="sd">Pearu Peterson &lt;pearu@cens.ioc.ee&gt;</span>
<span class="sd">Permission to use, modify, and distribute this software is given under the</span>
<span class="sd">terms of the NumPy (BSD style) license.  See LICENSE.txt that came with</span>
<span class="sd">this distribution for specifics.</span>

<span class="sd">NO WARRANTY IS EXPRESSED OR IMPLIED.  USE AT YOUR OWN RISK.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">ConfigParser</span> <span class="kn">import</span> <span class="n">NoOptionError</span><span class="p">,</span> <span class="n">ConfigParser</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">configparser</span> <span class="kn">import</span> <span class="n">NoOptionError</span><span class="p">,</span> <span class="n">ConfigParser</span>

<span class="kn">from</span> <span class="nn">distutils.errors</span> <span class="kn">import</span> <span class="n">DistutilsError</span>
<span class="kn">from</span> <span class="nn">distutils.dist</span> <span class="kn">import</span> <span class="n">Distribution</span>
<span class="kn">import</span> <span class="nn">distutils.sysconfig</span>
<span class="kn">from</span> <span class="nn">distutils</span> <span class="kn">import</span> <span class="n">log</span>
<span class="kn">from</span> <span class="nn">distutils.util</span> <span class="kn">import</span> <span class="n">get_platform</span>

<span class="kn">from</span> <span class="nn">numpy.distutils.exec_command</span> <span class="kn">import</span> \
    <span class="n">find_executable</span><span class="p">,</span> <span class="n">exec_command</span><span class="p">,</span> <span class="n">get_pythonexe</span>
<span class="kn">from</span> <span class="nn">numpy.distutils.misc_util</span> <span class="kn">import</span> <span class="n">is_sequence</span><span class="p">,</span> <span class="n">is_string</span><span class="p">,</span> \
                                      <span class="n">get_shared_lib_extension</span>
<span class="kn">from</span> <span class="nn">numpy.distutils.command.config</span> <span class="kn">import</span> <span class="n">config</span> <span class="k">as</span> <span class="n">cmd_config</span>
<span class="kn">from</span> <span class="nn">numpy.distutils.compat</span> <span class="kn">import</span> <span class="n">get_exception</span>
<span class="kn">import</span> <span class="nn">distutils.ccompiler</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">shutil</span>


<span class="c1"># Determine number of bits</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="n">_bits</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;32bit&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">&#39;64bit&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">}</span>
<span class="n">platform_bits</span> <span class="o">=</span> <span class="n">_bits</span><span class="p">[</span><span class="n">platform</span><span class="o">.</span><span class="n">architecture</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>


<span class="k">def</span> <span class="nf">libpaths</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">bits</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a list of library paths valid on 32 or 64 bit systems.</span>

<span class="sd">    Inputs:</span>
<span class="sd">      paths : sequence</span>
<span class="sd">        A sequence of strings (typically paths)</span>
<span class="sd">      bits : int</span>
<span class="sd">        An integer, the only valid values are 32 or 64.  A ValueError exception</span>
<span class="sd">      is raised otherwise.</span>

<span class="sd">    Examples:</span>

<span class="sd">    Consider a list of directories</span>
<span class="sd">    &gt;&gt;&gt; paths = [&#39;/usr/X11R6/lib&#39;,&#39;/usr/X11/lib&#39;,&#39;/usr/lib&#39;]</span>

<span class="sd">    For a 32-bit platform, this is already valid:</span>
<span class="sd">    &gt;&gt;&gt; np.distutils.system_info.libpaths(paths,32)</span>
<span class="sd">    [&#39;/usr/X11R6/lib&#39;, &#39;/usr/X11/lib&#39;, &#39;/usr/lib&#39;]</span>

<span class="sd">    On 64 bits, we prepend the &#39;64&#39; postfix</span>
<span class="sd">    &gt;&gt;&gt; np.distutils.system_info.libpaths(paths,64)</span>
<span class="sd">    [&#39;/usr/X11R6/lib64&#39;, &#39;/usr/X11R6/lib&#39;, &#39;/usr/X11/lib64&#39;, &#39;/usr/X11/lib&#39;,</span>
<span class="sd">    &#39;/usr/lib64&#39;, &#39;/usr/lib&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bits</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid bit size in libpaths: 32 or 64 only&quot;</span><span class="p">)</span>

    <span class="c1"># Handle 32bit case</span>
    <span class="k">if</span> <span class="n">bits</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">paths</span>

    <span class="c1"># Handle 64bit case</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
        <span class="n">out</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">p</span> <span class="o">+</span> <span class="s1">&#39;64&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">out</span>


<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
    <span class="n">default_lib_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">distutils</span><span class="o">.</span><span class="n">sysconfig</span><span class="o">.</span><span class="n">EXEC_PREFIX</span><span class="p">,</span>
                                     <span class="s1">&#39;libs&#39;</span><span class="p">)]</span>
    <span class="n">default_runtime_dirs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">default_include_dirs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">default_src_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
    <span class="n">default_x11_lib_dirs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">default_x11_include_dirs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">default_lib_dirs</span> <span class="o">=</span> <span class="n">libpaths</span><span class="p">([</span><span class="s1">&#39;/usr/local/lib&#39;</span><span class="p">,</span> <span class="s1">&#39;/opt/lib&#39;</span><span class="p">,</span> <span class="s1">&#39;/usr/lib&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;/opt/local/lib&#39;</span><span class="p">,</span> <span class="s1">&#39;/sw/lib&#39;</span><span class="p">],</span> <span class="n">platform_bits</span><span class="p">)</span>
    <span class="n">default_runtime_dirs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">default_include_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;/usr/local/include&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;/opt/include&#39;</span><span class="p">,</span> <span class="s1">&#39;/usr/include&#39;</span><span class="p">,</span>
                            <span class="c1"># path of umfpack under macports</span>
                            <span class="s1">&#39;/opt/local/include/ufsparse&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;/opt/local/include&#39;</span><span class="p">,</span> <span class="s1">&#39;/sw/include&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;/usr/include/suitesparse&#39;</span><span class="p">]</span>
    <span class="n">default_src_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;/usr/local/src&#39;</span><span class="p">,</span> <span class="s1">&#39;/opt/src&#39;</span><span class="p">,</span> <span class="s1">&#39;/sw/src&#39;</span><span class="p">]</span>

    <span class="n">default_x11_lib_dirs</span> <span class="o">=</span> <span class="n">libpaths</span><span class="p">([</span><span class="s1">&#39;/usr/X11R6/lib&#39;</span><span class="p">,</span> <span class="s1">&#39;/usr/X11/lib&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;/usr/lib&#39;</span><span class="p">],</span> <span class="n">platform_bits</span><span class="p">)</span>
    <span class="n">default_x11_include_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;/usr/X11R6/include&#39;</span><span class="p">,</span> <span class="s1">&#39;/usr/X11/include&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;/usr/include&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;/usr/lib/X11&#39;</span><span class="p">):</span>
        <span class="n">globbed_x11_dir</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;/usr/lib/*/libX11.so&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">globbed_x11_dir</span><span class="p">:</span>
            <span class="n">x11_so_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">globbed_x11_dir</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">default_x11_lib_dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">x11_so_dir</span><span class="p">,</span> <span class="s1">&#39;/usr/lib/X11&#39;</span><span class="p">])</span>
            <span class="n">default_x11_include_dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;/usr/lib/X11/include&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;/usr/include/X11&#39;</span><span class="p">])</span>

    <span class="kn">import</span> <span class="nn">subprocess</span> <span class="kn">as</span> <span class="nn">sp</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Explicitly open/close file to avoid ResourceWarning when</span>
        <span class="c1"># tests are run in debug mode Python 3.</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">devnull</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;gcc&quot;</span><span class="p">,</span> <span class="s2">&quot;-print-multiarch&quot;</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                <span class="n">stderr</span><span class="o">=</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="n">DistutilsError</span><span class="p">):</span>
        <span class="c1"># OSError if gcc is not installed, or SandboxViolation (DistutilsError</span>
        <span class="c1"># subclass) if an old setuptools bug is triggered (see gh-3160).</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">triplet</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># gcc supports the &quot;-print-multiarch&quot; option</span>
            <span class="n">default_x11_lib_dirs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;/usr/lib/&quot;</span><span class="p">,</span> <span class="n">triplet</span><span class="p">)]</span>
            <span class="n">default_lib_dirs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;/usr/lib/&quot;</span><span class="p">,</span> <span class="n">triplet</span><span class="p">)]</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tmp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">tmp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="s1">&#39;lib&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">default_lib_dirs</span><span class="p">:</span>
    <span class="n">default_lib_dirs</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="s1">&#39;lib&#39;</span><span class="p">))</span>
    <span class="n">default_include_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="s1">&#39;include&#39;</span><span class="p">))</span>
    <span class="n">default_src_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="s1">&#39;src&#39;</span><span class="p">))</span>

<span class="n">default_lib_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">_m</span> <span class="k">for</span> <span class="n">_m</span> <span class="ow">in</span> <span class="n">default_lib_dirs</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">_m</span><span class="p">)]</span>
<span class="n">default_runtime_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">_m</span> <span class="k">for</span> <span class="n">_m</span> <span class="ow">in</span> <span class="n">default_runtime_dirs</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">_m</span><span class="p">)]</span>
<span class="n">default_include_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">_m</span> <span class="k">for</span> <span class="n">_m</span> <span class="ow">in</span> <span class="n">default_include_dirs</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">_m</span><span class="p">)]</span>
<span class="n">default_src_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">_m</span> <span class="k">for</span> <span class="n">_m</span> <span class="ow">in</span> <span class="n">default_src_dirs</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">_m</span><span class="p">)]</span>

<span class="n">so_ext</span> <span class="o">=</span> <span class="n">get_shared_lib_extension</span><span class="p">()</span>


<div class="viewcode-block" id="get_standard_file"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.system_info.get_standard_file.html#numpy.distutils.system_info.get_standard_file">[docs]</a><span class="k">def</span> <span class="nf">get_standard_file</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a list of files named &#39;fname&#39; from</span>
<span class="sd">    1) System-wide directory (directory-location of this module)</span>
<span class="sd">    2) Users HOME directory (os.environ[&#39;HOME&#39;])</span>
<span class="sd">    3) Local directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># System-wide file</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">__file__</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sysfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">f</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">fname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">sysfile</span><span class="p">):</span>
            <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sysfile</span><span class="p">)</span>

    <span class="c1"># Home directory</span>
    <span class="c1"># And look for the user config file</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">user_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">user_file</span><span class="p">):</span>
            <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">user_file</span><span class="p">)</span>

    <span class="c1"># Local file</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
        <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">fname</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">filenames</span></div>


<div class="viewcode-block" id="get_info"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.system_info.get_info.html#numpy.distutils.system_info.get_info">[docs]</a><span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">notfound_action</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    notfound_action:</span>
<span class="sd">      0 - do nothing</span>
<span class="sd">      1 - display warning message</span>
<span class="sd">      2 - raise error</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cl</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;atlas&#39;</span><span class="p">:</span> <span class="n">atlas_info</span><span class="p">,</span>  <span class="c1"># use lapack_opt or blas_opt instead</span>
          <span class="s1">&#39;atlas_threads&#39;</span><span class="p">:</span> <span class="n">atlas_threads_info</span><span class="p">,</span>                <span class="c1"># ditto</span>
          <span class="s1">&#39;atlas_blas&#39;</span><span class="p">:</span> <span class="n">atlas_blas_info</span><span class="p">,</span>
          <span class="s1">&#39;atlas_blas_threads&#39;</span><span class="p">:</span> <span class="n">atlas_blas_threads_info</span><span class="p">,</span>
          <span class="s1">&#39;lapack_atlas&#39;</span><span class="p">:</span> <span class="n">lapack_atlas_info</span><span class="p">,</span>  <span class="c1"># use lapack_opt instead</span>
          <span class="s1">&#39;lapack_atlas_threads&#39;</span><span class="p">:</span> <span class="n">lapack_atlas_threads_info</span><span class="p">,</span>  <span class="c1"># ditto</span>
          <span class="s1">&#39;atlas_3_10&#39;</span><span class="p">:</span> <span class="n">atlas_3_10_info</span><span class="p">,</span>  <span class="c1"># use lapack_opt or blas_opt instead</span>
          <span class="s1">&#39;atlas_3_10_threads&#39;</span><span class="p">:</span> <span class="n">atlas_3_10_threads_info</span><span class="p">,</span>                <span class="c1"># ditto</span>
          <span class="s1">&#39;atlas_3_10_blas&#39;</span><span class="p">:</span> <span class="n">atlas_3_10_blas_info</span><span class="p">,</span>
          <span class="s1">&#39;atlas_3_10_blas_threads&#39;</span><span class="p">:</span> <span class="n">atlas_3_10_blas_threads_info</span><span class="p">,</span>
          <span class="s1">&#39;lapack_atlas_3_10&#39;</span><span class="p">:</span> <span class="n">lapack_atlas_3_10_info</span><span class="p">,</span>  <span class="c1"># use lapack_opt instead</span>
          <span class="s1">&#39;lapack_atlas_3_10_threads&#39;</span><span class="p">:</span> <span class="n">lapack_atlas_3_10_threads_info</span><span class="p">,</span>  <span class="c1"># ditto</span>
          <span class="s1">&#39;mkl&#39;</span><span class="p">:</span> <span class="n">mkl_info</span><span class="p">,</span>
          <span class="c1"># openblas which may or may not have embedded lapack</span>
          <span class="s1">&#39;openblas&#39;</span><span class="p">:</span> <span class="n">openblas_info</span><span class="p">,</span>          <span class="c1"># use blas_opt instead</span>
          <span class="c1"># openblas with embedded lapack</span>
          <span class="s1">&#39;openblas_lapack&#39;</span><span class="p">:</span> <span class="n">openblas_lapack_info</span><span class="p">,</span> <span class="c1"># use blas_opt instead</span>
          <span class="s1">&#39;lapack_mkl&#39;</span><span class="p">:</span> <span class="n">lapack_mkl_info</span><span class="p">,</span>      <span class="c1"># use lapack_opt instead</span>
          <span class="s1">&#39;blas_mkl&#39;</span><span class="p">:</span> <span class="n">blas_mkl_info</span><span class="p">,</span>          <span class="c1"># use blas_opt instead</span>
          <span class="s1">&#39;x11&#39;</span><span class="p">:</span> <span class="n">x11_info</span><span class="p">,</span>
          <span class="s1">&#39;fft_opt&#39;</span><span class="p">:</span> <span class="n">fft_opt_info</span><span class="p">,</span>
          <span class="s1">&#39;fftw&#39;</span><span class="p">:</span> <span class="n">fftw_info</span><span class="p">,</span>
          <span class="s1">&#39;fftw2&#39;</span><span class="p">:</span> <span class="n">fftw2_info</span><span class="p">,</span>
          <span class="s1">&#39;fftw3&#39;</span><span class="p">:</span> <span class="n">fftw3_info</span><span class="p">,</span>
          <span class="s1">&#39;dfftw&#39;</span><span class="p">:</span> <span class="n">dfftw_info</span><span class="p">,</span>
          <span class="s1">&#39;sfftw&#39;</span><span class="p">:</span> <span class="n">sfftw_info</span><span class="p">,</span>
          <span class="s1">&#39;fftw_threads&#39;</span><span class="p">:</span> <span class="n">fftw_threads_info</span><span class="p">,</span>
          <span class="s1">&#39;dfftw_threads&#39;</span><span class="p">:</span> <span class="n">dfftw_threads_info</span><span class="p">,</span>
          <span class="s1">&#39;sfftw_threads&#39;</span><span class="p">:</span> <span class="n">sfftw_threads_info</span><span class="p">,</span>
          <span class="s1">&#39;djbfft&#39;</span><span class="p">:</span> <span class="n">djbfft_info</span><span class="p">,</span>
          <span class="s1">&#39;blas&#39;</span><span class="p">:</span> <span class="n">blas_info</span><span class="p">,</span>                  <span class="c1"># use blas_opt instead</span>
          <span class="s1">&#39;lapack&#39;</span><span class="p">:</span> <span class="n">lapack_info</span><span class="p">,</span>              <span class="c1"># use lapack_opt instead</span>
          <span class="s1">&#39;lapack_src&#39;</span><span class="p">:</span> <span class="n">lapack_src_info</span><span class="p">,</span>
          <span class="s1">&#39;blas_src&#39;</span><span class="p">:</span> <span class="n">blas_src_info</span><span class="p">,</span>
          <span class="s1">&#39;numpy&#39;</span><span class="p">:</span> <span class="n">numpy_info</span><span class="p">,</span>
          <span class="s1">&#39;f2py&#39;</span><span class="p">:</span> <span class="n">f2py_info</span><span class="p">,</span>
          <span class="s1">&#39;Numeric&#39;</span><span class="p">:</span> <span class="n">Numeric_info</span><span class="p">,</span>
          <span class="s1">&#39;numeric&#39;</span><span class="p">:</span> <span class="n">Numeric_info</span><span class="p">,</span>
          <span class="s1">&#39;numarray&#39;</span><span class="p">:</span> <span class="n">numarray_info</span><span class="p">,</span>
          <span class="s1">&#39;numerix&#39;</span><span class="p">:</span> <span class="n">numerix_info</span><span class="p">,</span>
          <span class="s1">&#39;lapack_opt&#39;</span><span class="p">:</span> <span class="n">lapack_opt_info</span><span class="p">,</span>
          <span class="s1">&#39;blas_opt&#39;</span><span class="p">:</span> <span class="n">blas_opt_info</span><span class="p">,</span>
          <span class="s1">&#39;boost_python&#39;</span><span class="p">:</span> <span class="n">boost_python_info</span><span class="p">,</span>
          <span class="s1">&#39;agg2&#39;</span><span class="p">:</span> <span class="n">agg2_info</span><span class="p">,</span>
          <span class="s1">&#39;wx&#39;</span><span class="p">:</span> <span class="n">wx_info</span><span class="p">,</span>
          <span class="s1">&#39;gdk_pixbuf_xlib_2&#39;</span><span class="p">:</span> <span class="n">gdk_pixbuf_xlib_2_info</span><span class="p">,</span>
          <span class="s1">&#39;gdk-pixbuf-xlib-2.0&#39;</span><span class="p">:</span> <span class="n">gdk_pixbuf_xlib_2_info</span><span class="p">,</span>
          <span class="s1">&#39;gdk_pixbuf_2&#39;</span><span class="p">:</span> <span class="n">gdk_pixbuf_2_info</span><span class="p">,</span>
          <span class="s1">&#39;gdk-pixbuf-2.0&#39;</span><span class="p">:</span> <span class="n">gdk_pixbuf_2_info</span><span class="p">,</span>
          <span class="s1">&#39;gdk&#39;</span><span class="p">:</span> <span class="n">gdk_info</span><span class="p">,</span>
          <span class="s1">&#39;gdk_2&#39;</span><span class="p">:</span> <span class="n">gdk_2_info</span><span class="p">,</span>
          <span class="s1">&#39;gdk-2.0&#39;</span><span class="p">:</span> <span class="n">gdk_2_info</span><span class="p">,</span>
          <span class="s1">&#39;gdk_x11_2&#39;</span><span class="p">:</span> <span class="n">gdk_x11_2_info</span><span class="p">,</span>
          <span class="s1">&#39;gdk-x11-2.0&#39;</span><span class="p">:</span> <span class="n">gdk_x11_2_info</span><span class="p">,</span>
          <span class="s1">&#39;gtkp_x11_2&#39;</span><span class="p">:</span> <span class="n">gtkp_x11_2_info</span><span class="p">,</span>
          <span class="s1">&#39;gtk+-x11-2.0&#39;</span><span class="p">:</span> <span class="n">gtkp_x11_2_info</span><span class="p">,</span>
          <span class="s1">&#39;gtkp_2&#39;</span><span class="p">:</span> <span class="n">gtkp_2_info</span><span class="p">,</span>
          <span class="s1">&#39;gtk+-2.0&#39;</span><span class="p">:</span> <span class="n">gtkp_2_info</span><span class="p">,</span>
          <span class="s1">&#39;xft&#39;</span><span class="p">:</span> <span class="n">xft_info</span><span class="p">,</span>
          <span class="s1">&#39;freetype2&#39;</span><span class="p">:</span> <span class="n">freetype2_info</span><span class="p">,</span>
          <span class="s1">&#39;umfpack&#39;</span><span class="p">:</span> <span class="n">umfpack_info</span><span class="p">,</span>
          <span class="s1">&#39;amd&#39;</span><span class="p">:</span> <span class="n">amd_info</span><span class="p">,</span>
          <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">system_info</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cl</span><span class="p">()</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="n">notfound_action</span><span class="p">)</span></div>


<span class="k">class</span> <span class="nc">NotFoundError</span><span class="p">(</span><span class="n">DistutilsError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Some third-party program or library is not found.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">AtlasNotFoundError</span><span class="p">(</span><span class="n">NotFoundError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Atlas (http://math-atlas.sourceforge.net/) libraries not found.</span>
<span class="sd">    Directories to search for the libraries can be specified in the</span>
<span class="sd">    numpy/distutils/site.cfg file (section [atlas]) or by setting</span>
<span class="sd">    the ATLAS environment variable.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">LapackNotFoundError</span><span class="p">(</span><span class="n">NotFoundError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Lapack (http://www.netlib.org/lapack/) libraries not found.</span>
<span class="sd">    Directories to search for the libraries can be specified in the</span>
<span class="sd">    numpy/distutils/site.cfg file (section [lapack]) or by setting</span>
<span class="sd">    the LAPACK environment variable.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">LapackSrcNotFoundError</span><span class="p">(</span><span class="n">LapackNotFoundError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Lapack (http://www.netlib.org/lapack/) sources not found.</span>
<span class="sd">    Directories to search for the sources can be specified in the</span>
<span class="sd">    numpy/distutils/site.cfg file (section [lapack_src]) or by setting</span>
<span class="sd">    the LAPACK_SRC environment variable.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">BlasNotFoundError</span><span class="p">(</span><span class="n">NotFoundError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Blas (http://www.netlib.org/blas/) libraries not found.</span>
<span class="sd">    Directories to search for the libraries can be specified in the</span>
<span class="sd">    numpy/distutils/site.cfg file (section [blas]) or by setting</span>
<span class="sd">    the BLAS environment variable.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">BlasSrcNotFoundError</span><span class="p">(</span><span class="n">BlasNotFoundError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Blas (http://www.netlib.org/blas/) sources not found.</span>
<span class="sd">    Directories to search for the sources can be specified in the</span>
<span class="sd">    numpy/distutils/site.cfg file (section [blas_src]) or by setting</span>
<span class="sd">    the BLAS_SRC environment variable.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">FFTWNotFoundError</span><span class="p">(</span><span class="n">NotFoundError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    FFTW (http://www.fftw.org/) libraries not found.</span>
<span class="sd">    Directories to search for the libraries can be specified in the</span>
<span class="sd">    numpy/distutils/site.cfg file (section [fftw]) or by setting</span>
<span class="sd">    the FFTW environment variable.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">DJBFFTNotFoundError</span><span class="p">(</span><span class="n">NotFoundError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DJBFFT (http://cr.yp.to/djbfft.html) libraries not found.</span>
<span class="sd">    Directories to search for the libraries can be specified in the</span>
<span class="sd">    numpy/distutils/site.cfg file (section [djbfft]) or by setting</span>
<span class="sd">    the DJBFFT environment variable.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">NumericNotFoundError</span><span class="p">(</span><span class="n">NotFoundError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Numeric (http://www.numpy.org/) module not found.</span>
<span class="sd">    Get it from above location, install it, and retry setup.py.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">X11NotFoundError</span><span class="p">(</span><span class="n">NotFoundError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;X11 libraries not found.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">UmfpackNotFoundError</span><span class="p">(</span><span class="n">NotFoundError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    UMFPACK sparse solver (http://www.cise.ufl.edu/research/sparse/umfpack/)</span>
<span class="sd">    not found. Directories to search for the libraries can be specified in the</span>
<span class="sd">    numpy/distutils/site.cfg file (section [umfpack]) or by setting</span>
<span class="sd">    the UMFPACK environment variable.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">system_info</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; get_info() is the only public method. Don&#39;t use others.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;ALL&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">search_static_first</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># XXX: disabled by default, may disappear in</span>
                            <span class="c1"># future unless it is proved to be useful.</span>
    <span class="n">verbosity</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">saved_results</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">NotFoundError</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                  <span class="n">default_lib_dirs</span><span class="o">=</span><span class="n">default_lib_dirs</span><span class="p">,</span>
                  <span class="n">default_include_dirs</span><span class="o">=</span><span class="n">default_include_dirs</span><span class="p">,</span>
                  <span class="n">verbosity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_prefixes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;library_dirs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">default_lib_dirs</span><span class="p">)</span>
        <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;include_dirs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">default_include_dirs</span><span class="p">)</span>
        <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;runtime_library_dirs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">default_runtime_dirs</span><span class="p">)</span>
        <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;rpath&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;src_dirs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">default_src_dirs</span><span class="p">)</span>
        <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;search_static_first&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_static_first</span><span class="p">)</span>
        <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;extra_compile_args&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;extra_link_args&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cp</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_standard_file</span><span class="p">(</span><span class="s1">&#39;.numpy-site.cfg&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_standard_file</span><span class="p">(</span><span class="s1">&#39;site.cfg&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_config_files</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">section</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">search_static_first</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="p">,</span> <span class="s1">&#39;search_static_first&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_static_first</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse_config_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">section</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calc_libraries_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libraries</span><span class="p">()</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lib_dirs</span><span class="p">()</span>
        <span class="c1"># The extensions use runtime_library_dirs</span>
        <span class="n">r_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_runtime_lib_dirs</span><span class="p">()</span> 
        <span class="c1"># Intrinsic distutils use rpath, we simply append both entries</span>
        <span class="c1"># as though they were one entry</span>
        <span class="n">r_dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_runtime_lib_dirs</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;rpath&#39;</span><span class="p">))</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">lib</span> <span class="ow">in</span> <span class="n">libs</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs</span><span class="p">(</span><span class="n">dirs</span><span class="p">,</span> <span class="p">[</span><span class="n">lib</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Library </span><span class="si">%s</span><span class="s1"> was not found. Ignoring&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lib</span><span class="p">))</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs</span><span class="p">(</span><span class="n">r_dirs</span><span class="p">,</span> <span class="p">[</span><span class="n">lib</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># Swap library keywords found to runtime_library_dirs</span>
                <span class="c1"># the libraries are insisting on the user having defined</span>
                <span class="c1"># them using the library_dirs, and not necessarily by</span>
                <span class="c1"># runtime_library_dirs</span>
                <span class="k">del</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;libraries&#39;</span><span class="p">]</span>
                <span class="n">i</span><span class="p">[</span><span class="s1">&#39;runtime_library_dirs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;library_dirs&#39;</span><span class="p">)</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Runtime library </span><span class="si">%s</span><span class="s1"> was not found. Ignoring&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lib</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">info</span>

    <span class="k">def</span> <span class="nf">set_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">info</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">info</span><span class="p">:</span>
            <span class="n">lib_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_libraries_info</span><span class="p">()</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">lib_info</span><span class="p">)</span>
            <span class="c1"># Update extra information</span>
            <span class="n">extra_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_extra_info</span><span class="p">()</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saved_results</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>

    <span class="k">def</span> <span class="nf">has_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">saved_results</span>

    <span class="k">def</span> <span class="nf">calc_extra_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Updates the information in the current information with</span>
<span class="sd">        respect to these flags:</span>
<span class="sd">          extra_compile_args</span>
<span class="sd">          extra_link_args</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;extra_compile_args&#39;</span><span class="p">,</span> <span class="s1">&#39;extra_link_args&#39;</span><span class="p">]:</span>
            <span class="c1"># Get values</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">opt</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span> <span class="p">:</span> <span class="p">[</span><span class="n">opt</span><span class="p">]}</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">tmp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">info</span>

    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">notfound_action</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return a dictonary with items that are compatible</span>
<span class="sd">            with numpy.distutils.setup keyword arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_info</span><span class="p">():</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;calc_info&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calc_info</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">notfound_action</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_info</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">notfound_action</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">notfounderror</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">notfound_action</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">notfounderror</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">notfounderror</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">notfound_action</span><span class="p">))</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_info</span><span class="p">():</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;  NOT AVAILABLE&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;  FOUND:&#39;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">saved_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">flag</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">v</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">,</span> <span class="s1">&#39;libraries&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">270</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:</span><span class="mi">120</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;...</span><span class="se">\n</span><span class="s1">...</span><span class="se">\n</span><span class="s1">...&#39;</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">120</span><span class="p">:]</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;    </span><span class="si">%s</span><span class="s1"> = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="p">)</span>
        <span class="n">env_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_env_var</span>
        <span class="k">if</span> <span class="n">env_var</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">env_var</span><span class="p">):</span>
                <span class="n">e0</span> <span class="o">=</span> <span class="n">env_var</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">env_var</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
                        <span class="n">e0</span> <span class="o">=</span> <span class="n">e</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">env_var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">e0</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting </span><span class="si">%s</span><span class="s1">=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">env_var</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e0</span><span class="p">))</span>
                <span class="n">env_var</span> <span class="o">=</span> <span class="n">e0</span>
        <span class="k">if</span> <span class="n">env_var</span> <span class="ow">and</span> <span class="n">env_var</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">env_var</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Disabled </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="s1">&#39;(</span><span class="si">%s</span><span class="s1"> is None)&#39;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">env_var</span><span class="p">,))</span>
                <span class="k">return</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
                <span class="n">dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span> <span class="o">+</span> <span class="n">dirs</span>
                <span class="n">l</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_lib_names&#39;</span><span class="p">,</span> <span class="p">[])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">b</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">b</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lib&#39;</span><span class="p">:</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Replacing _lib_names[0]==</span><span class="si">%r</span><span class="s1"> with </span><span class="si">%r</span><span class="s1">&#39;</span> \
                              <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lib_names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">:]))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_lib_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ds</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="p">)</span>
                <span class="n">ds2</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
                        <span class="n">ds2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;include&#39;</span><span class="p">,</span> <span class="s1">&#39;lib&#39;</span><span class="p">]:</span>
                            <span class="n">d1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">dd</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">d1</span><span class="p">):</span>
                                <span class="n">ds2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
                <span class="n">dirs</span> <span class="o">=</span> <span class="n">ds2</span> <span class="o">+</span> <span class="n">dirs</span>
        <span class="n">default_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="p">)</span>
        <span class="n">dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">default_dirs</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Specified path </span><span class="si">%s</span><span class="s1"> is invalid.&#39;</span> <span class="o">%</span> <span class="n">d</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">d</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">:</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;( </span><span class="si">%s</span><span class="s1"> = </span><span class="si">%s</span><span class="s1"> )&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">get_lib_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;library_dirs&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_runtime_lib_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;runtime_library_dirs&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_include_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;include_dirs&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_src_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;src_dirs&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_libs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">NoOptionError</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">default</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">default</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">default</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">default</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">libs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span> <span class="k">if</span> <span class="n">b</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_libraries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;libraries&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">library_extensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">static_exts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.a&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
            <span class="n">static_exts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;.lib&#39;</span><span class="p">)</span>  <span class="c1"># .lib is used by MSVC</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_static_first</span><span class="p">:</span>
            <span class="n">exts</span> <span class="o">=</span> <span class="n">static_exts</span> <span class="o">+</span> <span class="p">[</span><span class="n">so_ext</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exts</span> <span class="o">=</span> <span class="p">[</span><span class="n">so_ext</span><span class="p">]</span> <span class="o">+</span> <span class="n">static_exts</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;cygwin&#39;</span><span class="p">:</span>
            <span class="n">exts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;.dll.a&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;darwin&#39;</span><span class="p">:</span>
            <span class="n">exts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;.dylib&#39;</span><span class="p">)</span>
        <span class="c1"># Debian and Ubuntu added a g3f suffix to shared library to deal with</span>
        <span class="c1"># g77 -&gt; gfortran ABI transition</span>
        <span class="c1"># XXX: disabled, it hides more problem than it solves.</span>
        <span class="c1">#if sys.platform[:5] == &#39;linux&#39;:</span>
        <span class="c1">#    exts.append(&#39;.so.3gf&#39;)</span>
        <span class="k">return</span> <span class="n">exts</span>

    <span class="k">def</span> <span class="nf">check_libs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lib_dirs</span><span class="p">,</span> <span class="n">libs</span><span class="p">,</span> <span class="n">opt_libs</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;If static or shared libraries are available then return</span>
<span class="sd">        their info dictionary.</span>

<span class="sd">        Checks for all libraries as shared libraries first, then</span>
<span class="sd">        static (or vice versa if self.search_static_first is True).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">library_extensions</span><span class="p">()</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">exts</span><span class="p">:</span>
            <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_libs</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">libs</span><span class="p">,</span> <span class="n">opt_libs</span><span class="p">,</span> <span class="p">[</span><span class="n">ext</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;  libraries </span><span class="si">%s</span><span class="s1"> not found in </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">libs</span><span class="p">),</span>
                     <span class="n">lib_dirs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">info</span>

    <span class="k">def</span> <span class="nf">check_libs2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lib_dirs</span><span class="p">,</span> <span class="n">libs</span><span class="p">,</span> <span class="n">opt_libs</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;If static or shared libraries are available then return</span>
<span class="sd">        their info dictionary.</span>

<span class="sd">        Checks each library for shared or static.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">library_extensions</span><span class="p">()</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_libs</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">libs</span><span class="p">,</span> <span class="n">opt_libs</span><span class="p">,</span> <span class="n">exts</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;  libraries </span><span class="si">%s</span><span class="s1"> not found in </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">libs</span><span class="p">),</span>
                     <span class="n">lib_dirs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">info</span>

    <span class="k">def</span> <span class="nf">_lib_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lib_dir</span><span class="p">,</span> <span class="n">libs</span><span class="p">,</span> <span class="n">exts</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">is_string</span><span class="p">(</span><span class="n">lib_dir</span><span class="p">)</span>
        <span class="n">liblist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># under windows first try without &#39;lib&#39; prefix</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
            <span class="n">lib_prefixes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;lib&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lib_prefixes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lib&#39;</span><span class="p">]</span>
        <span class="c1"># for each library name, see if we can find a file for it.</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">libs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">exts</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">lib_prefixes</span><span class="p">:</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">lib_dir</span><span class="p">,</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">l</span> <span class="o">+</span> <span class="n">ext</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">p</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">p</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                    <span class="c1"># ??? splitext on p[0] would do this for cygwin</span>
                    <span class="c1"># doesn&#39;t seem correct</span>
                    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;.dll.a&#39;</span><span class="p">:</span>
                        <span class="n">l</span> <span class="o">+=</span> <span class="s1">&#39;.dll&#39;</span>
                    <span class="n">liblist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">liblist</span>

    <span class="k">def</span> <span class="nf">_check_libs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lib_dirs</span><span class="p">,</span> <span class="n">libs</span><span class="p">,</span> <span class="n">opt_libs</span><span class="p">,</span> <span class="n">exts</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find mandatory and optional libs in expected paths.</span>

<span class="sd">        Missing optional libraries are silently forgotten.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># First, try to find the mandatory libraries</span>
        <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">):</span>
            <span class="n">found_libs</span><span class="p">,</span> <span class="n">found_dirs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">dir_</span> <span class="ow">in</span> <span class="n">lib_dirs</span><span class="p">:</span>
                <span class="n">found_libs1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_list</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span> <span class="n">libs</span><span class="p">,</span> <span class="n">exts</span><span class="p">)</span>
                <span class="c1"># It&#39;s possible that we&#39;ll find the same library in multiple</span>
                <span class="c1"># directories. It&#39;s also possible that we&#39;ll find some</span>
                <span class="c1"># libraries on in directory, and some in another. So the</span>
                <span class="c1"># obvious thing would be to use a set instead of a list, but I</span>
                <span class="c1"># don&#39;t know if preserving order matters (does it?).</span>
                <span class="k">for</span> <span class="n">found_lib</span> <span class="ow">in</span> <span class="n">found_libs1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">found_lib</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">found_libs</span><span class="p">:</span>
                        <span class="n">found_libs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">found_lib</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">dir_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">found_dirs</span><span class="p">:</span>
                            <span class="n">found_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dir_</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">found_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_list</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">libs</span><span class="p">,</span> <span class="n">exts</span><span class="p">)</span>
            <span class="n">found_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">lib_dirs</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_libs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_libs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">libs</span><span class="p">):</span>
            <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;libraries&#39;</span><span class="p">:</span> <span class="n">found_libs</span><span class="p">,</span> <span class="s1">&#39;library_dirs&#39;</span><span class="p">:</span> <span class="n">found_dirs</span><span class="p">}</span>
            <span class="c1"># Now, check for optional libraries</span>
            <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">dir_</span> <span class="ow">in</span> <span class="n">lib_dirs</span><span class="p">:</span>
                    <span class="n">opt_found_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_list</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span> <span class="n">opt_libs</span><span class="p">,</span> <span class="n">exts</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">opt_found_libs</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">dir_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">found_dirs</span><span class="p">:</span>
                            <span class="n">found_dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">dir_</span><span class="p">)</span>
                        <span class="n">found_libs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">opt_found_libs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">opt_found_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_list</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">opt_libs</span><span class="p">,</span> <span class="n">exts</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">opt_found_libs</span><span class="p">:</span>
                    <span class="n">found_libs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">opt_found_libs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">info</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">combine_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list of existing paths composed by all combinations</span>
<span class="sd">        of items from the arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">combine_paths</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;verbosity&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">})</span>


<span class="k">class</span> <span class="nc">fft_opt_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">fftw_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;fftw3&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;fftw2&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;dfftw&#39;</span><span class="p">)</span>
        <span class="n">djbfft_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;djbfft&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fftw_info</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">fftw_info</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">djbfft_info</span><span class="p">:</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">djbfft_info</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
            <span class="k">return</span>


<span class="k">class</span> <span class="nc">fftw_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="c1">#variables to override</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;fftw&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;FFTW&#39;</span>
    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">FFTWNotFoundError</span>
    <span class="n">ver_info</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;fftw3&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;libs&#39;</span><span class="p">:[</span><span class="s1">&#39;fftw3&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;includes&#39;</span><span class="p">:[</span><span class="s1">&#39;fftw3.h&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;macros&#39;</span><span class="p">:[(</span><span class="s1">&#39;SCIPY_FFTW3_H&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]},</span>
                  <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;fftw2&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;libs&#39;</span><span class="p">:[</span><span class="s1">&#39;rfftw&#39;</span><span class="p">,</span> <span class="s1">&#39;fftw&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;includes&#39;</span><span class="p">:[</span><span class="s1">&#39;fftw.h&#39;</span><span class="p">,</span> <span class="s1">&#39;rfftw.h&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;macros&#39;</span><span class="p">:[(</span><span class="s1">&#39;SCIPY_FFTW_H&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]}]</span>

    <span class="k">def</span> <span class="nf">calc_ver_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ver_param</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True on successful version detection, else False&quot;&quot;&quot;</span>
        <span class="n">lib_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lib_dirs</span><span class="p">()</span>
        <span class="n">incl_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_include_dirs</span><span class="p">()</span>
        <span class="n">incl_dir</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">section</span> <span class="o">+</span> <span class="s1">&#39;_libs&#39;</span><span class="p">,</span> <span class="n">ver_param</span><span class="p">[</span><span class="s1">&#39;libs&#39;</span><span class="p">])</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">libs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">incl_dirs</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">ver_param</span><span class="p">[</span><span class="s1">&#39;includes&#39;</span><span class="p">]))</span> \
                   <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ver_param</span><span class="p">[</span><span class="s1">&#39;includes&#39;</span><span class="p">]):</span>
                    <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">include_dirs</span><span class="o">=</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
                    <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">incl_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">]</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">define_macros</span><span class="o">=</span><span class="n">ver_param</span><span class="p">[</span><span class="s1">&#39;macros&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1"> not found&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ver_param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
            <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ver_info</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_ver_info</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                <span class="k">break</span>


<span class="k">class</span> <span class="nc">fftw2_info</span><span class="p">(</span><span class="n">fftw_info</span><span class="p">):</span>
    <span class="c1">#variables to override</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;fftw&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;FFTW&#39;</span>
    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">FFTWNotFoundError</span>
    <span class="n">ver_info</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;fftw2&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;libs&#39;</span><span class="p">:[</span><span class="s1">&#39;rfftw&#39;</span><span class="p">,</span> <span class="s1">&#39;fftw&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;includes&#39;</span><span class="p">:[</span><span class="s1">&#39;fftw.h&#39;</span><span class="p">,</span> <span class="s1">&#39;rfftw.h&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;macros&#39;</span><span class="p">:[(</span><span class="s1">&#39;SCIPY_FFTW_H&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]}</span>
                  <span class="p">]</span>


<span class="k">class</span> <span class="nc">fftw3_info</span><span class="p">(</span><span class="n">fftw_info</span><span class="p">):</span>
    <span class="c1">#variables to override</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;fftw3&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;FFTW3&#39;</span>
    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">FFTWNotFoundError</span>
    <span class="n">ver_info</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;fftw3&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;libs&#39;</span><span class="p">:[</span><span class="s1">&#39;fftw3&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;includes&#39;</span><span class="p">:[</span><span class="s1">&#39;fftw3.h&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;macros&#39;</span><span class="p">:[(</span><span class="s1">&#39;SCIPY_FFTW3_H&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]},</span>
                  <span class="p">]</span>


<span class="k">class</span> <span class="nc">dfftw_info</span><span class="p">(</span><span class="n">fftw_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;fftw&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;FFTW&#39;</span>
    <span class="n">ver_info</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;dfftw&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;libs&#39;</span><span class="p">:[</span><span class="s1">&#39;drfftw&#39;</span><span class="p">,</span> <span class="s1">&#39;dfftw&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;includes&#39;</span><span class="p">:[</span><span class="s1">&#39;dfftw.h&#39;</span><span class="p">,</span> <span class="s1">&#39;drfftw.h&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;macros&#39;</span><span class="p">:[(</span><span class="s1">&#39;SCIPY_DFFTW_H&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]}]</span>


<span class="k">class</span> <span class="nc">sfftw_info</span><span class="p">(</span><span class="n">fftw_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;fftw&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;FFTW&#39;</span>
    <span class="n">ver_info</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;sfftw&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;libs&#39;</span><span class="p">:[</span><span class="s1">&#39;srfftw&#39;</span><span class="p">,</span> <span class="s1">&#39;sfftw&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;includes&#39;</span><span class="p">:[</span><span class="s1">&#39;sfftw.h&#39;</span><span class="p">,</span> <span class="s1">&#39;srfftw.h&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;macros&#39;</span><span class="p">:[(</span><span class="s1">&#39;SCIPY_SFFTW_H&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]}]</span>


<span class="k">class</span> <span class="nc">fftw_threads_info</span><span class="p">(</span><span class="n">fftw_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;fftw&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;FFTW&#39;</span>
    <span class="n">ver_info</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;fftw threads&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;libs&#39;</span><span class="p">:[</span><span class="s1">&#39;rfftw_threads&#39;</span><span class="p">,</span> <span class="s1">&#39;fftw_threads&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;includes&#39;</span><span class="p">:[</span><span class="s1">&#39;fftw_threads.h&#39;</span><span class="p">,</span> <span class="s1">&#39;rfftw_threads.h&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;macros&#39;</span><span class="p">:[(</span><span class="s1">&#39;SCIPY_FFTW_THREADS_H&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]}]</span>


<span class="k">class</span> <span class="nc">dfftw_threads_info</span><span class="p">(</span><span class="n">fftw_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;fftw&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;FFTW&#39;</span>
    <span class="n">ver_info</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;dfftw threads&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;libs&#39;</span><span class="p">:[</span><span class="s1">&#39;drfftw_threads&#39;</span><span class="p">,</span> <span class="s1">&#39;dfftw_threads&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;includes&#39;</span><span class="p">:[</span><span class="s1">&#39;dfftw_threads.h&#39;</span><span class="p">,</span> <span class="s1">&#39;drfftw_threads.h&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;macros&#39;</span><span class="p">:[(</span><span class="s1">&#39;SCIPY_DFFTW_THREADS_H&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]}]</span>


<span class="k">class</span> <span class="nc">sfftw_threads_info</span><span class="p">(</span><span class="n">fftw_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;fftw&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;FFTW&#39;</span>
    <span class="n">ver_info</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;sfftw threads&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;libs&#39;</span><span class="p">:[</span><span class="s1">&#39;srfftw_threads&#39;</span><span class="p">,</span> <span class="s1">&#39;sfftw_threads&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;includes&#39;</span><span class="p">:[</span><span class="s1">&#39;sfftw_threads.h&#39;</span><span class="p">,</span> <span class="s1">&#39;srfftw_threads.h&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;macros&#39;</span><span class="p">:[(</span><span class="s1">&#39;SCIPY_SFFTW_THREADS_H&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]}]</span>


<span class="k">class</span> <span class="nc">djbfft_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;djbfft&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;DJBFFT&#39;</span>
    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">DJBFFTNotFoundError</span>

    <span class="k">def</span> <span class="nf">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">pre_dirs</span> <span class="o">=</span> <span class="n">system_info</span><span class="o">.</span><span class="n">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">pre_dirs</span><span class="p">:</span>
            <span class="n">dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;djbfft&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="p">[</span><span class="n">d</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lib_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lib_dirs</span><span class="p">()</span>
        <span class="n">incl_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_include_dirs</span><span class="p">()</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">lib_dirs</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;djbfft.a&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;extra_objects&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">}</span>
                <span class="k">break</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;libdjbfft.a&#39;</span><span class="p">,</span> <span class="s1">&#39;libdjbfft&#39;</span> <span class="o">+</span> <span class="n">so_ext</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;libraries&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;djbfft&#39;</span><span class="p">],</span> <span class="s1">&#39;library_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">d</span><span class="p">]}</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">incl_dirs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;fftc8.h&#39;</span><span class="p">,</span> <span class="s1">&#39;fftfreq.h&#39;</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">include_dirs</span><span class="o">=</span><span class="p">[</span><span class="n">d</span><span class="p">],</span>
                            <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;SCIPY_DJBFFT_H&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">return</span>


<span class="k">class</span> <span class="nc">mkl_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;mkl&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;MKL&#39;</span>
    <span class="n">_lib_mkl</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mkl&#39;</span><span class="p">,</span> <span class="s1">&#39;vml&#39;</span><span class="p">,</span> <span class="s1">&#39;guide&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_mkl_rootdir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mklroot</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MKLROOT&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mklroot</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mklroot</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LD_LIBRARY_PATH&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="p">)</span>
        <span class="n">ld_so_conf</span> <span class="o">=</span> <span class="s1">&#39;/etc/ld.so.conf&#39;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">ld_so_conf</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">ld_so_conf</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">d</span><span class="p">:</span>
                    <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">intel_mkl_dirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
            <span class="n">path_atoms</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">path_atoms</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;mkl&#39;</span><span class="p">):</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_atoms</span><span class="p">[:</span><span class="n">path_atoms</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
                    <span class="n">intel_mkl_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
            <span class="n">dirs</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;mkl&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">))</span>
            <span class="n">dirs</span> <span class="o">+=</span> <span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;mkl*&#39;</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;lib&#39;</span><span class="p">)):</span>
                    <span class="k">return</span> <span class="n">d</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mklroot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mkl_rootdir</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">mklroot</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">system_info</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.cpuinfo</span> <span class="kn">import</span> <span class="n">cpu</span>
            <span class="n">l</span> <span class="o">=</span> <span class="s1">&#39;mkl&#39;</span>  <span class="c1"># use shared library</span>
            <span class="k">if</span> <span class="n">cpu</span><span class="o">.</span><span class="n">is_Itanium</span><span class="p">():</span>
                <span class="n">plt</span> <span class="o">=</span> <span class="s1">&#39;64&#39;</span>
                <span class="c1">#l = &#39;mkl_ipf&#39;</span>
            <span class="k">elif</span> <span class="n">cpu</span><span class="o">.</span><span class="n">is_Xeon</span><span class="p">():</span>
                <span class="n">plt</span> <span class="o">=</span> <span class="s1">&#39;intel64&#39;</span>
                <span class="c1">#l = &#39;mkl_intel64&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span> <span class="o">=</span> <span class="s1">&#39;32&#39;</span>
                <span class="c1">#l = &#39;mkl_ia32&#39;</span>
            <span class="k">if</span> <span class="n">l</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_mkl</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_lib_mkl</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
            <span class="n">system_info</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">default_lib_dirs</span><span class="o">=</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mklroot</span><span class="p">,</span> <span class="s1">&#39;lib&#39;</span><span class="p">,</span> <span class="n">plt</span><span class="p">)],</span>
                <span class="n">default_include_dirs</span><span class="o">=</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mklroot</span><span class="p">,</span> <span class="s1">&#39;include&#39;</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lib_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lib_dirs</span><span class="p">()</span>
        <span class="n">incl_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_include_dirs</span><span class="p">()</span>
        <span class="n">mkl_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;mkl_libs&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_mkl</span><span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs2</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">mkl_libs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span>
                    <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;SCIPY_MKL_H&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;HAVE_CBLAS&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)],</span>
                    <span class="n">include_dirs</span><span class="o">=</span><span class="n">incl_dirs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
            <span class="k">pass</span>  <span class="c1"># win32 has no pthread library</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">libraries</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pthread&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">lapack_mkl_info</span><span class="p">(</span><span class="n">mkl_info</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mkl</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;mkl&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mkl</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
            <span class="n">lapack_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;lapack_libs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mkl_lapack&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lapack_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;lapack_libs&#39;</span><span class="p">,</span>
                                        <span class="p">[</span><span class="s1">&#39;mkl_lapack32&#39;</span><span class="p">,</span> <span class="s1">&#39;mkl_lapack64&#39;</span><span class="p">])</span>

        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;libraries&#39;</span><span class="p">:</span> <span class="n">lapack_libs</span><span class="p">}</span>
        <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">mkl</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">blas_mkl_info</span><span class="p">(</span><span class="n">mkl_info</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">atlas_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;atlas&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;ATLAS&#39;</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;f77blas&#39;</span><span class="p">,</span> <span class="s1">&#39;cblas&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="p">[:</span><span class="mi">7</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;freebsd&#39;</span><span class="p">:</span>
        <span class="n">_lib_atlas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;atlas_r&#39;</span><span class="p">]</span>
        <span class="n">_lib_lapack</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;alapack_r&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_lib_atlas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;atlas&#39;</span><span class="p">]</span>
        <span class="n">_lib_lapack</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lapack&#39;</span><span class="p">]</span>

    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">AtlasNotFoundError</span>

    <span class="k">def</span> <span class="nf">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">pre_dirs</span> <span class="o">=</span> <span class="n">system_info</span><span class="o">.</span><span class="n">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">pre_dirs</span><span class="p">:</span>
            <span class="n">dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;atlas*&#39;</span><span class="p">,</span> <span class="s1">&#39;ATLAS*&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;sse&#39;</span><span class="p">,</span> <span class="s1">&#39;3dnow&#39;</span><span class="p">,</span> <span class="s1">&#39;sse2&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="p">[</span><span class="n">d</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lib_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lib_dirs</span><span class="p">()</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">atlas_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;atlas_libs&#39;</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_lib_names</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_atlas</span><span class="p">)</span>
        <span class="n">lapack_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;lapack_libs&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_lapack</span><span class="p">)</span>
        <span class="n">atlas</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">lapack</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">atlas_1</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">lib_dirs</span><span class="p">:</span>
            <span class="n">atlas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs2</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">atlas_libs</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">lapack_atlas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs2</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;lapack_atlas&#39;</span><span class="p">],</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">atlas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">lib_dirs2</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;atlas*&#39;</span><span class="p">,</span> <span class="s1">&#39;ATLAS*&#39;</span><span class="p">])</span>
                <span class="n">lapack</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs2</span><span class="p">(</span><span class="n">lib_dirs2</span><span class="p">,</span> <span class="n">lapack_libs</span><span class="p">,</span> <span class="p">[])</span>
                <span class="k">if</span> <span class="n">lapack</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">atlas</span><span class="p">:</span>
                <span class="n">atlas_1</span> <span class="o">=</span> <span class="n">atlas</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">atlas</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">atlas</span> <span class="o">=</span> <span class="n">atlas_1</span>
        <span class="k">if</span> <span class="n">atlas</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">include_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_include_dirs</span><span class="p">()</span>
        <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">lib_dirs</span> <span class="o">+</span> <span class="n">include_dirs</span><span class="p">,</span> <span class="s1">&#39;cblas.h&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">[</span><span class="bp">None</span><span class="p">])</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">h</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">include_dirs</span><span class="o">=</span><span class="p">[</span><span class="n">h</span><span class="p">])</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
        <span class="k">if</span> <span class="n">lapack</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">lapack</span><span class="p">)</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">atlas</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;lapack_atlas&#39;</span> <span class="ow">in</span> <span class="n">atlas</span><span class="p">[</span><span class="s1">&#39;libraries&#39;</span><span class="p">]:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">atlas</span><span class="p">)</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span>
                        <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;ATLAS_WITH_LAPACK_ATLAS&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">atlas</span><span class="p">)</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;ATLAS_WITHOUT_LAPACK&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)])</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">*********************************************************************</span>
<span class="s2">    Could not find lapack library within the ATLAS installation.</span>
<span class="s2">*********************************************************************</span>
<span class="s2">&quot;&quot;&quot;</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Check if lapack library is complete, only warn if it is not.</span>
        <span class="n">lapack_dir</span> <span class="o">=</span> <span class="n">lapack</span><span class="p">[</span><span class="s1">&#39;library_dirs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lapack_name</span> <span class="o">=</span> <span class="n">lapack</span><span class="p">[</span><span class="s1">&#39;libraries&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lapack_lib</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">lib_prefixes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lib&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
            <span class="n">lib_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">library_extensions</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">lib_prefixes</span><span class="p">:</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lapack_dir</span><span class="p">,</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">lapack_name</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
                    <span class="n">lapack_lib</span> <span class="o">=</span> <span class="n">fn</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">lapack_lib</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">lapack_lib</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">sz</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">lapack_lib</span><span class="p">)[</span><span class="mi">6</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">sz</span> <span class="o">&lt;=</span> <span class="mi">4000</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">*********************************************************************</span>
<span class="s2">    Lapack library (from ATLAS) is probably incomplete:</span>
<span class="s2">      size of </span><span class="si">%s</span><span class="s2"> is </span><span class="si">%s</span><span class="s2">k (expected &gt;4000k)</span>

<span class="s2">    Follow the instructions in the KNOWN PROBLEMS section of the file</span>
<span class="s2">    numpy/INSTALL.txt.</span>
<span class="s2">*********************************************************************</span>
<span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lapack_lib</span><span class="p">,</span> <span class="n">sz</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;f77&#39;</span>

        <span class="n">atlas_version</span><span class="p">,</span> <span class="n">atlas_extra_info</span> <span class="o">=</span> <span class="n">get_atlas_version</span><span class="p">(</span><span class="o">**</span><span class="n">atlas</span><span class="p">)</span>
        <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">atlas_extra_info</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">atlas_blas_info</span><span class="p">(</span><span class="n">atlas_info</span><span class="p">):</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;f77blas&#39;</span><span class="p">,</span> <span class="s1">&#39;cblas&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lib_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lib_dirs</span><span class="p">()</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">atlas_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;atlas_libs&#39;</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_lib_names</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_atlas</span><span class="p">)</span>
        <span class="n">atlas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs2</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">atlas_libs</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">atlas</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">include_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_include_dirs</span><span class="p">()</span>
        <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">lib_dirs</span> <span class="o">+</span> <span class="n">include_dirs</span><span class="p">,</span> <span class="s1">&#39;cblas.h&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">[</span><span class="bp">None</span><span class="p">])</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">h</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">include_dirs</span><span class="o">=</span><span class="p">[</span><span class="n">h</span><span class="p">])</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;define_macros&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;HAVE_CBLAS&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span>

        <span class="n">atlas_version</span><span class="p">,</span> <span class="n">atlas_extra_info</span> <span class="o">=</span> <span class="n">get_atlas_version</span><span class="p">(</span><span class="o">**</span><span class="n">atlas</span><span class="p">)</span>
        <span class="n">dict_append</span><span class="p">(</span><span class="n">atlas</span><span class="p">,</span> <span class="o">**</span><span class="n">atlas_extra_info</span><span class="p">)</span>

        <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">atlas</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
        <span class="k">return</span>


<span class="k">class</span> <span class="nc">atlas_threads_info</span><span class="p">(</span><span class="n">atlas_info</span><span class="p">):</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PTATLAS&#39;</span><span class="p">,</span> <span class="s1">&#39;ATLAS&#39;</span><span class="p">]</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ptf77blas&#39;</span><span class="p">,</span> <span class="s1">&#39;ptcblas&#39;</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">atlas_blas_threads_info</span><span class="p">(</span><span class="n">atlas_blas_info</span><span class="p">):</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PTATLAS&#39;</span><span class="p">,</span> <span class="s1">&#39;ATLAS&#39;</span><span class="p">]</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ptf77blas&#39;</span><span class="p">,</span> <span class="s1">&#39;ptcblas&#39;</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">lapack_atlas_info</span><span class="p">(</span><span class="n">atlas_info</span><span class="p">):</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lapack_atlas&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">atlas_info</span><span class="o">.</span><span class="n">_lib_names</span>


<span class="k">class</span> <span class="nc">lapack_atlas_threads_info</span><span class="p">(</span><span class="n">atlas_threads_info</span><span class="p">):</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lapack_atlas&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">atlas_threads_info</span><span class="o">.</span><span class="n">_lib_names</span>


<span class="k">class</span> <span class="nc">atlas_3_10_info</span><span class="p">(</span><span class="n">atlas_info</span><span class="p">):</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;satlas&#39;</span><span class="p">]</span>
    <span class="n">_lib_atlas</span> <span class="o">=</span> <span class="n">_lib_names</span>
    <span class="n">_lib_lapack</span> <span class="o">=</span> <span class="n">_lib_names</span>


<span class="k">class</span> <span class="nc">atlas_3_10_blas_info</span><span class="p">(</span><span class="n">atlas_3_10_info</span><span class="p">):</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;satlas&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lib_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lib_dirs</span><span class="p">()</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">atlas_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;atlas_libs&#39;</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_lib_names</span><span class="p">)</span>
        <span class="n">atlas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs2</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">atlas_libs</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">atlas</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">include_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_include_dirs</span><span class="p">()</span>
        <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">lib_dirs</span> <span class="o">+</span> <span class="n">include_dirs</span><span class="p">,</span> <span class="s1">&#39;cblas.h&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">[</span><span class="bp">None</span><span class="p">])</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">h</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">include_dirs</span><span class="o">=</span><span class="p">[</span><span class="n">h</span><span class="p">])</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;define_macros&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;HAVE_CBLAS&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span>

        <span class="n">atlas_version</span><span class="p">,</span> <span class="n">atlas_extra_info</span> <span class="o">=</span> <span class="n">get_atlas_version</span><span class="p">(</span><span class="o">**</span><span class="n">atlas</span><span class="p">)</span>
        <span class="n">dict_append</span><span class="p">(</span><span class="n">atlas</span><span class="p">,</span> <span class="o">**</span><span class="n">atlas_extra_info</span><span class="p">)</span>

        <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">atlas</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
        <span class="k">return</span>


<span class="k">class</span> <span class="nc">atlas_3_10_threads_info</span><span class="p">(</span><span class="n">atlas_3_10_info</span><span class="p">):</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PTATLAS&#39;</span><span class="p">,</span> <span class="s1">&#39;ATLAS&#39;</span><span class="p">]</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tatlas&#39;</span><span class="p">]</span>
    <span class="c1">#if sys.platfcorm[:7] == &#39;freebsd&#39;:</span>
        <span class="c1">## I don&#39;t think freebsd supports 3.10 at this time - 2014</span>
    <span class="n">_lib_atlas</span> <span class="o">=</span> <span class="n">_lib_names</span>
    <span class="n">_lib_lapack</span> <span class="o">=</span> <span class="n">_lib_names</span>


<span class="k">class</span> <span class="nc">atlas_3_10_blas_threads_info</span><span class="p">(</span><span class="n">atlas_3_10_blas_info</span><span class="p">):</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PTATLAS&#39;</span><span class="p">,</span> <span class="s1">&#39;ATLAS&#39;</span><span class="p">]</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tatlas&#39;</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">lapack_atlas_3_10_info</span><span class="p">(</span><span class="n">atlas_3_10_info</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">lapack_atlas_3_10_threads_info</span><span class="p">(</span><span class="n">atlas_3_10_threads_info</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">lapack_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;lapack&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;LAPACK&#39;</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lapack&#39;</span><span class="p">]</span>
    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">LapackNotFoundError</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lib_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lib_dirs</span><span class="p">()</span>

        <span class="n">lapack_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;lapack_libs&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_names</span><span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">lapack_libs</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;f77&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">lapack_src_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;lapack_src&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;LAPACK_SRC&#39;</span>
    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">LapackSrcNotFoundError</span>

    <span class="k">def</span> <span class="nf">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">pre_dirs</span> <span class="o">=</span> <span class="n">system_info</span><span class="o">.</span><span class="n">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">pre_dirs</span><span class="p">:</span>
            <span class="n">dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">d</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;LAPACK*/SRC&#39;</span><span class="p">,</span> <span class="s1">&#39;SRC&#39;</span><span class="p">]))</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">src_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_src_dirs</span><span class="p">()</span>
        <span class="n">src_dir</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">src_dirs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;dgesv.f&#39;</span><span class="p">)):</span>
                <span class="n">src_dir</span> <span class="o">=</span> <span class="n">d</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">src_dir</span><span class="p">:</span>
            <span class="c1">#XXX: Get sources from netlib. May be ask first.</span>
            <span class="k">return</span>
        <span class="c1"># The following is extracted from LAPACK-3.0/SRC/Makefile.</span>
        <span class="c1"># Added missing names from lapack-lite-3.1.1/SRC/Makefile</span>
        <span class="c1"># while keeping removed names for Lapack-3.0 compatibility.</span>
        <span class="n">allaux</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        ilaenv ieeeck lsame lsamen xerbla</span>
<span class="s1">        iparmq</span>
<span class="s1">        &#39;&#39;&#39;</span>  <span class="c1"># *.f</span>
        <span class="n">laux</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        bdsdc bdsqr disna labad lacpy ladiv lae2 laebz laed0 laed1</span>
<span class="s1">        laed2 laed3 laed4 laed5 laed6 laed7 laed8 laed9 laeda laev2</span>
<span class="s1">        lagtf lagts lamch lamrg lanst lapy2 lapy3 larnv larrb larre</span>
<span class="s1">        larrf lartg laruv las2 lascl lasd0 lasd1 lasd2 lasd3 lasd4</span>
<span class="s1">        lasd5 lasd6 lasd7 lasd8 lasd9 lasda lasdq lasdt laset lasq1</span>
<span class="s1">        lasq2 lasq3 lasq4 lasq5 lasq6 lasr lasrt lassq lasv2 pttrf</span>
<span class="s1">        stebz stedc steqr sterf</span>

<span class="s1">        larra larrc larrd larr larrk larrj larrr laneg laisnan isnan</span>
<span class="s1">        lazq3 lazq4</span>
<span class="s1">        &#39;&#39;&#39;</span>  <span class="c1"># [s|d]*.f</span>
        <span class="n">lasrc</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        gbbrd gbcon gbequ gbrfs gbsv gbsvx gbtf2 gbtrf gbtrs gebak</span>
<span class="s1">        gebal gebd2 gebrd gecon geequ gees geesx geev geevx gegs gegv</span>
<span class="s1">        gehd2 gehrd gelq2 gelqf gels gelsd gelss gelsx gelsy geql2</span>
<span class="s1">        geqlf geqp3 geqpf geqr2 geqrf gerfs gerq2 gerqf gesc2 gesdd</span>
<span class="s1">        gesv gesvd gesvx getc2 getf2 getrf getri getrs ggbak ggbal</span>
<span class="s1">        gges ggesx ggev ggevx ggglm gghrd gglse ggqrf ggrqf ggsvd</span>
<span class="s1">        ggsvp gtcon gtrfs gtsv gtsvx gttrf gttrs gtts2 hgeqz hsein</span>
<span class="s1">        hseqr labrd lacon laein lags2 lagtm lahqr lahrd laic1 lals0</span>
<span class="s1">        lalsa lalsd langb lange langt lanhs lansb lansp lansy lantb</span>
<span class="s1">        lantp lantr lapll lapmt laqgb laqge laqp2 laqps laqsb laqsp</span>
<span class="s1">        laqsy lar1v lar2v larf larfb larfg larft larfx largv larrv</span>
<span class="s1">        lartv larz larzb larzt laswp lasyf latbs latdf latps latrd</span>
<span class="s1">        latrs latrz latzm lauu2 lauum pbcon pbequ pbrfs pbstf pbsv</span>
<span class="s1">        pbsvx pbtf2 pbtrf pbtrs pocon poequ porfs posv posvx potf2</span>
<span class="s1">        potrf potri potrs ppcon ppequ pprfs ppsv ppsvx pptrf pptri</span>
<span class="s1">        pptrs ptcon pteqr ptrfs ptsv ptsvx pttrs ptts2 spcon sprfs</span>
<span class="s1">        spsv spsvx sptrf sptri sptrs stegr stein sycon syrfs sysv</span>
<span class="s1">        sysvx sytf2 sytrf sytri sytrs tbcon tbrfs tbtrs tgevc tgex2</span>
<span class="s1">        tgexc tgsen tgsja tgsna tgsy2 tgsyl tpcon tprfs tptri tptrs</span>
<span class="s1">        trcon trevc trexc trrfs trsen trsna trsyl trti2 trtri trtrs</span>
<span class="s1">        tzrqf tzrzf</span>

<span class="s1">        lacn2 lahr2 stemr laqr0 laqr1 laqr2 laqr3 laqr4 laqr5</span>
<span class="s1">        &#39;&#39;&#39;</span>  <span class="c1"># [s|c|d|z]*.f</span>
        <span class="n">sd_lasrc</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        laexc lag2 lagv2 laln2 lanv2 laqtr lasy2 opgtr opmtr org2l</span>
<span class="s1">        org2r orgbr orghr orgl2 orglq orgql orgqr orgr2 orgrq orgtr</span>
<span class="s1">        orm2l orm2r ormbr ormhr orml2 ormlq ormql ormqr ormr2 ormr3</span>
<span class="s1">        ormrq ormrz ormtr rscl sbev sbevd sbevx sbgst sbgv sbgvd sbgvx</span>
<span class="s1">        sbtrd spev spevd spevx spgst spgv spgvd spgvx sptrd stev stevd</span>
<span class="s1">        stevr stevx syev syevd syevr syevx sygs2 sygst sygv sygvd</span>
<span class="s1">        sygvx sytd2 sytrd</span>
<span class="s1">        &#39;&#39;&#39;</span>  <span class="c1"># [s|d]*.f</span>
        <span class="n">cz_lasrc</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        bdsqr hbev hbevd hbevx hbgst hbgv hbgvd hbgvx hbtrd hecon heev</span>
<span class="s1">        heevd heevr heevx hegs2 hegst hegv hegvd hegvx herfs hesv</span>
<span class="s1">        hesvx hetd2 hetf2 hetrd hetrf hetri hetrs hpcon hpev hpevd</span>
<span class="s1">        hpevx hpgst hpgv hpgvd hpgvx hprfs hpsv hpsvx hptrd hptrf</span>
<span class="s1">        hptri hptrs lacgv lacp2 lacpy lacrm lacrt ladiv laed0 laed7</span>
<span class="s1">        laed8 laesy laev2 lahef lanhb lanhe lanhp lanht laqhb laqhe</span>
<span class="s1">        laqhp larcm larnv lartg lascl laset lasr lassq pttrf rot spmv</span>
<span class="s1">        spr stedc steqr symv syr ung2l ung2r ungbr unghr ungl2 unglq</span>
<span class="s1">        ungql ungqr ungr2 ungrq ungtr unm2l unm2r unmbr unmhr unml2</span>
<span class="s1">        unmlq unmql unmqr unmr2 unmr3 unmrq unmrz unmtr upgtr upmtr</span>
<span class="s1">        &#39;&#39;&#39;</span>  <span class="c1"># [c|z]*.f</span>
        <span class="c1">#######</span>
        <span class="n">sclaux</span> <span class="o">=</span> <span class="n">laux</span> <span class="o">+</span> <span class="s1">&#39; econd &#39;</span>                  <span class="c1"># s*.f</span>
        <span class="n">dzlaux</span> <span class="o">=</span> <span class="n">laux</span> <span class="o">+</span> <span class="s1">&#39; secnd &#39;</span>                  <span class="c1"># d*.f</span>
        <span class="n">slasrc</span> <span class="o">=</span> <span class="n">lasrc</span> <span class="o">+</span> <span class="n">sd_lasrc</span>                  <span class="c1"># s*.f</span>
        <span class="n">dlasrc</span> <span class="o">=</span> <span class="n">lasrc</span> <span class="o">+</span> <span class="n">sd_lasrc</span>                  <span class="c1"># d*.f</span>
        <span class="n">clasrc</span> <span class="o">=</span> <span class="n">lasrc</span> <span class="o">+</span> <span class="n">cz_lasrc</span> <span class="o">+</span> <span class="s1">&#39; srot srscl &#39;</span>  <span class="c1"># c*.f</span>
        <span class="n">zlasrc</span> <span class="o">=</span> <span class="n">lasrc</span> <span class="o">+</span> <span class="n">cz_lasrc</span> <span class="o">+</span> <span class="s1">&#39; drot drscl &#39;</span>  <span class="c1"># z*.f</span>
        <span class="n">oclasrc</span> <span class="o">=</span> <span class="s1">&#39; icmax1 scsum1 &#39;</span>                <span class="c1"># *.f</span>
        <span class="n">ozlasrc</span> <span class="o">=</span> <span class="s1">&#39; izmax1 dzsum1 &#39;</span>                <span class="c1"># *.f</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;s</span><span class="si">%s</span><span class="s1">.f&#39;</span> <span class="o">%</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">(</span><span class="n">sclaux</span> <span class="o">+</span> <span class="n">slasrc</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span> \
                  <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;d</span><span class="si">%s</span><span class="s1">.f&#39;</span> <span class="o">%</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">(</span><span class="n">dzlaux</span> <span class="o">+</span> <span class="n">dlasrc</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span> \
                  <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;c</span><span class="si">%s</span><span class="s1">.f&#39;</span> <span class="o">%</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">(</span><span class="n">clasrc</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span> \
                  <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;z</span><span class="si">%s</span><span class="s1">.f&#39;</span> <span class="o">%</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">(</span><span class="n">zlasrc</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span> \
                  <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.f&#39;</span> <span class="o">%</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">(</span><span class="n">allaux</span> <span class="o">+</span> <span class="n">oclasrc</span> <span class="o">+</span> <span class="n">ozlasrc</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">]</span>
        <span class="c1"># Lapack 3.1:</span>
        <span class="n">src_dir2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_dir</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;INSTALL&#39;</span><span class="p">)</span>
        <span class="n">sources</span> <span class="o">+=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_dir2</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="s1">&#39;lamch.f&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="s1">&#39;sdcz&#39;</span><span class="p">]</span>
        <span class="c1"># Lapack 3.2.1:</span>
        <span class="n">sources</span> <span class="o">+=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_dir</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="s1">&#39;larfp.f&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="s1">&#39;sdcz&#39;</span><span class="p">]</span>
        <span class="n">sources</span> <span class="o">+=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_dir</span><span class="p">,</span> <span class="s1">&#39;ila&#39;</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s1">&#39;lr.f&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="s1">&#39;sdcz&#39;</span><span class="p">]</span>
        <span class="n">sources</span> <span class="o">+=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_dir</span><span class="p">,</span> <span class="s1">&#39;ila&#39;</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s1">&#39;lc.f&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="s1">&#39;sdcz&#39;</span><span class="p">]</span>
        <span class="c1"># Should we check here actual existence of source files?</span>
        <span class="c1"># Yes, the file listing is different between 3.0 and 3.1</span>
        <span class="c1"># versions.</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">sources</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sources&#39;</span><span class="p">:</span> <span class="n">sources</span><span class="p">,</span> <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="s1">&#39;f77&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>

<span class="n">atlas_version_c_text</span> <span class="o">=</span> <span class="s1">r&#39;&#39;&#39;</span>
<span class="s1">/* This file is generated from numpy/distutils/system_info.py */</span>
<span class="s1">void ATL_buildinfo(void);</span>
<span class="s1">int main(void) {</span>
<span class="s1">  ATL_buildinfo();</span>
<span class="s1">  return 0;</span>
<span class="s1">}</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">_cached_atlas_version</span> <span class="o">=</span> <span class="p">{}</span>


<span class="k">def</span> <span class="nf">get_atlas_version</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">):</span>
    <span class="n">libraries</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;libraries&#39;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">library_dirs</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;library_dirs&#39;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">libraries</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">library_dirs</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">_cached_atlas_version</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_cached_atlas_version</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">cmd_config</span><span class="p">(</span><span class="n">Distribution</span><span class="p">())</span>
    <span class="n">atlas_version</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">s</span><span class="p">,</span> <span class="n">o</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_output</span><span class="p">(</span><span class="n">atlas_version_c_text</span><span class="p">,</span>
                            <span class="n">libraries</span><span class="o">=</span><span class="n">libraries</span><span class="p">,</span> <span class="n">library_dirs</span><span class="o">=</span><span class="n">library_dirs</span><span class="p">,</span>
                            <span class="n">use_tee</span><span class="o">=</span><span class="p">(</span><span class="n">system_info</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">r&#39;undefined reference to `_gfortran&#39;</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span><span class="p">):</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">o</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_output</span><span class="p">(</span><span class="n">atlas_version_c_text</span><span class="p">,</span>
                                <span class="n">libraries</span><span class="o">=</span><span class="n">libraries</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;gfortran&#39;</span><span class="p">],</span>
                                <span class="n">library_dirs</span><span class="o">=</span><span class="n">library_dirs</span><span class="p">,</span>
                                <span class="n">use_tee</span><span class="o">=</span><span class="p">(</span><span class="n">system_info</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">*****************************************************</span>
<span class="s2">Linkage with ATLAS requires gfortran. Use</span>

<span class="s2">  python setup.py config_fc --fcompiler=gnu95 ...</span>

<span class="s2">when building extension libraries that use ATLAS.</span>
<span class="s2">Make sure that -lgfortran is used for C++ extensions.</span>
<span class="s2">*****************************************************</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;f90&#39;</span><span class="p">,</span>
                            <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;ATLAS_REQUIRES_GFORTRAN&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)])</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># failed to get version from file -- maybe on Windows</span>
        <span class="c1"># look at directory name</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">library_dirs</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">r&#39;ATLAS_(?P&lt;version&gt;\d+[.]\d+[.]\d+)_&#39;</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                <span class="n">atlas_version</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">atlas_version</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="c1"># final choice --- look at ATLAS_VERSION environment</span>
        <span class="c1">#   variable</span>
        <span class="k">if</span> <span class="n">atlas_version</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">atlas_version</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ATLAS_VERSION&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">atlas_version</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span>
                <span class="s1">&#39;ATLAS_INFO&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="se">\\</span><span class="s1">&quot;</span><span class="si">%s</span><span class="se">\\</span><span class="s1">&quot;&quot;&#39;</span> <span class="o">%</span> <span class="n">atlas_version</span><span class="p">)</span>
            <span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;NO_ATLAS_INFO&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">atlas_version</span> <span class="ow">or</span> <span class="s1">&#39;?.?.?&#39;</span><span class="p">,</span> <span class="n">info</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">r&#39;ATLAS version (?P&lt;version&gt;\d+[.]\d+[.]\d+)&#39;</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
            <span class="n">atlas_version</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">atlas_version</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">r&#39;undefined symbol: ATL_buildinfo&#39;</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span><span class="p">):</span>
            <span class="n">atlas_version</span> <span class="o">=</span> <span class="s1">&#39;3.2.1_pre3.3.6&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Status: </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Output: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">atlas_version</span> <span class="o">==</span> <span class="s1">&#39;3.2.1_pre3.3.6&#39;</span><span class="p">:</span>
        <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;NO_ATLAS_INFO&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span>
            <span class="s1">&#39;ATLAS_INFO&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="se">\\</span><span class="s1">&quot;</span><span class="si">%s</span><span class="se">\\</span><span class="s1">&quot;&quot;&#39;</span> <span class="o">%</span> <span class="n">atlas_version</span><span class="p">)</span>
        <span class="p">])</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_cached_atlas_version</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">atlas_version</span><span class="p">,</span> <span class="n">info</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="k">class</span> <span class="nc">lapack_opt_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>

    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">LapackNotFoundError</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">openblas_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;openblas_lapack&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">openblas_info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">openblas_info</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">lapack_mkl_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;lapack_mkl&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lapack_mkl_info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">lapack_mkl_info</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">atlas_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;atlas_3_10_threads&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">atlas_info</span><span class="p">:</span>
            <span class="n">atlas_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;atlas_3_10&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">atlas_info</span><span class="p">:</span>
            <span class="n">atlas_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;atlas_threads&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">atlas_info</span><span class="p">:</span>
            <span class="n">atlas_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;atlas&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;darwin&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">atlas_info</span><span class="p">:</span>
            <span class="c1"># Use the system lapack from Accelerate or vecLib under OSX</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">link_args</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">get_platform</span><span class="p">()[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;i386&#39;</span> <span class="ow">or</span> <span class="s1">&#39;intel&#39;</span> <span class="ow">in</span> <span class="n">get_platform</span><span class="p">()</span> <span class="ow">or</span> \
               <span class="s1">&#39;x86_64&#39;</span> <span class="ow">in</span> <span class="n">get_platform</span><span class="p">()</span> <span class="ow">or</span> \
               <span class="s1">&#39;i386&#39;</span> <span class="ow">in</span> <span class="n">platform</span><span class="o">.</span><span class="n">platform</span><span class="p">():</span>
                <span class="n">intel</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">intel</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;/System/Library/Frameworks&#39;</span>
                              <span class="s1">&#39;/Accelerate.framework/&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">intel</span><span class="p">:</span>
                    <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-msse3&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-faltivec&#39;</span><span class="p">])</span>
                <span class="n">link_args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-Wl,-framework&#39;</span><span class="p">,</span> <span class="s1">&#39;-Wl,Accelerate&#39;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;/System/Library/Frameworks&#39;</span>
                                <span class="s1">&#39;/vecLib.framework/&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">intel</span><span class="p">:</span>
                    <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-msse3&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-faltivec&#39;</span><span class="p">])</span>
                <span class="n">link_args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-Wl,-framework&#39;</span><span class="p">,</span> <span class="s1">&#39;-Wl,vecLib&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">args</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="n">extra_compile_args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
                              <span class="n">extra_link_args</span><span class="o">=</span><span class="n">link_args</span><span class="p">,</span>
                              <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;NO_ATLAS_INFO&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                                             <span class="p">(</span><span class="s1">&#39;HAVE_CBLAS&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)])</span>
                <span class="k">return</span>

        <span class="c1">#atlas_info = {} ## uncomment for testing</span>
        <span class="n">need_lapack</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">need_blas</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">atlas_info</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">atlas_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;define_macros&#39;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;ATLAS_WITH_LAPACK_ATLAS&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">in</span> <span class="n">l</span> \
                   <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;ATLAS_WITHOUT_LAPACK&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
                <span class="n">need_lapack</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">info</span> <span class="o">=</span> <span class="n">atlas_info</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">AtlasNotFoundError</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
            <span class="n">need_blas</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">need_lapack</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;NO_ATLAS_INFO&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>

        <span class="k">if</span> <span class="n">need_lapack</span><span class="p">:</span>
            <span class="n">lapack_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;lapack&#39;</span><span class="p">)</span>
            <span class="c1">#lapack_info = {} ## uncomment for testing</span>
            <span class="k">if</span> <span class="n">lapack_info</span><span class="p">:</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">lapack_info</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">LapackNotFoundError</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
                <span class="n">lapack_src_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;lapack_src&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">lapack_src_info</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">LapackSrcNotFoundError</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">libraries</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;flapack_src&#39;</span><span class="p">,</span> <span class="n">lapack_src_info</span><span class="p">)])</span>

        <span class="k">if</span> <span class="n">need_blas</span><span class="p">:</span>
            <span class="n">blas_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;blas&#39;</span><span class="p">)</span>
            <span class="c1">#blas_info = {} ## uncomment for testing</span>
            <span class="k">if</span> <span class="n">blas_info</span><span class="p">:</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">blas_info</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">BlasNotFoundError</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
                <span class="n">blas_src_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;blas_src&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">blas_src_info</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">BlasSrcNotFoundError</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">libraries</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;fblas_src&#39;</span><span class="p">,</span> <span class="n">blas_src_info</span><span class="p">)])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
        <span class="k">return</span>


<span class="k">class</span> <span class="nc">blas_opt_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>

    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">BlasNotFoundError</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">blas_mkl_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;blas_mkl&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">blas_mkl_info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">blas_mkl_info</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">openblas_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;openblas&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">openblas_info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">openblas_info</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">atlas_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;atlas_3_10_blas_threads&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">atlas_info</span><span class="p">:</span>
            <span class="n">atlas_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;atlas_3_10_blas&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">atlas_info</span><span class="p">:</span>
            <span class="n">atlas_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;atlas_blas_threads&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">atlas_info</span><span class="p">:</span>
            <span class="n">atlas_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;atlas_blas&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;darwin&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">atlas_info</span><span class="p">:</span>
            <span class="c1"># Use the system BLAS from Accelerate or vecLib under OSX</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">link_args</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">get_platform</span><span class="p">()[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;i386&#39;</span> <span class="ow">or</span> <span class="s1">&#39;intel&#39;</span> <span class="ow">in</span> <span class="n">get_platform</span><span class="p">()</span> <span class="ow">or</span> \
               <span class="s1">&#39;x86_64&#39;</span> <span class="ow">in</span> <span class="n">get_platform</span><span class="p">()</span> <span class="ow">or</span> \
               <span class="s1">&#39;i386&#39;</span> <span class="ow">in</span> <span class="n">platform</span><span class="o">.</span><span class="n">platform</span><span class="p">():</span>
                <span class="n">intel</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">intel</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;/System/Library/Frameworks&#39;</span>
                              <span class="s1">&#39;/Accelerate.framework/&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">intel</span><span class="p">:</span>
                    <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-msse3&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-faltivec&#39;</span><span class="p">])</span>
                <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                    <span class="s1">&#39;-I/System/Library/Frameworks/vecLib.framework/Headers&#39;</span><span class="p">])</span>
                <span class="n">link_args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-Wl,-framework&#39;</span><span class="p">,</span> <span class="s1">&#39;-Wl,Accelerate&#39;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;/System/Library/Frameworks&#39;</span>
                                <span class="s1">&#39;/vecLib.framework/&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">intel</span><span class="p">:</span>
                    <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-msse3&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-faltivec&#39;</span><span class="p">])</span>
                <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                    <span class="s1">&#39;-I/System/Library/Frameworks/vecLib.framework/Headers&#39;</span><span class="p">])</span>
                <span class="n">link_args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-Wl,-framework&#39;</span><span class="p">,</span> <span class="s1">&#39;-Wl,vecLib&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">args</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="n">extra_compile_args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
                              <span class="n">extra_link_args</span><span class="o">=</span><span class="n">link_args</span><span class="p">,</span>
                              <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;NO_ATLAS_INFO&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                                             <span class="p">(</span><span class="s1">&#39;HAVE_CBLAS&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)])</span>
                <span class="k">return</span>

        <span class="n">need_blas</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">atlas_info</span><span class="p">:</span>
            <span class="n">info</span> <span class="o">=</span> <span class="n">atlas_info</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">AtlasNotFoundError</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
            <span class="n">need_blas</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;NO_ATLAS_INFO&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>

        <span class="k">if</span> <span class="n">need_blas</span><span class="p">:</span>
            <span class="n">blas_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;blas&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">blas_info</span><span class="p">:</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">blas_info</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">BlasNotFoundError</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
                <span class="n">blas_src_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;blas_src&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">blas_src_info</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">BlasSrcNotFoundError</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">libraries</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;fblas_src&#39;</span><span class="p">,</span> <span class="n">blas_src_info</span><span class="p">)])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
        <span class="k">return</span>


<span class="k">class</span> <span class="nc">blas_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;blas&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;BLAS&#39;</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blas&#39;</span><span class="p">]</span>
    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">BlasNotFoundError</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lib_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lib_dirs</span><span class="p">()</span>
        <span class="n">blas_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;blas_libs&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_names</span><span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">blas_libs</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Windows&#39;</span><span class="p">:</span>
            <span class="c1"># The check for windows is needed because has_cblas uses the</span>
            <span class="c1"># same compiler that was used to compile Python and msvc is</span>
            <span class="c1"># often not installed when mingw is being used. This rough</span>
            <span class="c1"># treatment is not desirable, but windows is tricky.</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;f77&#39;</span>  <span class="c1"># XXX: is it generally true?</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_cblas</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">lib</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;libraries&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lib</span><span class="p">]</span>
                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;define_macros&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;HAVE_CBLAS&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">has_cblas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="c1"># primitive cblas check by looking for the header and trying to link</span>
        <span class="c1"># cblas or blas</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">distutils</span><span class="o">.</span><span class="n">ccompiler</span><span class="o">.</span><span class="n">new_compiler</span><span class="p">()</span>
        <span class="n">tmpdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;#include &lt;cblas.h&gt;</span>
<span class="s2">        int main(int argc, const char *argv[])</span>
<span class="s2">        {</span>
<span class="s2">            double a[4] = {1,2,3,4};</span>
<span class="s2">            double b[4] = {5,6,7,8};</span>
<span class="s2">            return cblas_ddot(4, a, 1, b, 1) &gt; 10;</span>
<span class="s2">        }&quot;&quot;&quot;</span>
        <span class="n">src</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">,</span> <span class="s1">&#39;source.c&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="s1">&#39;wt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># check we can compile (find headers)</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compile</span><span class="p">([</span><span class="n">src</span><span class="p">],</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">tmpdir</span><span class="p">,</span>
                                <span class="n">include_dirs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_include_dirs</span><span class="p">())</span>

                <span class="c1"># check we can link (find library)</span>
                <span class="c1"># some systems have separate cblas and blas libs. First</span>
                <span class="c1"># check for cblas lib, and if not present check for blas lib.</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">c</span><span class="o">.</span><span class="n">link_executable</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">,</span> <span class="s2">&quot;a.out&quot;</span><span class="p">),</span>
                                      <span class="n">libraries</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cblas&quot;</span><span class="p">],</span>
                                      <span class="n">library_dirs</span><span class="o">=</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;library_dirs&#39;</span><span class="p">],</span>
                                      <span class="n">extra_postargs</span><span class="o">=</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;extra_link_args&#39;</span><span class="p">,</span> <span class="p">[]))</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;cblas&quot;</span>
                <span class="k">except</span> <span class="n">distutils</span><span class="o">.</span><span class="n">ccompiler</span><span class="o">.</span><span class="n">LinkError</span><span class="p">:</span>
                    <span class="n">c</span><span class="o">.</span><span class="n">link_executable</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">,</span> <span class="s2">&quot;a.out&quot;</span><span class="p">),</span>
                                      <span class="n">libraries</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;blas&quot;</span><span class="p">],</span>
                                      <span class="n">library_dirs</span><span class="o">=</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;library_dirs&#39;</span><span class="p">],</span>
                                      <span class="n">extra_postargs</span><span class="o">=</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;extra_link_args&#39;</span><span class="p">,</span> <span class="p">[]))</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;blas&quot;</span>
            <span class="k">except</span> <span class="n">distutils</span><span class="o">.</span><span class="n">ccompiler</span><span class="o">.</span><span class="n">CompileError</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>


<span class="k">class</span> <span class="nc">openblas_info</span><span class="p">(</span><span class="n">blas_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;openblas&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;OPENBLAS&#39;</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;openblas&#39;</span><span class="p">]</span>
    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">BlasNotFoundError</span>

    <span class="k">def</span> <span class="nf">check_embedded_lapack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lib_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lib_dirs</span><span class="p">()</span>

        <span class="n">openblas_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;libraries&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_names</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">openblas_libs</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_names</span><span class="p">:</span> <span class="c1"># backward compat with 1.8.0</span>
            <span class="n">openblas_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;openblas_libs&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_names</span><span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">openblas_libs</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Add extra info for OpenBLAS</span>
        <span class="n">extra_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_extra_info</span><span class="p">()</span>
        <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_info</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_embedded_lapack</span><span class="p">(</span><span class="n">info</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;define_macros&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;HAVE_CBLAS&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">openblas_lapack_info</span><span class="p">(</span><span class="n">openblas_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;openblas&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;OPENBLAS&#39;</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;openblas&#39;</span><span class="p">]</span>
    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">BlasNotFoundError</span>

    <span class="k">def</span> <span class="nf">check_embedded_lapack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">distutils</span><span class="o">.</span><span class="n">ccompiler</span><span class="o">.</span><span class="n">new_compiler</span><span class="p">()</span>
        <span class="n">tmpdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;void zungqr();</span>
<span class="s2">        int main(int argc, const char *argv[])</span>
<span class="s2">        {</span>
<span class="s2">            zungqr_();</span>
<span class="s2">            return 0;</span>
<span class="s2">        }&quot;&quot;&quot;</span>
        <span class="n">src</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">,</span> <span class="s1">&#39;source.c&#39;</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">,</span> <span class="s1">&#39;a.out&#39;</span><span class="p">)</span>
        <span class="c1"># Add the additional &quot;extra&quot; arguments</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">extra_args</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;extra_link_args&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">extra_args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="s1">&#39;wt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compile</span><span class="p">([</span><span class="n">src</span><span class="p">],</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">tmpdir</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">c</span><span class="o">.</span><span class="n">link_executable</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">libraries</span><span class="o">=</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;libraries&#39;</span><span class="p">],</span>
                                  <span class="n">library_dirs</span><span class="o">=</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;library_dirs&#39;</span><span class="p">],</span>
                                  <span class="n">extra_postargs</span><span class="o">=</span><span class="n">extra_args</span><span class="p">)</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">except</span> <span class="n">distutils</span><span class="o">.</span><span class="n">ccompiler</span><span class="o">.</span><span class="n">LinkError</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>


<span class="k">class</span> <span class="nc">blas_src_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;blas_src&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;BLAS_SRC&#39;</span>
    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">BlasSrcNotFoundError</span>

    <span class="k">def</span> <span class="nf">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">pre_dirs</span> <span class="o">=</span> <span class="n">system_info</span><span class="o">.</span><span class="n">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">pre_dirs</span><span class="p">:</span>
            <span class="n">dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">d</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;blas&#39;</span><span class="p">]))</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">src_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_src_dirs</span><span class="p">()</span>
        <span class="n">src_dir</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">src_dirs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;daxpy.f&#39;</span><span class="p">)):</span>
                <span class="n">src_dir</span> <span class="o">=</span> <span class="n">d</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">src_dir</span><span class="p">:</span>
            <span class="c1">#XXX: Get sources from netlib. May be ask first.</span>
            <span class="k">return</span>
        <span class="n">blas1</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        caxpy csscal dnrm2 dzasum saxpy srotg zdotc ccopy cswap drot</span>
<span class="s1">        dznrm2 scasum srotm zdotu cdotc dasum drotg icamax scnrm2</span>
<span class="s1">        srotmg zdrot cdotu daxpy drotm idamax scopy sscal zdscal crotg</span>
<span class="s1">        dcabs1 drotmg isamax sdot sswap zrotg cscal dcopy dscal izamax</span>
<span class="s1">        snrm2 zaxpy zscal csrot ddot dswap sasum srot zcopy zswap</span>
<span class="s1">        scabs1</span>
<span class="s1">        &#39;&#39;&#39;</span>
        <span class="n">blas2</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        cgbmv chpmv ctrsv dsymv dtrsv sspr2 strmv zhemv ztpmv cgemv</span>
<span class="s1">        chpr dgbmv dsyr lsame ssymv strsv zher ztpsv cgerc chpr2 dgemv</span>
<span class="s1">        dsyr2 sgbmv ssyr xerbla zher2 ztrmv cgeru ctbmv dger dtbmv</span>
<span class="s1">        sgemv ssyr2 zgbmv zhpmv ztrsv chbmv ctbsv dsbmv dtbsv sger</span>
<span class="s1">        stbmv zgemv zhpr chemv ctpmv dspmv dtpmv ssbmv stbsv zgerc</span>
<span class="s1">        zhpr2 cher ctpsv dspr dtpsv sspmv stpmv zgeru ztbmv cher2</span>
<span class="s1">        ctrmv dspr2 dtrmv sspr stpsv zhbmv ztbsv</span>
<span class="s1">        &#39;&#39;&#39;</span>
        <span class="n">blas3</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        cgemm csymm ctrsm dsyrk sgemm strmm zhemm zsyr2k chemm csyr2k</span>
<span class="s1">        dgemm dtrmm ssymm strsm zher2k zsyrk cher2k csyrk dsymm dtrsm</span>
<span class="s1">        ssyr2k zherk ztrmm cherk ctrmm dsyr2k ssyrk zgemm zsymm ztrsm</span>
<span class="s1">        &#39;&#39;&#39;</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_dir</span><span class="p">,</span> <span class="n">f</span> <span class="o">+</span> <span class="s1">&#39;.f&#39;</span><span class="p">)</span> \
                   <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">(</span><span class="n">blas1</span> <span class="o">+</span> <span class="n">blas2</span> <span class="o">+</span> <span class="n">blas3</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
        <span class="c1">#XXX: should we check here actual existence of source files?</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">sources</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sources&#39;</span><span class="p">:</span> <span class="n">sources</span><span class="p">,</span> <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="s1">&#39;f77&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">x11_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;x11&#39;</span>
    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">X11NotFoundError</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">system_info</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                             <span class="n">default_lib_dirs</span><span class="o">=</span><span class="n">default_x11_lib_dirs</span><span class="p">,</span>
                             <span class="n">default_include_dirs</span><span class="o">=</span><span class="n">default_x11_include_dirs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span>  <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;win32&#39;</span><span class="p">]:</span>
            <span class="k">return</span>
        <span class="n">lib_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lib_dirs</span><span class="p">()</span>
        <span class="n">include_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_include_dirs</span><span class="p">()</span>
        <span class="n">x11_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;x11_libs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;X11&#39;</span><span class="p">])</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">x11_libs</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">inc_dir</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">include_dirs</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;X11/X.h&#39;</span><span class="p">):</span>
                <span class="n">inc_dir</span> <span class="o">=</span> <span class="n">d</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">inc_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">include_dirs</span><span class="o">=</span><span class="p">[</span><span class="n">inc_dir</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_numpy_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;Numeric&#39;</span>
    <span class="n">modulename</span> <span class="o">=</span> <span class="s1">&#39;Numeric&#39;</span>
    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">NumericNotFoundError</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">include_dirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modulename</span><span class="p">)</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">__file__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;lib&#39;</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">prefix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

            <span class="c1"># Ask numpy for its own include path before attempting</span>
            <span class="c1"># anything else</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">include_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s1">&#39;get_include&#39;</span><span class="p">)())</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="n">include_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distutils</span><span class="o">.</span><span class="n">sysconfig</span><span class="o">.</span><span class="n">get_python_inc</span><span class="p">(</span>
                                        <span class="n">prefix</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prefix</span><span class="p">)))</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">py_incl_dir</span> <span class="o">=</span> <span class="n">distutils</span><span class="o">.</span><span class="n">sysconfig</span><span class="o">.</span><span class="n">get_python_inc</span><span class="p">()</span>
        <span class="n">include_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">py_incl_dir</span><span class="p">)</span>
        <span class="n">py_pincl_dir</span> <span class="o">=</span> <span class="n">distutils</span><span class="o">.</span><span class="n">sysconfig</span><span class="o">.</span><span class="n">get_python_inc</span><span class="p">(</span><span class="n">plat_specific</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">py_pincl_dir</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">include_dirs</span><span class="p">:</span>
            <span class="n">include_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">py_pincl_dir</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">default_include_dirs</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">py_incl_dir</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">d</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">include_dirs</span><span class="p">:</span>
                <span class="n">include_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">system_info</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                             <span class="n">default_lib_dirs</span><span class="o">=</span><span class="p">[],</span>
                             <span class="n">default_include_dirs</span><span class="o">=</span><span class="n">include_dirs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modulename</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">macros</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">&#39;version&#39;</span><span class="p">]:</span>
            <span class="n">vrs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vrs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">macros</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">modulename</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;_VERSION&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;&quot;</span><span class="se">\\</span><span class="s1">&quot;</span><span class="si">%s</span><span class="se">\\</span><span class="s1">&quot;&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">vrs</span><span class="p">)),</span>
                      <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modulename</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="bp">None</span><span class="p">)]</span>
            <span class="k">break</span>
<span class="c1">##         try:</span>
<span class="c1">##             macros.append(</span>
<span class="c1">##                 (self.modulename.upper()+&#39;_VERSION_HEX&#39;,</span>
<span class="c1">##                  hex(vstr2hex(module.__version__))),</span>
<span class="c1">##                 )</span>
<span class="c1">##         except Exception as msg:</span>
<span class="c1">##             print msg</span>
        <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">define_macros</span><span class="o">=</span><span class="n">macros</span><span class="p">)</span>
        <span class="n">include_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_include_dirs</span><span class="p">()</span>
        <span class="n">inc_dir</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">include_dirs</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span>
                                  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modulename</span><span class="p">,</span>
                                               <span class="s1">&#39;arrayobject.h&#39;</span><span class="p">)):</span>
                <span class="n">inc_dir</span> <span class="o">=</span> <span class="n">d</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">inc_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">include_dirs</span><span class="o">=</span><span class="p">[</span><span class="n">inc_dir</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
        <span class="k">return</span>


<span class="k">class</span> <span class="nc">numarray_info</span><span class="p">(</span><span class="n">_numpy_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;numarray&#39;</span>
    <span class="n">modulename</span> <span class="o">=</span> <span class="s1">&#39;numarray&#39;</span>


<span class="k">class</span> <span class="nc">Numeric_info</span><span class="p">(</span><span class="n">_numpy_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;Numeric&#39;</span>
    <span class="n">modulename</span> <span class="o">=</span> <span class="s1">&#39;Numeric&#39;</span>


<span class="k">class</span> <span class="nc">numpy_info</span><span class="p">(</span><span class="n">_numpy_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;numpy&#39;</span>
    <span class="n">modulename</span> <span class="o">=</span> <span class="s1">&#39;numpy&#39;</span>


<span class="k">class</span> <span class="nc">numerix_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;numerix&#39;</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">which</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;NUMERIX&quot;</span><span class="p">):</span>
            <span class="n">which</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;NUMERIX&quot;</span><span class="p">),</span> <span class="s2">&quot;environment var&quot;</span>
        <span class="c1"># If all the above fail, default to numpy.</span>
        <span class="k">if</span> <span class="n">which</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">which</span> <span class="o">=</span> <span class="s2">&quot;numpy&quot;</span><span class="p">,</span> <span class="s2">&quot;defaulted&quot;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">numpy</span>
                <span class="n">which</span> <span class="o">=</span> <span class="s2">&quot;numpy&quot;</span><span class="p">,</span> <span class="s2">&quot;defaulted&quot;</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">msg1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_exception</span><span class="p">())</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="kn">import</span> <span class="nn">Numeric</span>
                    <span class="n">which</span> <span class="o">=</span> <span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="s2">&quot;defaulted&quot;</span>
                <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                    <span class="n">msg2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_exception</span><span class="p">())</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="kn">import</span> <span class="nn">numarray</span>
                        <span class="n">which</span> <span class="o">=</span> <span class="s2">&quot;numarray&quot;</span><span class="p">,</span> <span class="s2">&quot;defaulted&quot;</span>
                    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                        <span class="n">msg3</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_exception</span><span class="p">())</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg1</span><span class="p">)</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg2</span><span class="p">)</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg3</span><span class="p">)</span>
        <span class="n">which</span> <span class="o">=</span> <span class="n">which</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">which</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">which</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="s2">&quot;numarray&quot;</span><span class="p">,</span> <span class="s2">&quot;numpy&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;numerix selector must be either &#39;Numeric&#39; &quot;</span>
                             <span class="s2">&quot;or &#39;numarray&#39; or &#39;numpy&#39; but the value obtained&quot;</span>
                             <span class="s2">&quot; from the </span><span class="si">%s</span><span class="s2"> was &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">which</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">which</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;NUMERIX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">which</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">get_info</span><span class="p">(</span><span class="n">which</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>


<span class="k">class</span> <span class="nc">f2py_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">numpy.f2py</span> <span class="kn">as</span> <span class="nn">f2py</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">f2py_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">f2py</span><span class="o">.</span><span class="n">__file__</span><span class="p">),</span> <span class="s1">&#39;src&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="n">sources</span><span class="o">=</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">f2py_dir</span><span class="p">,</span> <span class="s1">&#39;fortranobject.c&#39;</span><span class="p">)],</span>
                      <span class="n">include_dirs</span><span class="o">=</span><span class="p">[</span><span class="n">f2py_dir</span><span class="p">])</span>
        <span class="k">return</span>


<span class="k">class</span> <span class="nc">boost_python_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;boost_python&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;BOOST&#39;</span>

    <span class="k">def</span> <span class="nf">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">pre_dirs</span> <span class="o">=</span> <span class="n">system_info</span><span class="o">.</span><span class="n">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">pre_dirs</span><span class="p">:</span>
            <span class="n">dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">d</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;boost*&#39;</span><span class="p">]))</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">src_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_src_dirs</span><span class="p">()</span>
        <span class="n">src_dir</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">src_dirs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;libs&#39;</span><span class="p">,</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="s1">&#39;src&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;module.cpp&#39;</span><span class="p">)):</span>
                <span class="n">src_dir</span> <span class="o">=</span> <span class="n">d</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">src_dir</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">py_incl_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">distutils</span><span class="o">.</span><span class="n">sysconfig</span><span class="o">.</span><span class="n">get_python_inc</span><span class="p">()]</span>
        <span class="n">py_pincl_dir</span> <span class="o">=</span> <span class="n">distutils</span><span class="o">.</span><span class="n">sysconfig</span><span class="o">.</span><span class="n">get_python_inc</span><span class="p">(</span><span class="n">plat_specific</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">py_pincl_dir</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">py_incl_dirs</span><span class="p">:</span>
            <span class="n">py_incl_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">py_pincl_dir</span><span class="p">)</span>
        <span class="n">srcs_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_dir</span><span class="p">,</span> <span class="s1">&#39;libs&#39;</span><span class="p">,</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="s1">&#39;src&#39;</span><span class="p">)</span>
        <span class="n">bpl_srcs</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">srcs_dir</span><span class="p">,</span> <span class="s1">&#39;*.cpp&#39;</span><span class="p">))</span>
        <span class="n">bpl_srcs</span> <span class="o">+=</span> <span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">srcs_dir</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;*.cpp&#39;</span><span class="p">))</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;libraries&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;boost_python_src&#39;</span><span class="p">,</span>
                               <span class="p">{</span><span class="s1">&#39;include_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">src_dir</span><span class="p">]</span> <span class="o">+</span> <span class="n">py_incl_dirs</span><span class="p">,</span>
                                <span class="s1">&#39;sources&#39;</span><span class="p">:</span><span class="n">bpl_srcs</span><span class="p">}</span>
                              <span class="p">)],</span>
                <span class="s1">&#39;include_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">src_dir</span><span class="p">],</span>
                <span class="p">}</span>
        <span class="k">if</span> <span class="n">info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
        <span class="k">return</span>


<span class="k">class</span> <span class="nc">agg2_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;agg2&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;AGG2&#39;</span>

    <span class="k">def</span> <span class="nf">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">pre_dirs</span> <span class="o">=</span> <span class="n">system_info</span><span class="o">.</span><span class="n">get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">pre_dirs</span><span class="p">:</span>
            <span class="n">dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">d</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;agg2*&#39;</span><span class="p">]))</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">src_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_src_dirs</span><span class="p">()</span>
        <span class="n">src_dir</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">src_dirs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;src&#39;</span><span class="p">,</span> <span class="s1">&#39;agg_affine_matrix.cpp&#39;</span><span class="p">)):</span>
                <span class="n">src_dir</span> <span class="o">=</span> <span class="n">d</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">src_dir</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
            <span class="n">agg2_srcs</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_dir</span><span class="p">,</span> <span class="s1">&#39;src&#39;</span><span class="p">,</span> <span class="s1">&#39;platform&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;win32&#39;</span><span class="p">,</span> <span class="s1">&#39;agg_win32_bmp.cpp&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">agg2_srcs</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_dir</span><span class="p">,</span> <span class="s1">&#39;src&#39;</span><span class="p">,</span> <span class="s1">&#39;*.cpp&#39;</span><span class="p">))</span>
            <span class="n">agg2_srcs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_dir</span><span class="p">,</span> <span class="s1">&#39;src&#39;</span><span class="p">,</span> <span class="s1">&#39;platform&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;X11&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;agg_platform_support.cpp&#39;</span><span class="p">)]</span>

        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;libraries&#39;</span><span class="p">:</span>
                <span class="p">[(</span><span class="s1">&#39;agg2_src&#39;</span><span class="p">,</span>
                  <span class="p">{</span><span class="s1">&#39;sources&#39;</span><span class="p">:</span> <span class="n">agg2_srcs</span><span class="p">,</span>
                   <span class="s1">&#39;include_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_dir</span><span class="p">,</span> <span class="s1">&#39;include&#39;</span><span class="p">)],</span>
                  <span class="p">}</span>
                 <span class="p">)],</span>
                <span class="s1">&#39;include_dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src_dir</span><span class="p">,</span> <span class="s1">&#39;include&#39;</span><span class="p">)],</span>
                <span class="p">}</span>
        <span class="k">if</span> <span class="n">info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
        <span class="k">return</span>


<span class="k">class</span> <span class="nc">_pkg_config_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">config_env_var</span> <span class="o">=</span> <span class="s1">&#39;PKG_CONFIG&#39;</span>
    <span class="n">default_config_exe</span> <span class="o">=</span> <span class="s1">&#39;pkg-config&#39;</span>
    <span class="n">append_config_exe</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">version_macro_name</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">release_macro_name</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">version_flag</span> <span class="o">=</span> <span class="s1">&#39;--modversion&#39;</span>
    <span class="n">cflags_flag</span> <span class="o">=</span> <span class="s1">&#39;--cflags&#39;</span>

    <span class="k">def</span> <span class="nf">get_config_exe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_env_var</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config_env_var</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_config_exe</span>

    <span class="k">def</span> <span class="nf">get_config_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_exe</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">config_exe</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">append_config_exe</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">option</span>
        <span class="n">s</span><span class="p">,</span> <span class="n">o</span> <span class="o">=</span> <span class="n">exec_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">use_tee</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">o</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">config_exe</span> <span class="o">=</span> <span class="n">find_executable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_config_exe</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">config_exe</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;File not found: </span><span class="si">%s</span><span class="s1">. Cannot determine </span><span class="si">%s</span><span class="s1"> info.&#39;</span> \
                  <span class="o">%</span> <span class="p">(</span><span class="n">config_exe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">macros</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">libraries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">library_dirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">include_dirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">extra_link_args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">extra_compile_args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_output</span><span class="p">(</span><span class="n">config_exe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">version_flag</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">version</span><span class="p">:</span>
            <span class="n">macros</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
                           <span class="s1">&#39;&quot;</span><span class="se">\\</span><span class="s1">&quot;</span><span class="si">%s</span><span class="se">\\</span><span class="s1">&quot;&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">version</span><span class="p">)))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version_macro_name</span><span class="p">:</span>
                <span class="n">macros</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">version_macro_name</span> <span class="o">+</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">&#39;</span>
                               <span class="o">%</span> <span class="p">(</span><span class="n">version</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)),</span> <span class="bp">None</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">release_macro_name</span><span class="p">:</span>
            <span class="n">release</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_output</span><span class="p">(</span><span class="n">config_exe</span><span class="p">,</span> <span class="s1">&#39;--release&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">release</span><span class="p">:</span>
                <span class="n">macros</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">release_macro_name</span> <span class="o">+</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">&#39;</span>
                               <span class="o">%</span> <span class="p">(</span><span class="n">release</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)),</span> <span class="bp">None</span><span class="p">))</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_output</span><span class="p">(</span><span class="n">config_exe</span><span class="p">,</span> <span class="s1">&#39;--libs&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">opts</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">opts</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">opt</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-l&#39;</span><span class="p">:</span>
                    <span class="n">libraries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
                <span class="k">elif</span> <span class="n">opt</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-L&#39;</span><span class="p">:</span>
                    <span class="n">library_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">extra_link_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_output</span><span class="p">(</span><span class="n">config_exe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cflags_flag</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">opts</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">opts</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">opt</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-I&#39;</span><span class="p">:</span>
                    <span class="n">include_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
                <span class="k">elif</span> <span class="n">opt</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-D&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span>
                        <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">opt</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
                        <span class="n">macros</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">macros</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">opt</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="bp">None</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">extra_compile_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">macros</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">define_macros</span><span class="o">=</span><span class="n">macros</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">libraries</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">libraries</span><span class="o">=</span><span class="n">libraries</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">library_dirs</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">library_dirs</span><span class="o">=</span><span class="n">library_dirs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">include_dirs</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">include_dirs</span><span class="o">=</span><span class="n">include_dirs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extra_link_args</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">extra_link_args</span><span class="o">=</span><span class="n">extra_link_args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extra_compile_args</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">extra_compile_args</span><span class="o">=</span><span class="n">extra_compile_args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
        <span class="k">return</span>


<span class="k">class</span> <span class="nc">wx_info</span><span class="p">(</span><span class="n">_pkg_config_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;wx&#39;</span>
    <span class="n">config_env_var</span> <span class="o">=</span> <span class="s1">&#39;WX_CONFIG&#39;</span>
    <span class="n">default_config_exe</span> <span class="o">=</span> <span class="s1">&#39;wx-config&#39;</span>
    <span class="n">append_config_exe</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">version_macro_name</span> <span class="o">=</span> <span class="s1">&#39;WX_VERSION&#39;</span>
    <span class="n">release_macro_name</span> <span class="o">=</span> <span class="s1">&#39;WX_RELEASE&#39;</span>
    <span class="n">version_flag</span> <span class="o">=</span> <span class="s1">&#39;--version&#39;</span>
    <span class="n">cflags_flag</span> <span class="o">=</span> <span class="s1">&#39;--cxxflags&#39;</span>


<span class="k">class</span> <span class="nc">gdk_pixbuf_xlib_2_info</span><span class="p">(</span><span class="n">_pkg_config_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;gdk_pixbuf_xlib_2&#39;</span>
    <span class="n">append_config_exe</span> <span class="o">=</span> <span class="s1">&#39;gdk-pixbuf-xlib-2.0&#39;</span>
    <span class="n">version_macro_name</span> <span class="o">=</span> <span class="s1">&#39;GDK_PIXBUF_XLIB_VERSION&#39;</span>


<span class="k">class</span> <span class="nc">gdk_pixbuf_2_info</span><span class="p">(</span><span class="n">_pkg_config_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;gdk_pixbuf_2&#39;</span>
    <span class="n">append_config_exe</span> <span class="o">=</span> <span class="s1">&#39;gdk-pixbuf-2.0&#39;</span>
    <span class="n">version_macro_name</span> <span class="o">=</span> <span class="s1">&#39;GDK_PIXBUF_VERSION&#39;</span>


<span class="k">class</span> <span class="nc">gdk_x11_2_info</span><span class="p">(</span><span class="n">_pkg_config_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;gdk_x11_2&#39;</span>
    <span class="n">append_config_exe</span> <span class="o">=</span> <span class="s1">&#39;gdk-x11-2.0&#39;</span>
    <span class="n">version_macro_name</span> <span class="o">=</span> <span class="s1">&#39;GDK_X11_VERSION&#39;</span>


<span class="k">class</span> <span class="nc">gdk_2_info</span><span class="p">(</span><span class="n">_pkg_config_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;gdk_2&#39;</span>
    <span class="n">append_config_exe</span> <span class="o">=</span> <span class="s1">&#39;gdk-2.0&#39;</span>
    <span class="n">version_macro_name</span> <span class="o">=</span> <span class="s1">&#39;GDK_VERSION&#39;</span>


<span class="k">class</span> <span class="nc">gdk_info</span><span class="p">(</span><span class="n">_pkg_config_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;gdk&#39;</span>
    <span class="n">append_config_exe</span> <span class="o">=</span> <span class="s1">&#39;gdk&#39;</span>
    <span class="n">version_macro_name</span> <span class="o">=</span> <span class="s1">&#39;GDK_VERSION&#39;</span>


<span class="k">class</span> <span class="nc">gtkp_x11_2_info</span><span class="p">(</span><span class="n">_pkg_config_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;gtkp_x11_2&#39;</span>
    <span class="n">append_config_exe</span> <span class="o">=</span> <span class="s1">&#39;gtk+-x11-2.0&#39;</span>
    <span class="n">version_macro_name</span> <span class="o">=</span> <span class="s1">&#39;GTK_X11_VERSION&#39;</span>


<span class="k">class</span> <span class="nc">gtkp_2_info</span><span class="p">(</span><span class="n">_pkg_config_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;gtkp_2&#39;</span>
    <span class="n">append_config_exe</span> <span class="o">=</span> <span class="s1">&#39;gtk+-2.0&#39;</span>
    <span class="n">version_macro_name</span> <span class="o">=</span> <span class="s1">&#39;GTK_VERSION&#39;</span>


<span class="k">class</span> <span class="nc">xft_info</span><span class="p">(</span><span class="n">_pkg_config_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;xft&#39;</span>
    <span class="n">append_config_exe</span> <span class="o">=</span> <span class="s1">&#39;xft&#39;</span>
    <span class="n">version_macro_name</span> <span class="o">=</span> <span class="s1">&#39;XFT_VERSION&#39;</span>


<span class="k">class</span> <span class="nc">freetype2_info</span><span class="p">(</span><span class="n">_pkg_config_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;freetype2&#39;</span>
    <span class="n">append_config_exe</span> <span class="o">=</span> <span class="s1">&#39;freetype2&#39;</span>
    <span class="n">version_macro_name</span> <span class="o">=</span> <span class="s1">&#39;FREETYPE2_VERSION&#39;</span>


<span class="k">class</span> <span class="nc">amd_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;amd&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;AMD&#39;</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;amd&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lib_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lib_dirs</span><span class="p">()</span>

        <span class="n">amd_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;amd_libs&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_names</span><span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">amd_libs</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">include_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_include_dirs</span><span class="p">()</span>

        <span class="n">inc_dir</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">include_dirs</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;amd.h&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">:</span>
                <span class="n">inc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">inc_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">include_dirs</span><span class="o">=</span><span class="p">[</span><span class="n">inc_dir</span><span class="p">],</span>
                        <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;SCIPY_AMD_H&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)],</span>
                        <span class="n">swig_opts</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-I&#39;</span> <span class="o">+</span> <span class="n">inc_dir</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
        <span class="k">return</span>


<span class="k">class</span> <span class="nc">umfpack_info</span><span class="p">(</span><span class="n">system_info</span><span class="p">):</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;umfpack&#39;</span>
    <span class="n">dir_env_var</span> <span class="o">=</span> <span class="s1">&#39;UMFPACK&#39;</span>
    <span class="n">notfounderror</span> <span class="o">=</span> <span class="n">UmfpackNotFoundError</span>
    <span class="n">_lib_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;umfpack&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">calc_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lib_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lib_dirs</span><span class="p">()</span>

        <span class="n">umfpack_libs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_libs</span><span class="p">(</span><span class="s1">&#39;umfpack_libs&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lib_names</span><span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_libs</span><span class="p">(</span><span class="n">lib_dirs</span><span class="p">,</span> <span class="n">umfpack_libs</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">include_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_include_dirs</span><span class="p">()</span>

        <span class="n">inc_dir</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">include_dirs</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;umfpack&#39;</span><span class="p">],</span> <span class="s1">&#39;umfpack.h&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">:</span>
                <span class="n">inc_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">inc_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">include_dirs</span><span class="o">=</span><span class="p">[</span><span class="n">inc_dir</span><span class="p">],</span>
                        <span class="n">define_macros</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;SCIPY_UMFPACK_H&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)],</span>
                        <span class="n">swig_opts</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-I&#39;</span> <span class="o">+</span> <span class="n">inc_dir</span><span class="p">])</span>

        <span class="n">amd</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;amd&#39;</span><span class="p">)</span>
        <span class="n">dict_append</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">get_info</span><span class="p">(</span><span class="s1">&#39;amd&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
        <span class="k">return</span>

<span class="c1">## def vstr2hex(version):</span>
<span class="c1">##     bits = []</span>
<span class="c1">##     n = [24,16,8,4,0]</span>
<span class="c1">##     r = 0</span>
<span class="c1">##     for s in version.split(&#39;.&#39;):</span>
<span class="c1">##         r |= int(s) &lt;&lt; n[0]</span>
<span class="c1">##         del n[0]</span>
<span class="c1">##     return r</span>

<span class="c1">#--------------------------------------------------------------------</span>


<span class="k">def</span> <span class="nf">combine_paths</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Return a list of existing paths composed by all combinations of</span>
<span class="sd">        items from arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">a</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
        <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">r</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="n">glob</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">[])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">a0</span> <span class="ow">in</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">a1</span> <span class="ow">in</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">combine_paths</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">combine_paths</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">:]))</span>
    <span class="n">verbosity</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;verbosity&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;(paths: </span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="n">language_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;c++&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;f77&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;f90&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="n">inv_language_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;c++&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;f77&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;f90&#39;</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">dict_append</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
    <span class="n">languages</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kws</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;language&#39;</span><span class="p">:</span>
            <span class="n">languages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;library_dirs&#39;</span><span class="p">,</span> <span class="s1">&#39;include_dirs&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;extra_compile_args&#39;</span><span class="p">,</span> <span class="s1">&#39;extra_link_args&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;runtime_library_dirs&#39;</span><span class="p">,</span> <span class="s1">&#39;define_macros&#39;</span><span class="p">]:</span>
                <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span> <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">v</span> <span class="k">if</span> <span class="n">vv</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="k">if</span> <span class="n">languages</span><span class="p">:</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">inv_language_map</span><span class="p">[</span><span class="nb">max</span><span class="p">([</span><span class="n">language_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">])]</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>
    <span class="k">return</span>


<span class="k">def</span> <span class="nf">parseCmdLine</span><span class="p">(</span><span class="n">argv</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">,)):</span>
    <span class="kn">import</span> <span class="nn">optparse</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">optparse</span><span class="o">.</span><span class="n">OptionParser</span><span class="p">(</span><span class="s2">&quot;usage: %prog [-v] [info objs]&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-v&#39;</span><span class="p">,</span> <span class="s1">&#39;--verbose&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span>
                      <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;be verbose and print more messages&#39;</span><span class="p">)</span>

    <span class="n">opts</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">return</span> <span class="n">opts</span><span class="p">,</span> <span class="n">args</span>


<span class="k">def</span> <span class="nf">show_all</span><span class="p">(</span><span class="n">argv</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">inspect</span>
    <span class="k">if</span> <span class="n">argv</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">argv</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span>
    <span class="n">opts</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">parseCmdLine</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">opts</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">set_threshold</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">set_threshold</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">show_only</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span> <span class="o">!=</span> <span class="s1">&#39;_info&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="s1">&#39;_info&#39;</span>
        <span class="n">show_only</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">show_all</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">show_only</span>
    <span class="n">_gdict_</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">_gdict_</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">system_info</span><span class="p">)</span> <span class="ow">or</span> <span class="n">c</span> <span class="ow">is</span> <span class="n">system_info</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">show_all</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">show_only</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">del</span> <span class="n">show_only</span><span class="p">[</span><span class="n">show_only</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">)]</span>
        <span class="n">conf</span> <span class="o">=</span> <span class="n">c</span><span class="p">()</span>
        <span class="n">conf</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">get_info</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">show_only</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Info classes not defined: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">show_only</span><span class="p">))</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">show_all</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>