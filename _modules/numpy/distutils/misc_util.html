

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>numpy.distutils.misc_util &mdash; Numpy API</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Numpy API" href="../../../index.html"/>
        <link rel="up" title="numpy" href="../../numpy.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Numpy API
          

          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.html">1. NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.doc.html">2. <code class="docutils literal"><span class="pre">numpy.doc</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.lib.html">3. <code class="docutils literal"><span class="pre">numpy.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.random.html">4. <code class="docutils literal"><span class="pre">numpy.random</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.linalg.html">5. <code class="docutils literal"><span class="pre">numpy.linalg</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.fft.html">6. Discrete Fourier Transform (<code class="docutils literal"><span class="pre">numpy.fft</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.polynomial.html">7. <code class="docutils literal"><span class="pre">numpy.polynomial</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.testing.html">8. <code class="docutils literal"><span class="pre">numpy.testing</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.f2py.html">9. <code class="docutils literal"><span class="pre">numpy.f2py</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/numpy.distutils.html">10. <code class="docutils literal"><span class="pre">numpy.distutils</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/index.html">11. NumPy Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">12. Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Numpy API</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../numpy.html">numpy</a> &raquo;</li>
        
      <li>numpy.distutils.misc_util</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for numpy.distutils.misc_util</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">imp</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">atexit</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">shutil</span>

<span class="kn">import</span> <span class="nn">distutils</span>
<span class="kn">from</span> <span class="nn">distutils.errors</span> <span class="kn">import</span> <span class="n">DistutilsError</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">local</span> <span class="k">as</span> <span class="n">tlocal</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">dummy_threading</span> <span class="kn">import</span> <span class="n">local</span> <span class="k">as</span> <span class="n">tlocal</span>

<span class="c1"># stores temporary directory of each thread to only create one per thread</span>
<span class="n">_tdata</span> <span class="o">=</span> <span class="n">tlocal</span><span class="p">()</span>

<span class="c1"># store all created temporary directories so they can be deleted on exit</span>
<span class="n">_tmpdirs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">def</span> <span class="nf">clean_up_temporary_directory</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">_tmpdirs</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="k">pass</span>

<span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">clean_up_temporary_directory</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="nb">set</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">sets</span> <span class="kn">import</span> <span class="n">Set</span> <span class="k">as</span> <span class="nb">set</span>

<span class="kn">from</span> <span class="nn">numpy.distutils.compat</span> <span class="kn">import</span> <span class="n">get_exception</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Configuration&#39;</span><span class="p">,</span> <span class="s1">&#39;get_numpy_include_dirs&#39;</span><span class="p">,</span> <span class="s1">&#39;default_config_dict&#39;</span><span class="p">,</span>
           <span class="s1">&#39;dict_append&#39;</span><span class="p">,</span> <span class="s1">&#39;appendpath&#39;</span><span class="p">,</span> <span class="s1">&#39;generate_config_py&#39;</span><span class="p">,</span>
           <span class="s1">&#39;get_cmd&#39;</span><span class="p">,</span> <span class="s1">&#39;allpath&#39;</span><span class="p">,</span> <span class="s1">&#39;get_mathlibs&#39;</span><span class="p">,</span>
           <span class="s1">&#39;terminal_has_colors&#39;</span><span class="p">,</span> <span class="s1">&#39;red_text&#39;</span><span class="p">,</span> <span class="s1">&#39;green_text&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow_text&#39;</span><span class="p">,</span>
           <span class="s1">&#39;blue_text&#39;</span><span class="p">,</span> <span class="s1">&#39;cyan_text&#39;</span><span class="p">,</span> <span class="s1">&#39;cyg2win32&#39;</span><span class="p">,</span> <span class="s1">&#39;mingw32&#39;</span><span class="p">,</span> <span class="s1">&#39;all_strings&#39;</span><span class="p">,</span>
           <span class="s1">&#39;has_f_sources&#39;</span><span class="p">,</span> <span class="s1">&#39;has_cxx_sources&#39;</span><span class="p">,</span> <span class="s1">&#39;filter_sources&#39;</span><span class="p">,</span>
           <span class="s1">&#39;get_dependencies&#39;</span><span class="p">,</span> <span class="s1">&#39;is_local_src_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;get_ext_source_files&#39;</span><span class="p">,</span>
           <span class="s1">&#39;get_script_files&#39;</span><span class="p">,</span> <span class="s1">&#39;get_lib_source_files&#39;</span><span class="p">,</span> <span class="s1">&#39;get_data_files&#39;</span><span class="p">,</span>
           <span class="s1">&#39;dot_join&#39;</span><span class="p">,</span> <span class="s1">&#39;get_frame&#39;</span><span class="p">,</span> <span class="s1">&#39;minrelpath&#39;</span><span class="p">,</span> <span class="s1">&#39;njoin&#39;</span><span class="p">,</span>
           <span class="s1">&#39;is_sequence&#39;</span><span class="p">,</span> <span class="s1">&#39;is_string&#39;</span><span class="p">,</span> <span class="s1">&#39;as_list&#39;</span><span class="p">,</span> <span class="s1">&#39;gpaths&#39;</span><span class="p">,</span> <span class="s1">&#39;get_language&#39;</span><span class="p">,</span>
           <span class="s1">&#39;quote_args&#39;</span><span class="p">,</span> <span class="s1">&#39;get_build_architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;get_info&#39;</span><span class="p">,</span> <span class="s1">&#39;get_pkg_info&#39;</span><span class="p">,</span>
           <span class="s1">&#39;get_num_build_jobs&#39;</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">InstallableLib</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Container to hold information on an installable library.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        Name of the installed library.</span>
<span class="sd">    build_info : dict</span>
<span class="sd">        Dictionary holding build information.</span>
<span class="sd">    target_dir : str</span>
<span class="sd">        Absolute path specifying where to install the library.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Configuration.add_installed_library</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The three parameters are stored as attributes with the same names.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">build_info</span><span class="p">,</span> <span class="n">target_dir</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_info</span> <span class="o">=</span> <span class="n">build_info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">target_dir</span>


<span class="k">def</span> <span class="nf">get_num_build_jobs</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get number of parallel build jobs set by the --parallel command line</span>
<span class="sd">    argument of setup.py</span>
<span class="sd">    If the command did not receive a setting the environment variable</span>
<span class="sd">    NPY_NUM_BUILD_JOBS checked and if that is unset it returns 1.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : int</span>
<span class="sd">        number of parallel jobs that can be run</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">numpy.distutils.core</span> <span class="kn">import</span> <span class="n">get_distribution</span>
    <span class="n">envjobs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;NPY_NUM_BUILD_JOBS&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">get_distribution</span><span class="p">()</span>
    <span class="c1"># may be None during configuration</span>
    <span class="k">if</span> <span class="n">dist</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">envjobs</span>

    <span class="c1"># any of these three may have the job set, take the largest</span>
    <span class="n">cmdattr</span> <span class="o">=</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">get_command_obj</span><span class="p">(</span><span class="s1">&#39;build&#39;</span><span class="p">),</span> <span class="s1">&#39;parallel&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
               <span class="nb">getattr</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">get_command_obj</span><span class="p">(</span><span class="s1">&#39;build_ext&#39;</span><span class="p">),</span> <span class="s1">&#39;parallel&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
               <span class="nb">getattr</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">get_command_obj</span><span class="p">(</span><span class="s1">&#39;build_clib&#39;</span><span class="p">),</span> <span class="s1">&#39;parallel&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cmdattr</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">envjobs</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cmdattr</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">quote_args</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="c1"># don&#39;t used _nt_quote_args as it does not check if</span>
    <span class="c1"># args items already have quotes or not.</span>
    <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">&#39;&quot;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">args</span>

<div class="viewcode-block" id="allpath"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.allpath.html#numpy.distutils.misc_util.allpath">[docs]</a><span class="k">def</span> <span class="nf">allpath</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="s2">&quot;Convert a /-separated pathname to one using the OS&#39;s path separator.&quot;</span>
    <span class="n">splitted</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="n">splitted</span><span class="p">)</span></div>

<span class="k">def</span> <span class="nf">rel_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">parent_path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return path relative to parent_path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">parent_path</span><span class="p">)</span>
    <span class="n">apath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">apath</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">path</span>
    <span class="k">if</span> <span class="n">apath</span><span class="o">==</span><span class="n">pd</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">pd</span> <span class="o">==</span> <span class="n">apath</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="p">)]:</span>
        <span class="k">assert</span> <span class="n">apath</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="p">)]</span> <span class="ow">in</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">],</span> <span class="nb">repr</span><span class="p">((</span><span class="n">path</span><span class="p">,</span> <span class="n">apath</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="p">)]))</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">apath</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">path</span>

<span class="k">def</span> <span class="nf">get_path_from_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">parent_path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return path of the module given a frame object from the call stack.</span>

<span class="sd">    Returned path is relative to parent_path when given,</span>
<span class="sd">    otherwise it is absolute path.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># First, try to find if the file name is in the frame.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">caller_file</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;__file__&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_globals</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_locals</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">caller_file</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="c1"># __file__ is not defined, so let&#39;s try __name__. We try this second</span>
        <span class="c1"># because setuptools spoofs __name__ to be &#39;__main__&#39; even though</span>
        <span class="c1"># sys.modules[&#39;__main__&#39;] might be something else, like easy_install(1).</span>
        <span class="n">caller_name</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;__name__&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_globals</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_locals</span><span class="p">)</span>
        <span class="nb">__import__</span><span class="p">(</span><span class="n">caller_name</span><span class="p">)</span>
        <span class="n">mod</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">caller_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="s1">&#39;__file__&#39;</span><span class="p">):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">__file__</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># we&#39;re probably running setup.py as execfile(&quot;setup.py&quot;)</span>
            <span class="c1"># (likely we&#39;re building an egg)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="c1"># hmm, should we use sys.argv[0] like in __builtin__ case?</span>

    <span class="k">if</span> <span class="n">parent_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">rel_path</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">parent_path</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">d</span> <span class="ow">or</span> <span class="s1">&#39;.&#39;</span>

<span class="k">def</span> <span class="nf">njoin</span><span class="p">(</span><span class="o">*</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Join two or more pathname components +</span>
<span class="sd">    - convert a /-separated pathname to one using the OS&#39;s path separator.</span>
<span class="sd">    - resolve `..` and `.` from path.</span>

<span class="sd">    Either passing n arguments as in njoin(&#39;a&#39;,&#39;b&#39;), or a sequence</span>
<span class="sd">    of n names as in njoin([&#39;a&#39;,&#39;b&#39;]) is handled, or a mixture of such arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
            <span class="c1"># njoin([&#39;a&#39;, &#39;b&#39;], &#39;c&#39;)</span>
            <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">njoin</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">is_string</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">paths</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
        <span class="c1"># njoin()</span>
        <span class="n">joined</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># njoin(&#39;a&#39;, &#39;b&#39;)</span>
        <span class="n">joined</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
        <span class="n">joined</span> <span class="o">=</span> <span class="n">joined</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">minrelpath</span><span class="p">(</span><span class="n">joined</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_mathlibs</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the MATHLIB line from numpyconfig.h</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">config_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;_numpyconfig.h&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Look for the file in each of the numpy include directories.</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="n">get_numpy_include_dirs</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;_numpyconfig.h&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
                <span class="n">config_file</span> <span class="o">=</span> <span class="n">fn</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DistutilsError</span><span class="p">(</span><span class="s1">&#39;_numpyconfig.h not found in numpy include &#39;</span>
                <span class="s1">&#39;dirs </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dirs</span><span class="p">,))</span>

    <span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
    <span class="n">mathlibs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;#define MATHLIB&#39;</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fid</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">mathlibs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
    <span class="n">fid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">mathlibs</span>

<span class="k">def</span> <span class="nf">minrelpath</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Resolve `..` and &#39;.&#39; from path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_string</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">path</span>
    <span class="k">if</span> <span class="s1">&#39;.&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">path</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">l</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">del</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">l</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;..&#39;</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">l</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_fix_paths</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">include_non_existing</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">paths</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">paths</span><span class="p">))</span>
    <span class="n">new_paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">is_string</span><span class="p">(</span><span class="n">paths</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">n</span> <span class="ow">or</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">n</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">p2</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">njoin</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">p2</span><span class="p">:</span>
                    <span class="n">new_paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">p</span><span class="p">:</span>
                    <span class="n">new_paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">include_non_existing</span><span class="p">:</span>
                        <span class="n">new_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;could not resolve pattern in </span><span class="si">%r</span><span class="s1">: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span>
                            <span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n2</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
                    <span class="n">new_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                        <span class="n">new_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">include_non_existing</span><span class="p">:</span>
                        <span class="n">new_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;non-existing path in </span><span class="si">%r</span><span class="s1">: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span>
                                <span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">new_paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">_fix_paths</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">include_non_existing</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">minrelpath</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">new_paths</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">gpaths</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">local_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">include_non_existing</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Apply glob to paths and prepend local_path if needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">(</span><span class="n">paths</span><span class="p">,)</span>
    <span class="k">return</span> <span class="n">_fix_paths</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">include_non_existing</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">make_temp_file</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">_tdata</span><span class="p">,</span> <span class="s1">&#39;tempdir&#39;</span><span class="p">):</span>
        <span class="n">_tdata</span><span class="o">.</span><span class="n">tempdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
        <span class="n">_tmpdirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_tdata</span><span class="o">.</span><span class="n">tempdir</span><span class="p">)</span>
    <span class="n">fid</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
                                 <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
                                 <span class="nb">dir</span><span class="o">=</span><span class="n">_tdata</span><span class="o">.</span><span class="n">tempdir</span><span class="p">,</span>
                                 <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
    <span class="n">fo</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fdopen</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fo</span><span class="p">,</span> <span class="n">name</span>

<span class="c1"># Hooks for colored terminal output.</span>
<span class="c1"># See also http://www.livinglogic.de/Python/ansistyle</span>
<div class="viewcode-block" id="terminal_has_colors"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.terminal_has_colors.html#numpy.distutils.misc_util.terminal_has_colors">[docs]</a><span class="k">def</span> <span class="nf">terminal_has_colors</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">==</span><span class="s1">&#39;cygwin&#39;</span> <span class="ow">and</span> <span class="s1">&#39;USE_COLOR&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
        <span class="c1"># Avoid importing curses that causes illegal operation</span>
        <span class="c1"># with a message:</span>
        <span class="c1">#  PYTHON2 caused an invalid page fault in</span>
        <span class="c1">#  module CYGNURSES7.DLL as 015f:18bbfc28</span>
        <span class="c1"># Details: Python 2.3.3 [GCC 3.3.1 (cygming special)]</span>
        <span class="c1">#          ssh to Win32 machine from debian</span>
        <span class="c1">#          curses.version is 2.2</span>
        <span class="c1">#          CYGWIN_98-4.10, release 1.5.7(0.109/3/2))</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="s1">&#39;isatty&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">isatty</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">curses</span>
            <span class="n">curses</span><span class="o">.</span><span class="n">setupterm</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">tigetnum</span><span class="p">(</span><span class="s2">&quot;colors&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span>
                <span class="ow">and</span> <span class="n">curses</span><span class="o">.</span><span class="n">tigetnum</span><span class="p">(</span><span class="s2">&quot;pairs&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span>
                <span class="ow">and</span> <span class="p">((</span><span class="n">curses</span><span class="o">.</span><span class="n">tigetstr</span><span class="p">(</span><span class="s2">&quot;setf&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
                      <span class="ow">and</span> <span class="n">curses</span><span class="o">.</span><span class="n">tigetstr</span><span class="p">(</span><span class="s2">&quot;setb&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span>
                     <span class="ow">or</span> <span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">tigetstr</span><span class="p">(</span><span class="s2">&quot;setaf&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
                         <span class="ow">and</span> <span class="n">curses</span><span class="o">.</span><span class="n">tigetstr</span><span class="p">(</span><span class="s2">&quot;setab&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span>
                     <span class="ow">or</span> <span class="n">curses</span><span class="o">.</span><span class="n">tigetstr</span><span class="p">(</span><span class="s2">&quot;scp&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)):</span>
                <span class="k">return</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="mi">0</span></div>

<span class="k">if</span> <span class="n">terminal_has_colors</span><span class="p">():</span>
    <span class="n">_colour_codes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">black</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">red</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">green</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">yellow</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                         <span class="n">blue</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">magenta</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cyan</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">white</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">colour_text</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">bold</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fg</span><span class="p">:</span>
            <span class="n">fgcode</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">+</span> <span class="n">_colour_codes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fgcode</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">bg</span><span class="p">:</span>
            <span class="n">bgcode</span> <span class="o">=</span> <span class="mi">40</span> <span class="o">+</span> <span class="n">_colour_codes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="mi">7</span><span class="p">)</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">bgcode</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">seq</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\x1b</span><span class="s1">[</span><span class="si">%s</span><span class="s1">m</span><span class="si">%s</span><span class="se">\x1b</span><span class="s1">[0m&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq</span><span class="p">),</span> <span class="n">s</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">colour_text</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">s</span>

<span class="k">def</span> <span class="nf">default_text</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">colour_text</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="red_text"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.red_text.html#numpy.distutils.misc_util.red_text">[docs]</a><span class="k">def</span> <span class="nf">red_text</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">colour_text</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="green_text"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.green_text.html#numpy.distutils.misc_util.green_text">[docs]</a><span class="k">def</span> <span class="nf">green_text</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">colour_text</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="yellow_text"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.yellow_text.html#numpy.distutils.misc_util.yellow_text">[docs]</a><span class="k">def</span> <span class="nf">yellow_text</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">colour_text</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="cyan_text"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.cyan_text.html#numpy.distutils.misc_util.cyan_text">[docs]</a><span class="k">def</span> <span class="nf">cyan_text</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">colour_text</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="blue_text"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.blue_text.html#numpy.distutils.misc_util.blue_text">[docs]</a><span class="k">def</span> <span class="nf">blue_text</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">colour_text</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span></div>

<span class="c1">#########################</span>

<div class="viewcode-block" id="cyg2win32"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.cyg2win32.html#numpy.distutils.misc_util.cyg2win32">[docs]</a><span class="k">def</span> <span class="nf">cyg2win32</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">==</span><span class="s1">&#39;cygwin&#39;</span> <span class="ow">and</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/cygdrive&#39;</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normcase</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">11</span><span class="p">:])</span>
    <span class="k">return</span> <span class="n">path</span></div>

<span class="k">def</span> <span class="nf">mingw32</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Return true when using mingw32 environment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">==</span><span class="s1">&#39;win32&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OSTYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;msys&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MSYSTEM&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;MINGW32&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">msvc_runtime_library</span><span class="p">():</span>
    <span class="s2">&quot;Return name of MSVC runtime library if Python was built with MSVC &gt;= 7&quot;</span>
    <span class="n">msc_pos</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;MSC v.&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">msc_pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">msc_ver</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">[</span><span class="n">msc_pos</span><span class="o">+</span><span class="mi">6</span><span class="p">:</span><span class="n">msc_pos</span><span class="o">+</span><span class="mi">10</span><span class="p">]</span>
        <span class="n">lib</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;1300&#39;</span><span class="p">:</span> <span class="s1">&#39;msvcr70&#39;</span><span class="p">,</span>    <span class="c1"># MSVC 7.0</span>
               <span class="s1">&#39;1310&#39;</span><span class="p">:</span> <span class="s1">&#39;msvcr71&#39;</span><span class="p">,</span>    <span class="c1"># MSVC 7.1</span>
               <span class="s1">&#39;1400&#39;</span><span class="p">:</span> <span class="s1">&#39;msvcr80&#39;</span><span class="p">,</span>    <span class="c1"># MSVC 8</span>
               <span class="s1">&#39;1500&#39;</span><span class="p">:</span> <span class="s1">&#39;msvcr90&#39;</span><span class="p">,</span>    <span class="c1"># MSVC 9 (VS 2008)</span>
               <span class="s1">&#39;1600&#39;</span><span class="p">:</span> <span class="s1">&#39;msvcr100&#39;</span><span class="p">,</span>   <span class="c1"># MSVC 10 (aka 2010)</span>
              <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">msc_ver</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lib</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">return</span> <span class="n">lib</span>


<span class="c1">#########################</span>

<span class="c1">#XXX need support for .C that is also C++</span>
<span class="n">cxx_ext_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">r&#39;.*[.](cpp|cxx|cc)\Z&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">match</span>
<span class="n">fortran_ext_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">r&#39;.*[.](f90|f95|f77|for|ftn|f)\Z&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">match</span>
<span class="n">f90_ext_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">r&#39;.*[.](f90|f95)\Z&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">match</span>
<span class="n">f90_module_name_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">r&#39;\s*module\s*(?P&lt;name&gt;[\w_]+)&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">match</span>
<span class="k">def</span> <span class="nf">_get_f90_modules</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a list of Fortran f90 module names that</span>
<span class="sd">    given source file defines.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">f90_ext_match</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="n">modules</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">f90_module_name_match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
            <span class="n">modules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="c1"># break  # XXX can we assume that there is one module per file?</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">modules</span>

<span class="k">def</span> <span class="nf">is_string</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>

<div class="viewcode-block" id="all_strings"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.all_strings.html#numpy.distutils.misc_util.all_strings">[docs]</a><span class="k">def</span> <span class="nf">all_strings</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return True if all items in lst are string objects. &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_string</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span></div>

<span class="k">def</span> <span class="nf">is_sequence</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>

<span class="k">def</span> <span class="nf">is_glob_pattern</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">is_string</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">s</span> <span class="ow">or</span> <span class="s1">&#39;?&#39;</span> <span class="ow">is</span> <span class="n">s</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">as_list</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">seq</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">get_language</span><span class="p">(</span><span class="n">sources</span><span class="p">):</span>
    <span class="c1"># not used in numpy/scipy packages, use build_ext.detect_language instead</span>
    <span class="sd">&quot;&quot;&quot;Determine language value (c,f77,f90) from sources &quot;&quot;&quot;</span>
    <span class="n">language</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">f90_ext_match</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
                <span class="n">language</span> <span class="o">=</span> <span class="s1">&#39;f90&#39;</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="n">fortran_ext_match</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
                <span class="n">language</span> <span class="o">=</span> <span class="s1">&#39;f77&#39;</span>
    <span class="k">return</span> <span class="n">language</span>

<div class="viewcode-block" id="has_f_sources"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.has_f_sources.html#numpy.distutils.misc_util.has_f_sources">[docs]</a><span class="k">def</span> <span class="nf">has_f_sources</span><span class="p">(</span><span class="n">sources</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return True if sources contains Fortran files &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fortran_ext_match</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span></div>

<div class="viewcode-block" id="has_cxx_sources"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.has_cxx_sources.html#numpy.distutils.misc_util.has_cxx_sources">[docs]</a><span class="k">def</span> <span class="nf">has_cxx_sources</span><span class="p">(</span><span class="n">sources</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return True if sources contains C++ files &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cxx_ext_match</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span></div>

<div class="viewcode-block" id="filter_sources"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.filter_sources.html#numpy.distutils.misc_util.filter_sources">[docs]</a><span class="k">def</span> <span class="nf">filter_sources</span><span class="p">(</span><span class="n">sources</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return four lists of filenames containing</span>
<span class="sd">    C, C++, Fortran, and Fortran 90 module sources,</span>
<span class="sd">    respectively.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c_sources</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cxx_sources</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">f_sources</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fmodule_sources</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fortran_ext_match</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
            <span class="n">modules</span> <span class="o">=</span> <span class="n">_get_f90_modules</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">modules</span><span class="p">:</span>
                <span class="n">fmodule_sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">f_sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cxx_ext_match</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
            <span class="n">cxx_sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c_sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c_sources</span><span class="p">,</span> <span class="n">cxx_sources</span><span class="p">,</span> <span class="n">f_sources</span><span class="p">,</span> <span class="n">fmodule_sources</span></div>


<span class="k">def</span> <span class="nf">_get_headers</span><span class="p">(</span><span class="n">directory_list</span><span class="p">):</span>
    <span class="c1"># get *.h files from list of directories</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">directory_list</span><span class="p">:</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s2">&quot;*.h&quot;</span><span class="p">))</span> <span class="c1">#XXX: *.hpp files??</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">headers</span>

<span class="k">def</span> <span class="nf">_get_directories</span><span class="p">(</span><span class="n">list_of_sources</span><span class="p">):</span>
    <span class="c1"># get unique directories from list of sources.</span>
    <span class="n">direcs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">list_of_sources</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">direcs</span><span class="p">:</span>
            <span class="n">direcs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">direcs</span>

<div class="viewcode-block" id="get_dependencies"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.get_dependencies.html#numpy.distutils.misc_util.get_dependencies">[docs]</a><span class="k">def</span> <span class="nf">get_dependencies</span><span class="p">(</span><span class="n">sources</span><span class="p">):</span>
    <span class="c1">#XXX scan sources for include statements</span>
    <span class="k">return</span> <span class="n">_get_headers</span><span class="p">(</span><span class="n">_get_directories</span><span class="p">(</span><span class="n">sources</span><span class="p">))</span></div>

<div class="viewcode-block" id="is_local_src_dir"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.is_local_src_dir.html#numpy.distutils.misc_util.is_local_src_dir">[docs]</a><span class="k">def</span> <span class="nf">is_local_src_dir</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return true if directory is local directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_string</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="n">abs_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">commonprefix</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">abs_dir</span><span class="p">])</span>
    <span class="n">new_dir</span> <span class="o">=</span> <span class="n">abs_dir</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">):]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">new_dir</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">new_dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">new_dir</span> <span class="o">=</span> <span class="n">new_dir</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">if</span> <span class="n">new_dir</span> <span class="ow">and</span> <span class="n">new_dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;build&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="n">new_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_dir</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">new_dir</span><span class="p">)</span></div>

<span class="k">def</span> <span class="nf">general_source_files</span><span class="p">(</span><span class="n">top_path</span><span class="p">):</span>
    <span class="n">pruned_directories</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CVS&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;.svn&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;build&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
    <span class="n">prune_file_pat</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">r&#39;(?:[~#]|\.py[co]|\.o)$&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">dirpath</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">top_path</span><span class="p">,</span> <span class="n">topdown</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">pruned</span> <span class="o">=</span> <span class="p">[</span> <span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirnames</span> <span class="k">if</span> <span class="n">d</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pruned_directories</span> <span class="p">]</span>
        <span class="n">dirnames</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">pruned</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">prune_file_pat</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">general_source_directories_files</span><span class="p">(</span><span class="n">top_path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a directory name relative to top_path and</span>
<span class="sd">    files contained.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pruned_directories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CVS&#39;</span><span class="p">,</span> <span class="s1">&#39;.svn&#39;</span><span class="p">,</span> <span class="s1">&#39;build&#39;</span><span class="p">]</span>
    <span class="n">prune_file_pat</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">r&#39;(?:[~#]|\.py[co]|\.o)$&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">dirpath</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">top_path</span><span class="p">,</span> <span class="n">topdown</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">pruned</span> <span class="o">=</span> <span class="p">[</span> <span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirnames</span> <span class="k">if</span> <span class="n">d</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pruned_directories</span> <span class="p">]</span>
        <span class="n">dirnames</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">pruned</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirnames</span><span class="p">:</span>
            <span class="n">dpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
            <span class="n">rpath</span> <span class="o">=</span> <span class="n">rel_path</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span> <span class="n">top_path</span><span class="p">)</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">dpath</span><span class="p">):</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">prune_file_pat</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
                    <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">rpath</span><span class="p">,</span> <span class="n">files</span>
    <span class="n">dpath</span> <span class="o">=</span> <span class="n">top_path</span>
    <span class="n">rpath</span> <span class="o">=</span> <span class="n">rel_path</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span> <span class="n">top_path</span><span class="p">)</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">dpath</span><span class="p">)</span> \
                 <span class="k">if</span> <span class="ow">not</span> <span class="n">prune_file_pat</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span>
    <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filenames</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span>
    <span class="k">yield</span> <span class="n">rpath</span><span class="p">,</span> <span class="n">files</span>


<div class="viewcode-block" id="get_ext_source_files"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.get_ext_source_files.html#numpy.distutils.misc_util.get_ext_source_files">[docs]</a><span class="k">def</span> <span class="nf">get_ext_source_files</span><span class="p">(</span><span class="n">ext</span><span class="p">):</span>
    <span class="c1"># Get sources and any include files in the same directory.</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">_m</span> <span class="k">for</span> <span class="n">_m</span> <span class="ow">in</span> <span class="n">ext</span><span class="o">.</span><span class="n">sources</span> <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">_m</span><span class="p">)]</span>
    <span class="n">filenames</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
    <span class="n">filenames</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_dependencies</span><span class="p">(</span><span class="n">sources</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">ext</span><span class="o">.</span><span class="n">depends</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_local_src_dir</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="n">filenames</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">general_source_files</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">filenames</span></div>

<div class="viewcode-block" id="get_script_files"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.get_script_files.html#numpy.distutils.misc_util.get_script_files">[docs]</a><span class="k">def</span> <span class="nf">get_script_files</span><span class="p">(</span><span class="n">scripts</span><span class="p">):</span>
    <span class="n">scripts</span> <span class="o">=</span> <span class="p">[</span><span class="n">_m</span> <span class="k">for</span> <span class="n">_m</span> <span class="ow">in</span> <span class="n">scripts</span> <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">_m</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">scripts</span></div>

<span class="k">def</span> <span class="nf">get_lib_source_files</span><span class="p">(</span><span class="n">lib</span><span class="p">):</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sources</span> <span class="o">=</span> <span class="n">lib</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sources&#39;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">_m</span> <span class="k">for</span> <span class="n">_m</span> <span class="ow">in</span> <span class="n">sources</span> <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">_m</span><span class="p">)]</span>
    <span class="n">filenames</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
    <span class="n">filenames</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_dependencies</span><span class="p">(</span><span class="n">sources</span><span class="p">))</span>
    <span class="n">depends</span> <span class="o">=</span> <span class="n">lib</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;depends&#39;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">depends</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_local_src_dir</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="n">filenames</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">general_source_files</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">filenames</span>

<span class="k">def</span> <span class="nf">get_shared_lib_extension</span><span class="p">(</span><span class="n">is_python_ext</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the correct file extension for shared libraries.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    is_python_ext : bool, optional</span>
<span class="sd">        Whether the shared library is a Python extension.  Default is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    so_ext : str</span>
<span class="sd">        The shared library extension.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    For Python shared libs, `so_ext` will typically be &#39;.so&#39; on Linux and OS X,</span>
<span class="sd">    and &#39;.pyd&#39; on Windows.  For Python &gt;= 3.2 `so_ext` has a tag prepended on</span>
<span class="sd">    POSIX systems according to PEP 3149.  For Python 3.2 this is implemented on</span>
<span class="sd">    Linux, but not on OS X.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">confvars</span> <span class="o">=</span> <span class="n">distutils</span><span class="o">.</span><span class="n">sysconfig</span><span class="o">.</span><span class="n">get_config_vars</span><span class="p">()</span>
    <span class="c1"># SO is deprecated in 3.3.1, use EXT_SUFFIX instead</span>
    <span class="n">so_ext</span> <span class="o">=</span> <span class="n">confvars</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;EXT_SUFFIX&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">so_ext</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">so_ext</span> <span class="o">=</span> <span class="n">confvars</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SO&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_python_ext</span><span class="p">:</span>
        <span class="c1"># hardcode known values, config vars (including SHLIB_SUFFIX) are</span>
        <span class="c1"># unreliable (see #3182)</span>
        <span class="c1"># darwin, windows and debug linux are wrong in 3.3.1 and older</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;linux&#39;</span><span class="p">)</span> <span class="ow">or</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;gnukfreebsd&#39;</span><span class="p">)):</span>
            <span class="n">so_ext</span> <span class="o">=</span> <span class="s1">&#39;.so&#39;</span>
        <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;darwin&#39;</span><span class="p">):</span>
            <span class="n">so_ext</span> <span class="o">=</span> <span class="s1">&#39;.dylib&#39;</span>
        <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;win&#39;</span><span class="p">):</span>
            <span class="n">so_ext</span> <span class="o">=</span> <span class="s1">&#39;.dll&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># fall back to config vars for unknown platforms</span>
            <span class="c1"># fix long extension for Python &gt;=3.2, see PEP 3149.</span>
            <span class="k">if</span> <span class="s1">&#39;SOABI&#39;</span> <span class="ow">in</span> <span class="n">confvars</span><span class="p">:</span>
                <span class="c1"># Does nothing unless SOABI config var exists</span>
                <span class="n">so_ext</span> <span class="o">=</span> <span class="n">so_ext</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">confvars</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SOABI&#39;</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">so_ext</span>

<span class="k">def</span> <span class="nf">get_data_files</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span>
    <span class="n">sources</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">is_local_src_dir</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="n">filenames</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">general_source_files</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">is_string</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
                <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Not existing data file:&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">filenames</span>

<div class="viewcode-block" id="dot_join"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.dot_join.html#numpy.distutils.misc_util.dot_join">[docs]</a><span class="k">def</span> <span class="nf">dot_join</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">a</span><span class="p">])</span></div>

<span class="k">def</span> <span class="nf">get_frame</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return frame object from call stack with given level.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">(</span><span class="n">level</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tb_frame</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">level</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_back</span>
        <span class="k">return</span> <span class="n">frame</span>


<span class="c1">######################</span>

<div class="viewcode-block" id="Configuration"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration">[docs]</a><span class="k">class</span> <span class="nc">Configuration</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="n">_list_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;packages&#39;</span><span class="p">,</span> <span class="s1">&#39;ext_modules&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files&#39;</span><span class="p">,</span> <span class="s1">&#39;include_dirs&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;libraries&#39;</span><span class="p">,</span> <span class="s1">&#39;headers&#39;</span><span class="p">,</span> <span class="s1">&#39;scripts&#39;</span><span class="p">,</span> <span class="s1">&#39;py_modules&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;installed_libraries&#39;</span><span class="p">,</span> <span class="s1">&#39;define_macros&#39;</span><span class="p">]</span>
    <span class="n">_dict_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;package_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;installed_pkg_config&#39;</span><span class="p">]</span>
    <span class="n">_extra_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;version&#39;</span><span class="p">]</span>

    <span class="n">numpy_include_dirs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">package_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">parent_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">top_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">package_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">caller_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">setup_name</span><span class="o">=</span><span class="s1">&#39;setup.py&#39;</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">attrs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct configuration instance of a package.</span>

<span class="sd">        package_name -- name of the package</span>
<span class="sd">                        Ex.: &#39;distutils&#39;</span>
<span class="sd">        parent_name  -- name of the parent package</span>
<span class="sd">                        Ex.: &#39;numpy&#39;</span>
<span class="sd">        top_path     -- directory of the toplevel package</span>
<span class="sd">                        Ex.: the directory where the numpy package source sits</span>
<span class="sd">        package_path -- directory of package. Will be computed by magic from the</span>
<span class="sd">                        directory of the caller module if not specified</span>
<span class="sd">                        Ex.: the directory where numpy.distutils is</span>
<span class="sd">        caller_level -- frame level to caller namespace, internal parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">dot_join</span><span class="p">(</span><span class="n">parent_name</span><span class="p">,</span> <span class="n">package_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="n">caller_frame</span> <span class="o">=</span> <span class="n">get_frame</span><span class="p">(</span><span class="n">caller_level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_path</span> <span class="o">=</span> <span class="n">get_path_from_frame</span><span class="p">(</span><span class="n">caller_frame</span><span class="p">,</span> <span class="n">top_path</span><span class="p">)</span>
        <span class="c1"># local_path -- directory of a file (usually setup.py) that</span>
        <span class="c1">#               defines a configuration() function.</span>
        <span class="c1"># local_path -- directory of a file (usually setup.py) that</span>
        <span class="c1">#               defines a configuration() function.</span>
        <span class="k">if</span> <span class="n">top_path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">top_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_path</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">local_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">package_path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">package_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_path</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">njoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">,</span> <span class="n">package_path</span><span class="p">)):</span>
            <span class="n">package_path</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">,</span> <span class="n">package_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">package_path</span> <span class="ow">or</span> <span class="s1">&#39;.&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%r</span><span class="s2"> is not a directory&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">package_path</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top_path</span> <span class="o">=</span> <span class="n">top_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">package_path</span> <span class="o">=</span> <span class="n">package_path</span>
        <span class="c1"># this is the relative path in the installed package</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path_in_package</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">list_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_keys</span><span class="p">[:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_keys</span><span class="p">[:]</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_keys</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">[]))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">as_list</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_keys</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">{}))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

        <span class="n">known_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_keys</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extra_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extra_keys</span><span class="p">[:]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">known_keys</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">list_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dict_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">extra_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">njoin</span><span class="p">(</span><span class="n">package_path</span><span class="p">,</span> <span class="s1">&#39;__init__.py&#39;</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">package_dir</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">package_path</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">ignore_setup_xxx_py</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
            <span class="n">assume_default_configuration</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
            <span class="n">delegate_options_to_subpackages</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
            <span class="n">quiet</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">caller_instance</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">get_frame</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">caller_instance</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;self&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">f_globals</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">f_locals</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">caller_instance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">caller_instance</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;delegate_options_to_subpackages&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="o">**</span><span class="n">caller_instance</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setup_name</span> <span class="o">=</span> <span class="n">setup_name</span>

<div class="viewcode-block" id="Configuration.todict"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.todict">[docs]</a>    <span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a dictionary compatible with the keyword arguments of distutils</span>
<span class="sd">        setup function.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; setup(**config.todict())                           #doctest: +SKIP</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_optimize_data_files</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">known_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_keys</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_keys</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_keys</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">known_keys</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">a</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
        <span class="k">return</span> <span class="n">d</span></div>

    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;quiet&#39;</span><span class="p">]:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">warn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Warning: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">message</span><span class="p">,))</span>

    <span class="k">def</span> <span class="nf">set_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configure Configuration instance.</span>

<span class="sd">        The following options are available:</span>
<span class="sd">         - ignore_setup_xxx_py</span>
<span class="sd">         - assume_default_configuration</span>
<span class="sd">         - delegate_options_to_subpackages</span>
<span class="sd">         - quiet</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown option: &#39;</span><span class="o">+</span><span class="n">key</span><span class="p">)</span>

<div class="viewcode-block" id="Configuration.get_distribution"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.get_distribution">[docs]</a>    <span class="k">def</span> <span class="nf">get_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the distutils distribution object for self.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">numpy.distutils.core</span> <span class="kn">import</span> <span class="n">get_distribution</span>
        <span class="k">return</span> <span class="n">get_distribution</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_wildcard_get_subpackage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subpackage_name</span><span class="p">,</span>
                                 <span class="n">parent_name</span><span class="p">,</span>
                                 <span class="n">caller_level</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">subpackage_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">subpackage_path</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">]</span><span class="o">+</span><span class="n">l</span><span class="p">)</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">_m</span> <span class="k">for</span> <span class="n">_m</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">subpackage_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">_m</span><span class="p">)]</span>
        <span class="n">config_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">njoin</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;__init__.py&#39;</span><span class="p">)):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="s1">&#39;build&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">n</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">):])</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subpackage</span><span class="p">(</span><span class="n">n</span><span class="p">,</span>
                                    <span class="n">parent_name</span> <span class="o">=</span> <span class="n">parent_name</span><span class="p">,</span>
                                    <span class="n">caller_level</span> <span class="o">=</span> <span class="n">caller_level</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">config_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">config_list</span>

    <span class="k">def</span> <span class="nf">_get_configuration_from_setup_py</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setup_py</span><span class="p">,</span>
                                         <span class="n">subpackage_name</span><span class="p">,</span>
                                         <span class="n">subpackage_path</span><span class="p">,</span>
                                         <span class="n">parent_name</span><span class="p">,</span>
                                         <span class="n">caller_level</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># In case setup_py imports local modules:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">setup_py</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fo_setup_py</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">setup_py</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">)</span>
            <span class="n">setup_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">setup_py</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">dot_join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">subpackage_name</span><span class="p">,</span> <span class="n">setup_name</span><span class="p">)</span>
            <span class="n">setup_module</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">load_module</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)),</span>
                                           <span class="n">fo_setup_py</span><span class="p">,</span>
                                           <span class="n">setup_py</span><span class="p">,</span>
                                           <span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">fo_setup_py</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">setup_module</span><span class="p">,</span> <span class="s1">&#39;configuration&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;assume_default_configuration&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Assuming default configuration &#39;</span>\
                              <span class="s1">&#39;(</span><span class="si">%s</span><span class="s1"> does not define configuration())&#39;</span>\
                              <span class="o">%</span> <span class="p">(</span><span class="n">setup_module</span><span class="p">))</span>
                <span class="n">config</span> <span class="o">=</span> <span class="n">Configuration</span><span class="p">(</span><span class="n">subpackage_name</span><span class="p">,</span> <span class="n">parent_name</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">top_path</span><span class="p">,</span> <span class="n">subpackage_path</span><span class="p">,</span>
                                       <span class="n">caller_level</span> <span class="o">=</span> <span class="n">caller_level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pn</span> <span class="o">=</span> <span class="n">dot_join</span><span class="p">(</span><span class="o">*</span><span class="p">([</span><span class="n">parent_name</span><span class="p">]</span> <span class="o">+</span> <span class="n">subpackage_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">pn</span><span class="p">,)</span>
                <span class="k">def</span> <span class="nf">fix_args_py2</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">setup_module</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">__code__</span><span class="o">.</span><span class="n">co_argcount</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">args</span> <span class="o">=</span> <span class="n">args</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top_path</span><span class="p">,)</span>
                    <span class="k">return</span> <span class="n">args</span>
                <span class="k">def</span> <span class="nf">fix_args_py3</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">setup_module</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">__code__</span><span class="o">.</span><span class="n">co_argcount</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">args</span> <span class="o">=</span> <span class="n">args</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top_path</span><span class="p">,)</span>
                    <span class="k">return</span> <span class="n">args</span>
                <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="n">fix_args_py2</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="n">fix_args_py3</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
                <span class="n">config</span> <span class="o">=</span> <span class="n">setup_module</span><span class="o">.</span><span class="n">configuration</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">name</span><span class="o">!=</span><span class="n">dot_join</span><span class="p">(</span><span class="n">parent_name</span><span class="p">,</span> <span class="n">subpackage_name</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Subpackage </span><span class="si">%r</span><span class="s1"> configuration returned as </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> \
                          <span class="p">(</span><span class="n">dot_join</span><span class="p">(</span><span class="n">parent_name</span><span class="p">,</span> <span class="n">subpackage_name</span><span class="p">),</span> <span class="n">config</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">config</span>

<div class="viewcode-block" id="Configuration.get_subpackage"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.get_subpackage">[docs]</a>    <span class="k">def</span> <span class="nf">get_subpackage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">subpackage_name</span><span class="p">,</span>
                       <span class="n">subpackage_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">parent_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">caller_level</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return list of subpackage configurations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        subpackage_name : str or None</span>
<span class="sd">            Name of the subpackage to get the configuration. &#39;*&#39; in</span>
<span class="sd">            subpackage_name is handled as a wildcard.</span>
<span class="sd">        subpackage_path : str</span>
<span class="sd">            If None, then the path is assumed to be the local path plus the</span>
<span class="sd">            subpackage_name. If a setup.py file is not found in the</span>
<span class="sd">            subpackage_path, then a default configuration is used.</span>
<span class="sd">        parent_name : str</span>
<span class="sd">            Parent name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">subpackage_name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">subpackage_path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;either subpackage_name or subpackage_path must be specified&quot;</span><span class="p">)</span>
            <span class="n">subpackage_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">subpackage_path</span><span class="p">)</span>

        <span class="c1"># handle wildcards</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">subpackage_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subpackage_path</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">subpackage_name</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wildcard_get_subpackage</span><span class="p">(</span><span class="n">subpackage_name</span><span class="p">,</span>
                                                 <span class="n">parent_name</span><span class="p">,</span>
                                                 <span class="n">caller_level</span> <span class="o">=</span> <span class="n">caller_level</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">assert</span> <span class="s1">&#39;*&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">subpackage_name</span><span class="p">,</span> <span class="nb">repr</span><span class="p">((</span><span class="n">subpackage_name</span><span class="p">,</span> <span class="n">subpackage_path</span><span class="p">,</span> <span class="n">parent_name</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">subpackage_path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">subpackage_path</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">]</span> <span class="o">+</span> <span class="n">l</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subpackage_path</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">([</span><span class="n">subpackage_path</span><span class="p">]</span> <span class="o">+</span> <span class="n">l</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">subpackage_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="p">([</span><span class="n">subpackage_path</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">setup_py</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">(</span><span class="n">subpackage_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;ignore_setup_xxx_py&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">setup_py</span><span class="p">):</span>
                <span class="n">setup_py</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">(</span><span class="n">subpackage_path</span><span class="p">,</span>
                                 <span class="s1">&#39;setup_</span><span class="si">%s</span><span class="s1">.py&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">subpackage_name</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">setup_py</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;assume_default_configuration&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Assuming default configuration &#39;</span>\
                          <span class="s1">&#39;(</span><span class="si">%s</span><span class="s1">/{setup_</span><span class="si">%s</span><span class="s1">,setup}.py was not found)&#39;</span> \
                          <span class="o">%</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">setup_py</span><span class="p">),</span> <span class="n">subpackage_name</span><span class="p">))</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">Configuration</span><span class="p">(</span><span class="n">subpackage_name</span><span class="p">,</span> <span class="n">parent_name</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">top_path</span><span class="p">,</span> <span class="n">subpackage_path</span><span class="p">,</span>
                                   <span class="n">caller_level</span> <span class="o">=</span> <span class="n">caller_level</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_configuration_from_setup_py</span><span class="p">(</span>
                <span class="n">setup_py</span><span class="p">,</span>
                <span class="n">subpackage_name</span><span class="p">,</span>
                <span class="n">subpackage_path</span><span class="p">,</span>
                <span class="n">parent_name</span><span class="p">,</span>
                <span class="n">caller_level</span> <span class="o">=</span> <span class="n">caller_level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">config</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="Configuration.add_subpackage"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.add_subpackage">[docs]</a>    <span class="k">def</span> <span class="nf">add_subpackage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">subpackage_name</span><span class="p">,</span>
                       <span class="n">subpackage_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">standalone</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a sub-package to the current Configuration instance.</span>

<span class="sd">        This is useful in a setup.py script for adding sub-packages to a</span>
<span class="sd">        package.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        subpackage_name : str</span>
<span class="sd">            name of the subpackage</span>
<span class="sd">        subpackage_path : str</span>
<span class="sd">            if given, the subpackage path such as the subpackage is in</span>
<span class="sd">            subpackage_path / subpackage_name. If None,the subpackage is</span>
<span class="sd">            assumed to be located in the local path / subpackage_name.</span>
<span class="sd">        standalone : bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">standalone</span><span class="p">:</span>
            <span class="n">parent_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parent_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">config_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subpackage</span><span class="p">(</span><span class="n">subpackage_name</span><span class="p">,</span> <span class="n">subpackage_path</span><span class="p">,</span>
                                          <span class="n">parent_name</span> <span class="o">=</span> <span class="n">parent_name</span><span class="p">,</span>
                                          <span class="n">caller_level</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">config_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;No configuration returned, assuming unavailable.&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">config_list</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">config</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">Configuration</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">todict</span><span class="p">()</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Appending </span><span class="si">%s</span><span class="s1"> configuration to </span><span class="si">%s</span><span class="s1">&#39;</span> \
                      <span class="o">%</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dict_append</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">)</span>

        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;distutils distribution has been initialized,&#39;</span>\
                      <span class="s1">&#39; it may be too late to add a subpackage &#39;</span><span class="o">+</span> <span class="n">subpackage_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Configuration.add_data_dir"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.add_data_dir">[docs]</a>    <span class="k">def</span> <span class="nf">add_data_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Recursively add files under data_path to data_files list.</span>

<span class="sd">        Recursively add files under data_path to the list of data_files to be</span>
<span class="sd">        installed (and distributed). The data_path can be either a relative</span>
<span class="sd">        path-name, or an absolute path-name, or a 2-tuple where the first</span>
<span class="sd">        argument shows where in the install directory the data directory</span>
<span class="sd">        should be installed to.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data_path : seq or str</span>
<span class="sd">            Argument can be either</span>

<span class="sd">                * 2-sequence (&lt;datadir suffix&gt;, &lt;path to data directory&gt;)</span>
<span class="sd">                * path to data directory where python datadir suffix defaults</span>
<span class="sd">                  to package dir.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Rules for installation paths:</span>
<span class="sd">          foo/bar -&gt; (foo/bar, foo/bar) -&gt; parent/foo/bar</span>
<span class="sd">          (gun, foo/bar) -&gt; parent/gun</span>
<span class="sd">          foo/* -&gt; (foo/a, foo/a), (foo/b, foo/b) -&gt; parent/foo/a, parent/foo/b</span>
<span class="sd">          (gun, foo/*) -&gt; (gun, foo/a), (gun, foo/b) -&gt; gun</span>
<span class="sd">          (gun/*, foo/*) -&gt; parent/gun/a, parent/gun/b</span>
<span class="sd">          /foo/bar -&gt; (bar, /foo/bar) -&gt; parent/bar</span>
<span class="sd">          (gun, /foo/bar) -&gt; parent/gun</span>
<span class="sd">          (fun/*/gun/*, sun/foo/bar) -&gt; parent/fun/foo/gun/bar</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For example suppose the source directory contains fun/foo.dat and</span>
<span class="sd">        fun/bar/car.dat::</span>

<span class="sd">            &gt;&gt;&gt; self.add_data_dir(&#39;fun&#39;)                       #doctest: +SKIP</span>
<span class="sd">            &gt;&gt;&gt; self.add_data_dir((&#39;sun&#39;, &#39;fun&#39;))              #doctest: +SKIP</span>
<span class="sd">            &gt;&gt;&gt; self.add_data_dir((&#39;gun&#39;, &#39;/full/path/to/fun&#39;))#doctest: +SKIP</span>

<span class="sd">        Will install data-files to the locations::</span>

<span class="sd">            &lt;package install directory&gt;/</span>
<span class="sd">              fun/</span>
<span class="sd">                foo.dat</span>
<span class="sd">                bar/</span>
<span class="sd">                  car.dat</span>
<span class="sd">              sun/</span>
<span class="sd">                foo.dat</span>
<span class="sd">                bar/</span>
<span class="sd">                  car.dat</span>
<span class="sd">              gun/</span>
<span class="sd">                foo.dat</span>
<span class="sd">                car.dat</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">data_path</span><span class="p">):</span>
            <span class="n">d</span><span class="p">,</span> <span class="n">data_path</span> <span class="o">=</span> <span class="n">data_path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">data_path</span><span class="p">):</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">add_data_dir</span><span class="p">((</span><span class="n">d</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">data_path</span><span class="p">]</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_string</span><span class="p">(</span><span class="n">data_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;not a string: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">data_path</span><span class="p">,))</span>
        <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">data_path</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_data_dir</span><span class="p">((</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">data_path</span><span class="p">),</span> <span class="n">data_path</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_data_dir</span><span class="p">((</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_path</span><span class="p">))</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">include_non_existing</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_glob_pattern</span><span class="p">(</span><span class="n">data_path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">is_glob_pattern</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
                <span class="n">pattern_list</span> <span class="o">=</span> <span class="n">allpath</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
                <span class="n">pattern_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="c1"># /a/*//b/ -&gt; /a/*/b</span>
                <span class="n">rl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pattern_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span> <span class="n">rl</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rl</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">pattern_list</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="k">del</span> <span class="n">pattern_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="c1">#</span>
                <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Not a directory, skipping&#39;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
                        <span class="k">continue</span>
                    <span class="n">rpath</span> <span class="o">=</span> <span class="n">rel_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">)</span>
                    <span class="n">path_list</span> <span class="o">=</span> <span class="n">rpath</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
                    <span class="n">path_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                    <span class="n">target_list</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">pattern_list</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">is_glob_pattern</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">i</span><span class="o">&gt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">path_list</span><span class="p">):</span>
                                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;cannot fill pattern </span><span class="si">%r</span><span class="s1"> with </span><span class="si">%r</span><span class="s1">&#39;</span> \
                                      <span class="o">%</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
                            <span class="n">target_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">assert</span> <span class="n">s</span><span class="o">==</span><span class="n">path_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">repr</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">path_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">data_path</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">rpath</span><span class="p">))</span>
                            <span class="n">target_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">path_list</span><span class="p">[</span><span class="n">i</span><span class="p">:]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;mismatch of pattern_list=</span><span class="si">%s</span><span class="s1"> and path_list=</span><span class="si">%s</span><span class="s1">&#39;</span>\
                                  <span class="o">%</span> <span class="p">(</span><span class="n">pattern_list</span><span class="p">,</span> <span class="n">path_list</span><span class="p">))</span>
                    <span class="n">target_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_data_dir</span><span class="p">((</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">target_list</span><span class="p">),</span> <span class="n">path</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_data_dir</span><span class="p">((</span><span class="n">d</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">is_glob_pattern</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">dist</span><span class="o">.</span><span class="n">data_files</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">data_files</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">data_files</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_files</span>

        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">d1</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">general_source_directories_files</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>
                <span class="n">target_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_in_package</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>
                <span class="n">data_files</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">target_path</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="nf">_optimize_data_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_files</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">p</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">:</span>
                <span class="n">data_dict</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="n">data_dict</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_files</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">files</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>

<div class="viewcode-block" id="Configuration.add_data_files"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.add_data_files">[docs]</a>    <span class="k">def</span> <span class="nf">add_data_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">files</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add data files to configuration data_files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        files : sequence</span>
<span class="sd">            Argument(s) can be either</span>

<span class="sd">                * 2-sequence (&lt;datadir prefix&gt;,&lt;path to data file(s)&gt;)</span>
<span class="sd">                * paths to data files where python datadir prefix defaults</span>
<span class="sd">                  to package dir.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The form of each element of the files sequence is very flexible</span>
<span class="sd">        allowing many combinations of where to get the files from the package</span>
<span class="sd">        and where they should ultimately be installed on the system. The most</span>
<span class="sd">        basic usage is for an element of the files argument sequence to be a</span>
<span class="sd">        simple filename. This will cause that file from the local path to be</span>
<span class="sd">        installed to the installation path of the self.name package (package</span>
<span class="sd">        path). The file argument can also be a relative path in which case the</span>
<span class="sd">        entire relative path will be installed into the package directory.</span>
<span class="sd">        Finally, the file can be an absolute path name in which case the file</span>
<span class="sd">        will be found at the absolute path name but installed to the package</span>
<span class="sd">        path.</span>

<span class="sd">        This basic behavior can be augmented by passing a 2-tuple in as the</span>
<span class="sd">        file argument. The first element of the tuple should specify the</span>
<span class="sd">        relative path (under the package install directory) where the</span>
<span class="sd">        remaining sequence of files should be installed to (it has nothing to</span>
<span class="sd">        do with the file-names in the source distribution). The second element</span>
<span class="sd">        of the tuple is the sequence of files that should be installed. The</span>
<span class="sd">        files in this sequence can be filenames, relative paths, or absolute</span>
<span class="sd">        paths. For absolute paths the file will be installed in the top-level</span>
<span class="sd">        package installation directory (regardless of the first argument).</span>
<span class="sd">        Filenames and relative path names will be installed in the package</span>
<span class="sd">        install directory under the path name given as the first element of</span>
<span class="sd">        the tuple.</span>

<span class="sd">        Rules for installation paths:</span>

<span class="sd">          #. file.txt -&gt; (., file.txt)-&gt; parent/file.txt</span>
<span class="sd">          #. foo/file.txt -&gt; (foo, foo/file.txt) -&gt; parent/foo/file.txt</span>
<span class="sd">          #. /foo/bar/file.txt -&gt; (., /foo/bar/file.txt) -&gt; parent/file.txt</span>
<span class="sd">          #. *.txt -&gt; parent/a.txt, parent/b.txt</span>
<span class="sd">          #. foo/*.txt -&gt; parent/foo/a.txt, parent/foo/b.txt</span>
<span class="sd">          #. */*.txt -&gt; (*, */*.txt) -&gt; parent/c/a.txt, parent/d/b.txt</span>
<span class="sd">          #. (sun, file.txt) -&gt; parent/sun/file.txt</span>
<span class="sd">          #. (sun, bar/file.txt) -&gt; parent/sun/file.txt</span>
<span class="sd">          #. (sun, /foo/bar/file.txt) -&gt; parent/sun/file.txt</span>
<span class="sd">          #. (sun, *.txt) -&gt; parent/sun/a.txt, parent/sun/b.txt</span>
<span class="sd">          #. (sun, bar/*.txt) -&gt; parent/sun/a.txt, parent/sun/b.txt</span>
<span class="sd">          #. (sun/*, */*.txt) -&gt; parent/sun/c/a.txt, parent/d/b.txt</span>

<span class="sd">        An additional feature is that the path to a data-file can actually be</span>
<span class="sd">        a function that takes no arguments and returns the actual path(s) to</span>
<span class="sd">        the data-files. This is useful when the data files are generated while</span>
<span class="sd">        building the package.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Add files to the list of data_files to be included with the package.</span>

<span class="sd">            &gt;&gt;&gt; self.add_data_files(&#39;foo.dat&#39;,</span>
<span class="sd">            ...     (&#39;fun&#39;, [&#39;gun.dat&#39;, &#39;nun/pun.dat&#39;, &#39;/tmp/sun.dat&#39;]),</span>
<span class="sd">            ...     &#39;bar/cat.dat&#39;,</span>
<span class="sd">            ...     &#39;/full/path/to/can.dat&#39;)                   #doctest: +SKIP</span>

<span class="sd">        will install these data files to::</span>

<span class="sd">            &lt;package install directory&gt;/</span>
<span class="sd">             foo.dat</span>
<span class="sd">             fun/</span>
<span class="sd">               gun.dat</span>
<span class="sd">               nun/</span>
<span class="sd">                 pun.dat</span>
<span class="sd">             sun.dat</span>
<span class="sd">             bar/</span>
<span class="sd">               car.dat</span>
<span class="sd">             can.dat</span>

<span class="sd">        where &lt;package install directory&gt; is the package (or sub-package)</span>
<span class="sd">        directory such as &#39;/usr/lib/python2.4/site-packages/mypackage&#39; (&#39;C:</span>
<span class="sd">        \\Python2.4 \\Lib \\site-packages \\mypackage&#39;) or</span>
<span class="sd">        &#39;/usr/lib/python2.4/site- packages/mypackage/mysubpackage&#39; (&#39;C:</span>
<span class="sd">        \\Python2.4 \\Lib \\site-packages \\mypackage \\mysubpackage&#39;).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_data_files</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">d</span><span class="p">,</span> <span class="n">files</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">files</span><span class="p">):</span>
            <span class="n">filepat</span> <span class="o">=</span> <span class="n">files</span>
        <span class="k">elif</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">files</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">filepat</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_data_files</span><span class="p">((</span><span class="n">d</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
                <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">files</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">filepat</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">filepat</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filepat</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_data_files</span><span class="p">((</span><span class="n">d</span><span class="p">,</span> <span class="n">files</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="p">(</span><span class="n">filepat</span><span class="p">,</span> <span class="n">include_non_existing</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_glob_pattern</span><span class="p">(</span><span class="n">filepat</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">is_glob_pattern</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
                <span class="n">pattern_list</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
                <span class="n">pattern_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
                    <span class="n">path_list</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
                    <span class="n">path_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                    <span class="n">path_list</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="c1"># filename</span>
                    <span class="n">target_list</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">pattern_list</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">is_glob_pattern</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
                            <span class="n">target_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">target_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                    <span class="n">target_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_data_files</span><span class="p">((</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">target_list</span><span class="p">),</span> <span class="n">path</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_data_files</span><span class="p">((</span><span class="n">d</span><span class="p">,</span> <span class="n">paths</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">is_glob_pattern</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="nb">repr</span><span class="p">((</span><span class="n">d</span><span class="p">,</span> <span class="n">filepat</span><span class="p">))</span>

        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">dist</span><span class="o">.</span><span class="n">data_files</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">data_files</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">data_files</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_files</span>

        <span class="n">data_files</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_in_package</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="n">paths</span><span class="p">))</span></div>

    <span class="c1">### XXX Implement add_py_modules</span>

    <span class="k">def</span> <span class="nf">add_define_macros</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">macros</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add define macros to configuration</span>

<span class="sd">        Add the given sequence of macro name and value duples to the beginning</span>
<span class="sd">        of the define_macros list This list will be visible to all extension</span>
<span class="sd">        modules of the current package.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="s1">&#39;define_macros&#39;</span><span class="p">):</span>
                <span class="n">dist</span><span class="o">.</span><span class="n">define_macros</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">dist</span><span class="o">.</span><span class="n">define_macros</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">macros</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">define_macros</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">macros</span><span class="p">)</span>


<div class="viewcode-block" id="Configuration.add_include_dirs"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.add_include_dirs">[docs]</a>    <span class="k">def</span> <span class="nf">add_include_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">paths</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add paths to configuration include directories.</span>

<span class="sd">        Add the given sequence of paths to the beginning of the include_dirs</span>
<span class="sd">        list. This list will be visible to all extension modules of the</span>
<span class="sd">        current package.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">include_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dist</span><span class="o">.</span><span class="n">include_dirs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">dist</span><span class="o">.</span><span class="n">include_dirs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">dist</span><span class="o">.</span><span class="n">include_dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">include_dirs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">include_dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">include_dirs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Configuration.add_headers"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.add_headers">[docs]</a>    <span class="k">def</span> <span class="nf">add_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">files</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add installable headers to configuration.</span>

<span class="sd">        Add the given sequence of files to the beginning of the headers list.</span>
<span class="sd">        By default, headers will be installed under &lt;python-</span>
<span class="sd">        include&gt;/&lt;self.name.replace(&#39;.&#39;,&#39;/&#39;)&gt;/ directory. If an item of files</span>
<span class="sd">        is a tuple, then its first argument specifies the actual installation</span>
<span class="sd">        location relative to the &lt;python-include&gt; path.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        files : str or seq</span>
<span class="sd">            Argument(s) can be either:</span>

<span class="sd">                * 2-sequence (&lt;includedir suffix&gt;,&lt;path to header file(s)&gt;)</span>
<span class="sd">                * path(s) to header file(s) where python includedir suffix will</span>
<span class="sd">                  default to package name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                <span class="p">[</span><span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="p">(</span><span class="n">path</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
                <span class="p">[</span><span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dist</span><span class="o">.</span><span class="n">headers</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">dist</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">dist</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span></div>

<div class="viewcode-block" id="Configuration.paths"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.paths">[docs]</a>    <span class="k">def</span> <span class="nf">paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">paths</span><span class="p">,</span><span class="o">**</span><span class="n">kws</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply glob to paths and prepend local_path if needed.</span>

<span class="sd">        Applies glob.glob(...) to each path in the sequence (if needed) and</span>
<span class="sd">        pre-pends the local_path if needed. Because this is called on all</span>
<span class="sd">        source lists, this allows wildcard characters to be specified in lists</span>
<span class="sd">        of sources for extension modules and libraries and scripts and allows</span>
<span class="sd">        path-names be relative to the source directory.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">include_non_existing</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;include_non_existing&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gpaths</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span>
                      <span class="n">local_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">,</span>
                      <span class="n">include_non_existing</span><span class="o">=</span><span class="n">include_non_existing</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_fix_paths_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kw</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kw</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">,</span> <span class="s1">&#39;depends&#39;</span><span class="p">,</span> <span class="s1">&#39;include_dirs&#39;</span><span class="p">,</span> <span class="s1">&#39;library_dirs&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;module_dirs&#39;</span><span class="p">,</span> <span class="s1">&#39;extra_objects&#39;</span><span class="p">]:</span>
                <span class="n">new_v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">kw</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_v</span>

<div class="viewcode-block" id="Configuration.add_extension"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.add_extension">[docs]</a>    <span class="k">def</span> <span class="nf">add_extension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">sources</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add extension to configuration.</span>

<span class="sd">        Create and add an Extension instance to the ext_modules list. This</span>
<span class="sd">        method also takes the following optional keyword arguments that are</span>
<span class="sd">        passed on to the Extension constructor.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            name of the extension</span>
<span class="sd">        sources : seq</span>
<span class="sd">            list of the sources. The list of sources may contain functions</span>
<span class="sd">            (called source generators) which must take an extension instance</span>
<span class="sd">            and a build directory as inputs and return a source file or list of</span>
<span class="sd">            source files or None. If None is returned then no sources are</span>
<span class="sd">            generated. If the Extension instance has no sources after</span>
<span class="sd">            processing all source generators, then no extension module is</span>
<span class="sd">            built.</span>
<span class="sd">        include_dirs :</span>
<span class="sd">        define_macros :</span>
<span class="sd">        undef_macros :</span>
<span class="sd">        library_dirs :</span>
<span class="sd">        libraries :</span>
<span class="sd">        runtime_library_dirs :</span>
<span class="sd">        extra_objects :</span>
<span class="sd">        extra_compile_args :</span>
<span class="sd">        extra_link_args :</span>
<span class="sd">        extra_f77_compile_args :</span>
<span class="sd">        extra_f90_compile_args :</span>
<span class="sd">        export_symbols :</span>
<span class="sd">        swig_opts :</span>
<span class="sd">        depends :</span>
<span class="sd">            The depends list contains paths to files or directories that the</span>
<span class="sd">            sources of the extension module depend on. If any path in the</span>
<span class="sd">            depends list is newer than the extension module, then the module</span>
<span class="sd">            will be rebuilt.</span>
<span class="sd">        language :</span>
<span class="sd">        f2py_options :</span>
<span class="sd">        module_dirs :</span>
<span class="sd">        extra_info : dict or list</span>
<span class="sd">            dict or list of dict of keywords to be appended to keywords.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The self.paths(...) method is applied to all lists that may contain</span>
<span class="sd">        paths.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ext_args</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>
        <span class="n">ext_args</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dot_join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">ext_args</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sources</span>

        <span class="k">if</span> <span class="s1">&#39;extra_info&#39;</span> <span class="ow">in</span> <span class="n">ext_args</span><span class="p">:</span>
            <span class="n">extra_info</span> <span class="o">=</span> <span class="n">ext_args</span><span class="p">[</span><span class="s1">&#39;extra_info&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">ext_args</span><span class="p">[</span><span class="s1">&#39;extra_info&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extra_info</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">extra_info</span> <span class="o">=</span> <span class="p">[</span><span class="n">extra_info</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">extra_info</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
                <span class="n">dict_append</span><span class="p">(</span><span class="n">ext_args</span><span class="p">,</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fix_paths_dict</span><span class="p">(</span><span class="n">ext_args</span><span class="p">)</span>

        <span class="c1"># Resolve out-of-tree dependencies</span>
        <span class="n">libraries</span> <span class="o">=</span> <span class="n">ext_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;libraries&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">libnames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ext_args</span><span class="p">[</span><span class="s1">&#39;libraries&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">libname</span> <span class="ow">in</span> <span class="n">libraries</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">libname</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_fix_paths_dict</span><span class="p">(</span><span class="n">libname</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="c1"># Handle library names of the form libname@relative/path/to/library</span>
            <span class="k">if</span> <span class="s1">&#39;@&#39;</span> <span class="ow">in</span> <span class="n">libname</span><span class="p">:</span>
                <span class="n">lname</span><span class="p">,</span> <span class="n">lpath</span> <span class="o">=</span> <span class="n">libname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">lpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">njoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">,</span> <span class="n">lpath</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">lpath</span><span class="p">):</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subpackage</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">lpath</span><span class="p">,</span>
                                            <span class="n">caller_level</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Configuration</span><span class="p">):</span>
                        <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">todict</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;libraries&#39;</span><span class="p">,</span> <span class="p">[])]:</span>
                        <span class="n">llname</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;__OF__&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">llname</span> <span class="o">==</span> <span class="n">lname</span><span class="p">:</span>
                            <span class="n">c</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                            <span class="n">dict_append</span><span class="p">(</span><span class="n">ext_args</span><span class="p">,</span><span class="o">**</span><span class="n">c</span><span class="p">)</span>
                            <span class="k">break</span>
                    <span class="k">continue</span>
            <span class="n">libnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">libname</span><span class="p">)</span>

        <span class="n">ext_args</span><span class="p">[</span><span class="s1">&#39;libraries&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">libnames</span> <span class="o">+</span> <span class="n">ext_args</span><span class="p">[</span><span class="s1">&#39;libraries&#39;</span><span class="p">]</span>
        <span class="n">ext_args</span><span class="p">[</span><span class="s1">&#39;define_macros&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">define_macros</span> <span class="o">+</span> <span class="n">ext_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;define_macros&#39;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="kn">from</span> <span class="nn">numpy.distutils.core</span> <span class="kn">import</span> <span class="n">Extension</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">Extension</span><span class="p">(</span><span class="o">**</span><span class="n">ext_args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ext_modules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span>

        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;distutils distribution has been initialized,&#39;</span>\
                      <span class="s1">&#39; it may be too late to add an extension &#39;</span><span class="o">+</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ext</span></div>

<div class="viewcode-block" id="Configuration.add_library"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.add_library">[docs]</a>    <span class="k">def</span> <span class="nf">add_library</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">sources</span><span class="p">,</span><span class="o">**</span><span class="n">build_info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add library to configuration.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Name of the extension.</span>
<span class="sd">        sources : sequence</span>
<span class="sd">            List of the sources. The list of sources may contain functions</span>
<span class="sd">            (called source generators) which must take an extension instance</span>
<span class="sd">            and a build directory as inputs and return a source file or list of</span>
<span class="sd">            source files or None. If None is returned then no sources are</span>
<span class="sd">            generated. If the Extension instance has no sources after</span>
<span class="sd">            processing all source generators, then no extension module is</span>
<span class="sd">            built.</span>
<span class="sd">        build_info : dict, optional</span>
<span class="sd">            The following keys are allowed:</span>

<span class="sd">                * depends</span>
<span class="sd">                * macros</span>
<span class="sd">                * include_dirs</span>
<span class="sd">                * extra_compiler_args</span>
<span class="sd">                * extra_f77_compiler_args</span>
<span class="sd">                * extra_f90_compiler_args</span>
<span class="sd">                * f2py_options</span>
<span class="sd">                * language</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_library</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">build_info</span><span class="p">)</span>

        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;distutils distribution has been initialized,&#39;</span>\
                      <span class="s1">&#39; it may be too late to add a library &#39;</span><span class="o">+</span> <span class="n">name</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_add_library</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">install_dir</span><span class="p">,</span> <span class="n">build_info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Common implementation for add_library and add_installed_library. Do</span>
<span class="sd">        not use directly&quot;&quot;&quot;</span>
        <span class="n">build_info</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">build_info</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="c1">#+ &#39;__OF__&#39; + self.name</span>
        <span class="n">build_info</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sources</span>

        <span class="c1"># Sometimes, depends is not set up to an empty list by default, and if</span>
        <span class="c1"># depends is not given to add_library, distutils barfs (#1134)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;depends&#39;</span> <span class="ow">in</span> <span class="n">build_info</span><span class="p">:</span>
            <span class="n">build_info</span><span class="p">[</span><span class="s1">&#39;depends&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fix_paths_dict</span><span class="p">(</span><span class="n">build_info</span><span class="p">)</span>

        <span class="c1"># Add to libraries list so that it is build with build_clib</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">libraries</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">build_info</span><span class="p">))</span>

<div class="viewcode-block" id="Configuration.add_installed_library"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.add_installed_library">[docs]</a>    <span class="k">def</span> <span class="nf">add_installed_library</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">install_dir</span><span class="p">,</span> <span class="n">build_info</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Similar to add_library, but the specified library is installed.</span>

<span class="sd">        Most C libraries used with `distutils` are only used to build python</span>
<span class="sd">        extensions, but libraries built through this method will be installed</span>
<span class="sd">        so that they can be reused by third-party packages.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Name of the installed library.</span>
<span class="sd">        sources : sequence</span>
<span class="sd">            List of the library&#39;s source files. See `add_library` for details.</span>
<span class="sd">        install_dir : str</span>
<span class="sd">            Path to install the library, relative to the current sub-package.</span>
<span class="sd">        build_info : dict, optional</span>
<span class="sd">            The following keys are allowed:</span>

<span class="sd">                * depends</span>
<span class="sd">                * macros</span>
<span class="sd">                * include_dirs</span>
<span class="sd">                * extra_compiler_args</span>
<span class="sd">                * extra_f77_compiler_args</span>
<span class="sd">                * extra_f90_compiler_args</span>
<span class="sd">                * f2py_options</span>
<span class="sd">                * language</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        add_library, add_npy_pkg_config, get_info</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The best way to encode the options required to link against the specified</span>
<span class="sd">        C libraries is to use a &quot;libname.ini&quot; file, and use `get_info` to</span>
<span class="sd">        retrieve the required options (see `add_npy_pkg_config` for more</span>
<span class="sd">        information).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">build_info</span><span class="p">:</span>
            <span class="n">build_info</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">install_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">package_path</span><span class="p">,</span> <span class="n">install_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_library</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">install_dir</span><span class="p">,</span> <span class="n">build_info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">installed_libraries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InstallableLib</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">build_info</span><span class="p">,</span> <span class="n">install_dir</span><span class="p">))</span></div>

<div class="viewcode-block" id="Configuration.add_npy_pkg_config"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.add_npy_pkg_config">[docs]</a>    <span class="k">def</span> <span class="nf">add_npy_pkg_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">install_dir</span><span class="p">,</span> <span class="n">subst_dict</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate and install a npy-pkg config file from a template.</span>

<span class="sd">        The config file generated from `template` is installed in the</span>
<span class="sd">        given install directory, using `subst_dict` for variable substitution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        template : str</span>
<span class="sd">            The path of the template, relatively to the current package path.</span>
<span class="sd">        install_dir : str</span>
<span class="sd">            Where to install the npy-pkg config file, relatively to the current</span>
<span class="sd">            package path.</span>
<span class="sd">        subst_dict : dict, optional</span>
<span class="sd">            If given, any string of the form ``@key@`` will be replaced by</span>
<span class="sd">            ``subst_dict[key]`` in the template file when installed. The install</span>
<span class="sd">            prefix is always available through the variable ``@prefix@``, since the</span>
<span class="sd">            install prefix is not easy to get reliably from setup.py.</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        add_installed_library, get_info</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This works for both standard installs and in-place builds, i.e. the</span>
<span class="sd">        ``@prefix@`` refer to the source directory for in-place builds.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ::</span>

<span class="sd">            config.add_npy_pkg_config(&#39;foo.ini.in&#39;, &#39;lib&#39;, {&#39;foo&#39;: bar})</span>

<span class="sd">        Assuming the foo.ini.in file has the following content::</span>

<span class="sd">            [meta]</span>
<span class="sd">            Name=@foo@</span>
<span class="sd">            Version=1.0</span>
<span class="sd">            Description=dummy description</span>

<span class="sd">            [default]</span>
<span class="sd">            Cflags=-I@prefix@/include</span>
<span class="sd">            Libs=</span>

<span class="sd">        The generated file will have the following content::</span>

<span class="sd">            [meta]</span>
<span class="sd">            Name=bar</span>
<span class="sd">            Version=1.0</span>
<span class="sd">            Description=dummy description</span>

<span class="sd">            [default]</span>
<span class="sd">            Cflags=-Iprefix_dir/include</span>
<span class="sd">            Libs=</span>

<span class="sd">        and will be installed as foo.ini in the &#39;lib&#39; subpath.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">subst_dict</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">subst_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">template</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">template</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">package_path</span><span class="p">,</span> <span class="n">template</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">installed_pkg_config</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">installed_pkg_config</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">template</span><span class="p">,</span> <span class="n">install_dir</span><span class="p">,</span>
                <span class="n">subst_dict</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">installed_pkg_config</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">template</span><span class="p">,</span> <span class="n">install_dir</span><span class="p">,</span>
                <span class="n">subst_dict</span><span class="p">)]</span></div>


<div class="viewcode-block" id="Configuration.add_scripts"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.add_scripts">[docs]</a>    <span class="k">def</span> <span class="nf">add_scripts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">files</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add scripts to configuration.</span>

<span class="sd">        Add the sequence of files to the beginning of the scripts list.</span>
<span class="sd">        Scripts will be installed under the &lt;prefix&gt;/bin/ directory.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scripts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dist</span><span class="o">.</span><span class="n">scripts</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">dist</span><span class="o">.</span><span class="n">scripts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">dist</span><span class="o">.</span><span class="n">scripts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">scripts</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scripts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">scripts</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">dict_append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="nb">dict</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_keys</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[]))</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_keys</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">{}))</span>
        <span class="n">known_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_keys</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_keys</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_keys</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">known_keys</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">a</span><span class="o">==</span><span class="nb">dict</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span> <span class="k">continue</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Inheriting attribute </span><span class="si">%r</span><span class="s1">=</span><span class="si">%r</span><span class="s1"> from </span><span class="si">%r</span><span class="s1">&#39;</span> \
                          <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="nb">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">)))</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">extra_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_keys</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Ignoring attempt to set </span><span class="si">%r</span><span class="s1"> (from </span><span class="si">%r</span><span class="s1"> to </span><span class="si">%r</span><span class="s1">)&#39;</span> \
                          <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">),</span> <span class="nb">dict</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">known_keys</span><span class="p">:</span>
                <span class="c1"># key is already processed above</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Don&#39;t know about key=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pformat</span>
        <span class="n">known_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_keys</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_keys</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_keys</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&lt;&#39;</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;Configuration of &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">known_keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">known_keys</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">a</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> = </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">pformat</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="mi">5</span><span class="o">*</span><span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span>
        <span class="k">return</span> <span class="n">s</span>

<div class="viewcode-block" id="Configuration.get_config_cmd"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.get_config_cmd">[docs]</a>    <span class="k">def</span> <span class="nf">get_config_cmd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the numpy.distutils config command instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">get_cmd</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">)</span>
        <span class="n">cmd</span><span class="o">.</span><span class="n">ensure_finalized</span><span class="p">()</span>
        <span class="n">cmd</span><span class="o">.</span><span class="n">dump_source</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cmd</span><span class="o">.</span><span class="n">noisy</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">old_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PATH&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">old_path</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">old_path</span><span class="p">])</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="k">return</span> <span class="n">cmd</span></div>

<div class="viewcode-block" id="Configuration.get_build_temp_dir"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.get_build_temp_dir">[docs]</a>    <span class="k">def</span> <span class="nf">get_build_temp_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a path to a temporary directory where temporary files should be</span>
<span class="sd">        placed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">get_cmd</span><span class="p">(</span><span class="s1">&#39;build&#39;</span><span class="p">)</span>
        <span class="n">cmd</span><span class="o">.</span><span class="n">ensure_finalized</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">cmd</span><span class="o">.</span><span class="n">build_temp</span></div>

<div class="viewcode-block" id="Configuration.have_f77c"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.have_f77c">[docs]</a>    <span class="k">def</span> <span class="nf">have_f77c</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check for availability of Fortran 77 compiler.</span>

<span class="sd">        Use it inside source generating function to ensure that</span>
<span class="sd">        setup distribution instance has been initialized.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        True if a Fortran 77 compiler is available (because a simple Fortran 77</span>
<span class="sd">        code was able to be compiled successfully).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">simple_fortran_subroutine</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        subroutine simple</span>
<span class="s1">        end</span>
<span class="s1">        &#39;&#39;&#39;</span>
        <span class="n">config_cmd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_cmd</span><span class="p">()</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">config_cmd</span><span class="o">.</span><span class="n">try_compile</span><span class="p">(</span><span class="n">simple_fortran_subroutine</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s1">&#39;f77&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">flag</span></div>

<div class="viewcode-block" id="Configuration.have_f90c"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.have_f90c">[docs]</a>    <span class="k">def</span> <span class="nf">have_f90c</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check for availability of Fortran 90 compiler.</span>

<span class="sd">        Use it inside source generating function to ensure that</span>
<span class="sd">        setup distribution instance has been initialized.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        True if a Fortran 90 compiler is available (because a simple Fortran</span>
<span class="sd">        90 code was able to be compiled successfully)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">simple_fortran_subroutine</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        subroutine simple</span>
<span class="s1">        end</span>
<span class="s1">        &#39;&#39;&#39;</span>
        <span class="n">config_cmd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config_cmd</span><span class="p">()</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">config_cmd</span><span class="o">.</span><span class="n">try_compile</span><span class="p">(</span><span class="n">simple_fortran_subroutine</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s1">&#39;f90&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">flag</span></div>

    <span class="k">def</span> <span class="nf">append_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extlib</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append libraries, include_dirs to extension or library item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">extlib</span><span class="p">):</span>
            <span class="n">lib_name</span><span class="p">,</span> <span class="n">build_info</span> <span class="o">=</span> <span class="n">extlib</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">build_info</span><span class="p">,</span>
                        <span class="n">libraries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">libraries</span><span class="p">,</span>
                        <span class="n">include_dirs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">include_dirs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">numpy.distutils.core</span> <span class="kn">import</span> <span class="n">Extension</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extlib</span><span class="p">,</span> <span class="n">Extension</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">extlib</span><span class="p">)</span>
            <span class="n">extlib</span><span class="o">.</span><span class="n">libraries</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libraries</span><span class="p">)</span>
            <span class="n">extlib</span><span class="o">.</span><span class="n">include_dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">include_dirs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_svn_revision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return path&#39;s SVN revision number.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">revision</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">cwd</span> <span class="o">=</span>  <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span> <span class="ow">or</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;svnversion&#39;</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">close_fds</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">sout</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stdout</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">r&#39;(?P&lt;revision&gt;\d+)&#39;</span><span class="p">,</span> <span class="n">sout</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
            <span class="n">revision</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;revision&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">revision</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">==</span><span class="s1">&#39;win32&#39;</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SVN_ASP_DOT_NET_HACK&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
            <span class="n">entries</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;_svn&#39;</span><span class="p">,</span> <span class="s1">&#39;entries&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">entries</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;.svn&#39;</span><span class="p">,</span> <span class="s1">&#39;entries&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
            <span class="n">fstr</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">fstr</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&lt;?xml&#39;</span><span class="p">:</span>  <span class="c1"># pre 1.4</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">r&#39;revision=&quot;(?P&lt;revision&gt;\d+)&quot;&#39;</span><span class="p">,</span> <span class="n">fstr</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                    <span class="n">revision</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;revision&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># non-xml entries file --- check to be sure that</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">r&#39;dir[\n\r]+(?P&lt;revision&gt;\d+)&#39;</span><span class="p">,</span> <span class="n">fstr</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                    <span class="n">revision</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;revision&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">revision</span>

    <span class="k">def</span> <span class="nf">_get_hg_revision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return path&#39;s Mercurial revision number.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">revision</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">cwd</span> <span class="o">=</span>  <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span> <span class="ow">or</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;hg identify --num&#39;</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">close_fds</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">sout</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stdout</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">r&#39;(?P&lt;revision&gt;\d+)&#39;</span><span class="p">,</span> <span class="n">sout</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
            <span class="n">revision</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;revision&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">revision</span>
        <span class="n">branch_fn</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;.hg&#39;</span><span class="p">,</span> <span class="s1">&#39;branch&#39;</span><span class="p">)</span>
        <span class="n">branch_cache_fn</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;.hg&#39;</span><span class="p">,</span> <span class="s1">&#39;branch.cache&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">branch_fn</span><span class="p">):</span>
            <span class="n">branch0</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">branch_fn</span><span class="p">)</span>
            <span class="n">revision0</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="n">branch_map</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">file</span><span class="p">(</span><span class="n">branch_cache_fn</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">):</span>
                <span class="n">branch1</span><span class="p">,</span> <span class="n">revision1</span>  <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">revision1</span><span class="o">==</span><span class="n">revision0</span><span class="p">:</span>
                    <span class="n">branch0</span> <span class="o">=</span> <span class="n">branch1</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">revision1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">revision1</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">branch_map</span><span class="p">[</span><span class="n">branch1</span><span class="p">]</span> <span class="o">=</span> <span class="n">revision1</span>

            <span class="n">revision</span> <span class="o">=</span> <span class="n">branch_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">branch0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">revision</span>


<div class="viewcode-block" id="Configuration.get_version"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.get_version">[docs]</a>    <span class="k">def</span> <span class="nf">get_version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">version_file</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">version_variable</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Try to get version string of a package.</span>

<span class="sd">        Return a version string of the current package or None if the version</span>
<span class="sd">        information could not be detected.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method scans files named</span>
<span class="sd">        __version__.py, &lt;packagename&gt;_version.py, version.py, and</span>
<span class="sd">        __svn_version__.py for string variables version, __version\__, and</span>
<span class="sd">        &lt;packagename&gt;_version, until a version number is found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">version</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">version</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">version</span>

        <span class="c1"># Get version from version file.</span>
        <span class="k">if</span> <span class="n">version_file</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;__version__.py&#39;</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_version.py&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;version.py&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;__svn_version__.py&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;__hg_version__.py&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">version_file</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">version_variable</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">version_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;__version__&#39;</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_version&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">version_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">version_variable</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
                <span class="n">info</span> <span class="o">=</span> <span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">),</span> <span class="n">fn</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fn</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">dot_join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">version_module</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">load_module</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)),</span><span class="o">*</span><span class="n">info</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="n">get_exception</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
                    <span class="n">version_module</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">if</span> <span class="n">version_module</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">version_vars</span><span class="p">:</span>
                    <span class="n">version</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">version_module</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">version</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">version</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">break</span>

        <span class="k">if</span> <span class="n">version</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">version</span>
            <span class="k">return</span> <span class="n">version</span>

        <span class="c1"># Get version as SVN or Mercurial revision number</span>
        <span class="n">revision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_svn_revision</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">revision</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">revision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hg_revision</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">revision</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">version</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">revision</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">version</span>

        <span class="k">return</span> <span class="n">version</span></div>

<div class="viewcode-block" id="Configuration.make_svn_version_py"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.make_svn_version_py">[docs]</a>    <span class="k">def</span> <span class="nf">make_svn_version_py</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Appends a data function to the data_files list that will generate</span>
<span class="sd">        __svn_version__.py file to the current package directory.</span>

<span class="sd">        Generate package __svn_version__.py file from SVN revision number,</span>
<span class="sd">        it will be removed after python exits but will be available</span>
<span class="sd">        when sdist, etc commands are executed.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If __svn_version__.py existed before, nothing is done.</span>

<span class="sd">        This is</span>
<span class="sd">        intended for working with source directories that are in an SVN</span>
<span class="sd">        repository.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">,</span> <span class="s1">&#39;__svn_version__.py&#39;</span><span class="p">)</span>
        <span class="n">revision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_svn_revision</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="ow">or</span> <span class="n">revision</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">generate_svn_version_py</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
                    <span class="n">version</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">revision</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Creating </span><span class="si">%s</span><span class="s1"> (version=</span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">version</span><span class="p">))</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;version = </span><span class="si">%r</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">version</span><span class="p">))</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="kn">import</span> <span class="nn">atexit</span>
                <span class="k">def</span> <span class="nf">rm_file</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">target</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">delete</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">f</span><span class="p">);</span> <span class="n">p</span><span class="p">(</span><span class="s1">&#39;removed &#39;</span><span class="o">+</span><span class="n">f</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span> <span class="k">pass</span>
                        <span class="k">try</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">f</span><span class="o">+</span><span class="s1">&#39;c&#39;</span><span class="p">);</span> <span class="n">p</span><span class="p">(</span><span class="s1">&#39;removed &#39;</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span> <span class="k">pass</span>

                <span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">rm_file</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">target</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_data_files</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">generate_svn_version_py</span><span class="p">()))</span></div>

    <span class="k">def</span> <span class="nf">make_hg_version_py</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Appends a data function to the data_files list that will generate</span>
<span class="sd">        __hg_version__.py file to the current package directory.</span>

<span class="sd">        Generate package __hg_version__.py file from Mercurial revision,</span>
<span class="sd">        it will be removed after python exits but will be available</span>
<span class="sd">        when sdist, etc commands are executed.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If __hg_version__.py existed before, nothing is done.</span>

<span class="sd">        This is intended for working with source directories that are</span>
<span class="sd">        in an Mercurial repository.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">njoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">,</span> <span class="s1">&#39;__hg_version__.py&#39;</span><span class="p">)</span>
        <span class="n">revision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hg_revision</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">local_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="ow">or</span> <span class="n">revision</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">generate_hg_version_py</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
                    <span class="n">version</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">revision</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Creating </span><span class="si">%s</span><span class="s1"> (version=</span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">version</span><span class="p">))</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;version = </span><span class="si">%r</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">version</span><span class="p">))</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="kn">import</span> <span class="nn">atexit</span>
                <span class="k">def</span> <span class="nf">rm_file</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">target</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">delete</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">f</span><span class="p">);</span> <span class="n">p</span><span class="p">(</span><span class="s1">&#39;removed &#39;</span><span class="o">+</span><span class="n">f</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span> <span class="k">pass</span>
                        <span class="k">try</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">f</span><span class="o">+</span><span class="s1">&#39;c&#39;</span><span class="p">);</span> <span class="n">p</span><span class="p">(</span><span class="s1">&#39;removed &#39;</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span> <span class="k">pass</span>

                <span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">rm_file</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">target</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_data_files</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">generate_hg_version_py</span><span class="p">()))</span>

<div class="viewcode-block" id="Configuration.make_config_py"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.make_config_py">[docs]</a>    <span class="k">def</span> <span class="nf">make_config_py</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;__config__&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate package __config__.py file containing system_info</span>
<span class="sd">        information used during building the package.</span>

<span class="sd">        This file is installed to the</span>
<span class="sd">        package installation directory.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">py_modules</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">generate_config_py</span><span class="p">))</span></div>


<div class="viewcode-block" id="Configuration.get_info"><a class="viewcode-back" href="../../../reference/distutils.html#numpy.distutils.misc_util.Configuration.get_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">names</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get resources information.</span>

<span class="sd">        Return information (from system_info.get_info) for all of the names in</span>
<span class="sd">        the argument list in a single dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.system_info</span> <span class="kn">import</span> <span class="n">get_info</span><span class="p">,</span> <span class="n">dict_append</span>
        <span class="n">info_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="n">dict_append</span><span class="p">(</span><span class="n">info_dict</span><span class="p">,</span><span class="o">**</span><span class="n">get_info</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">info_dict</span></div></div>


<div class="viewcode-block" id="get_cmd"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.get_cmd.html#numpy.distutils.misc_util.get_cmd">[docs]</a><span class="k">def</span> <span class="nf">get_cmd</span><span class="p">(</span><span class="n">cmdname</span><span class="p">,</span> <span class="n">_cache</span><span class="o">=</span><span class="p">{}):</span>
    <span class="k">if</span> <span class="n">cmdname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_cache</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">distutils.core</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">distutils</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">_setup_distribution</span>
        <span class="k">if</span> <span class="n">dist</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">distutils.errors</span> <span class="kn">import</span> <span class="n">DistutilsInternalError</span>
            <span class="k">raise</span> <span class="n">DistutilsInternalError</span><span class="p">(</span>
                  <span class="s1">&#39;setup distribution instance not initialized&#39;</span><span class="p">)</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">get_command_obj</span><span class="p">(</span><span class="n">cmdname</span><span class="p">)</span>
        <span class="n">_cache</span><span class="p">[</span><span class="n">cmdname</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmd</span>
    <span class="k">return</span> <span class="n">_cache</span><span class="p">[</span><span class="n">cmdname</span><span class="p">]</span></div>

<div class="viewcode-block" id="get_numpy_include_dirs"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.get_numpy_include_dirs.html#numpy.distutils.misc_util.get_numpy_include_dirs">[docs]</a><span class="k">def</span> <span class="nf">get_numpy_include_dirs</span><span class="p">():</span>
    <span class="c1"># numpy_include_dirs are set by numpy/core/setup.py, otherwise []</span>
    <span class="n">include_dirs</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">numpy_include_dirs</span><span class="p">[:]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">include_dirs</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">numpy</span>
        <span class="n">include_dirs</span> <span class="o">=</span> <span class="p">[</span> <span class="n">numpy</span><span class="o">.</span><span class="n">get_include</span><span class="p">()</span> <span class="p">]</span>
    <span class="c1"># else running numpy/core/setup.py</span>
    <span class="k">return</span> <span class="n">include_dirs</span></div>

<span class="k">def</span> <span class="nf">get_npy_pkg_dir</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Return the path where to find the npy-pkg-config directory.&quot;&quot;&quot;</span>
    <span class="c1"># XXX: import here for bootstrapping reasons</span>
    <span class="kn">import</span> <span class="nn">numpy</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">__file__</span><span class="p">),</span>
            <span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;lib&#39;</span><span class="p">,</span> <span class="s1">&#39;npy-pkg-config&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">d</span>

<span class="k">def</span> <span class="nf">get_pkg_info</span><span class="p">(</span><span class="n">pkgname</span><span class="p">,</span> <span class="n">dirs</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return library info for the given package.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pkgname : str</span>
<span class="sd">        Name of the package (should match the name of the .ini file, without</span>
<span class="sd">        the extension, e.g. foo for the file foo.ini).</span>
<span class="sd">    dirs : sequence, optional</span>
<span class="sd">        If given, should be a sequence of additional directories where to look</span>
<span class="sd">        for npy-pkg-config files. Those directories are searched prior to the</span>
<span class="sd">        NumPy directory.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pkginfo : class instance</span>
<span class="sd">        The `LibraryInfo` instance containing the build information.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    PkgNotFound</span>
<span class="sd">        If the package is not found.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Configuration.add_npy_pkg_config, Configuration.add_installed_library,</span>
<span class="sd">    get_info</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">numpy.distutils.npy_pkg_config</span> <span class="kn">import</span> <span class="n">read_config</span>

    <span class="k">if</span> <span class="n">dirs</span><span class="p">:</span>
        <span class="n">dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_npy_pkg_dir</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_npy_pkg_dir</span><span class="p">()]</span>
    <span class="k">return</span> <span class="n">read_config</span><span class="p">(</span><span class="n">pkgname</span><span class="p">,</span> <span class="n">dirs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="n">pkgname</span><span class="p">,</span> <span class="n">dirs</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return an info dict for a given C library.</span>

<span class="sd">    The info dict contains the necessary options to use the C library.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pkgname : str</span>
<span class="sd">        Name of the package (should match the name of the .ini file, without</span>
<span class="sd">        the extension, e.g. foo for the file foo.ini).</span>
<span class="sd">    dirs : sequence, optional</span>
<span class="sd">        If given, should be a sequence of additional directories where to look</span>
<span class="sd">        for npy-pkg-config files. Those directories are searched prior to the</span>
<span class="sd">        NumPy directory.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    info : dict</span>
<span class="sd">        The dictionary with build information.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    PkgNotFound</span>
<span class="sd">        If the package is not found.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Configuration.add_npy_pkg_config, Configuration.add_installed_library,</span>
<span class="sd">    get_pkg_info</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    To get the necessary information for the npymath library from NumPy:</span>

<span class="sd">    &gt;&gt;&gt; npymath_info = np.distutils.misc_util.get_info(&#39;npymath&#39;)</span>
<span class="sd">    &gt;&gt;&gt; npymath_info                                    #doctest: +SKIP</span>
<span class="sd">    {&#39;define_macros&#39;: [], &#39;libraries&#39;: [&#39;npymath&#39;], &#39;library_dirs&#39;:</span>
<span class="sd">    [&#39;.../numpy/core/lib&#39;], &#39;include_dirs&#39;: [&#39;.../numpy/core/include&#39;]}</span>

<span class="sd">    This info dict can then be used as input to a `Configuration` instance::</span>

<span class="sd">      config.add_extension(&#39;foo&#39;, sources=[&#39;foo.c&#39;], extra_info=npymath_info)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">numpy.distutils.npy_pkg_config</span> <span class="kn">import</span> <span class="n">parse_flags</span>
    <span class="n">pkg_info</span> <span class="o">=</span> <span class="n">get_pkg_info</span><span class="p">(</span><span class="n">pkgname</span><span class="p">,</span> <span class="n">dirs</span><span class="p">)</span>

    <span class="c1"># Translate LibraryInfo instance into a build_info dict</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">parse_flags</span><span class="p">(</span><span class="n">pkg_info</span><span class="o">.</span><span class="n">cflags</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">parse_flags</span><span class="p">(</span><span class="n">pkg_info</span><span class="o">.</span><span class="n">libs</span><span class="p">())</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">info</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="c1"># add_extension extra_info argument is ANAL</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;define_macros&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;macros&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;macros&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ignored&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">info</span>

<span class="k">def</span> <span class="nf">is_bootstrapping</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">builtins</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">__builtin__</span> <span class="kn">as</span> <span class="nn">builtins</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">builtins</span><span class="o">.</span><span class="n">__NUMPY_SETUP__</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
        <span class="n">__NUMPY_SETUP__</span> <span class="o">=</span> <span class="bp">False</span>


<span class="c1">#########################</span>

<span class="k">def</span> <span class="nf">default_config_dict</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">parent_name</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">local_path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a configuration dictionary for usage in</span>
<span class="sd">    configuration() function defined in file setup_&lt;name&gt;.py.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">warnings</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Use Configuration(</span><span class="si">%r</span><span class="s1">,</span><span class="si">%r</span><span class="s1">,top_path=</span><span class="si">%r</span><span class="s1">) instead of &#39;</span>\
                  <span class="s1">&#39;deprecated default_config_dict(</span><span class="si">%r</span><span class="s1">,</span><span class="si">%r</span><span class="s1">,</span><span class="si">%r</span><span class="s1">)&#39;</span>
                  <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent_name</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span>
                     <span class="n">name</span><span class="p">,</span> <span class="n">parent_name</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span>
                     <span class="p">))</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">Configuration</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent_name</span><span class="p">,</span> <span class="n">local_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">todict</span><span class="p">()</span>


<div class="viewcode-block" id="dict_append"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.dict_append.html#numpy.distutils.misc_util.dict_append">[docs]</a><span class="k">def</span> <span class="nf">dict_append</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kws</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">ov</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ov</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span></div>

<div class="viewcode-block" id="appendpath"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.appendpath.html#numpy.distutils.misc_util.appendpath">[docs]</a><span class="k">def</span> <span class="nf">appendpath</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
    <span class="n">drive</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">drive</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitdrive</span><span class="p">(</span><span class="n">prefix</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">absprefix</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitdrive</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">prefix</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">pathdrive</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitdrive</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">commonprefix</span><span class="p">([</span><span class="n">absprefix</span><span class="p">,</span> <span class="n">path</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">absprefix</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)],</span> <span class="n">absprefix</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">):])</span> <span class="o">!=</span> <span class="n">absprefix</span> \
           <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)],</span> <span class="n">path</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">):])</span> <span class="o">!=</span> <span class="n">path</span><span class="p">:</span>
            <span class="c1"># Handle invalid paths</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">subpath</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">):]</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">subpath</span><span class="p">):</span>
            <span class="n">subpath</span> <span class="o">=</span> <span class="n">subpath</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">subpath</span> <span class="o">=</span> <span class="n">path</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">njoin</span><span class="p">(</span><span class="n">drive</span> <span class="o">+</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">subpath</span><span class="p">))</span></div>

<div class="viewcode-block" id="generate_config_py"><a class="viewcode-back" href="../../../reference/generated/numpy.distutils.misc_util.generate_config_py.html#numpy.distutils.misc_util.generate_config_py">[docs]</a><span class="k">def</span> <span class="nf">generate_config_py</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate config.py file containing system_info information</span>
<span class="sd">    used during building the package.</span>

<span class="sd">    Usage:</span>
<span class="sd">        config[&#39;py_modules&#39;].append((packagename, &#39;__config__&#39;,generate_config_py))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">numpy.distutils.system_info</span> <span class="kn">import</span> <span class="n">system_info</span>
    <span class="kn">from</span> <span class="nn">distutils.dir_util</span> <span class="kn">import</span> <span class="n">mkpath</span>
    <span class="n">mkpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# This file is generated by </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# It contains system_info results at the time of building this package.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;__all__ = [&quot;get_info&quot;,&quot;show&quot;]</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">system_info</span><span class="o">.</span><span class="n">saved_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">=</span><span class="si">%r</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">r&#39;&#39;&#39;</span>
<span class="s1">def get_info(name):</span>
<span class="s1">    g = globals()</span>
<span class="s1">    return g.get(name, g.get(name + &quot;_info&quot;, {}))</span>

<span class="s1">def show():</span>
<span class="s1">    for name,info_dict in globals().items():</span>
<span class="s1">        if name[0] == &quot;_&quot; or type(info_dict) is not type({}): continue</span>
<span class="s1">        print(name + &quot;:&quot;)</span>
<span class="s1">        if not info_dict:</span>
<span class="s1">            print(&quot;  NOT AVAILABLE&quot;)</span>
<span class="s1">        for k,v in info_dict.items():</span>
<span class="s1">            v = str(v)</span>
<span class="s1">            if k == &quot;sources&quot; and len(v) &gt; 200:</span>
<span class="s1">                v = v[:60] + &quot; ...\n... &quot; + v[-60:]</span>
<span class="s1">            print(&quot;    </span><span class="si">%s</span><span class="s1"> = </span><span class="si">%s</span><span class="s1">&quot; % (k,v))</span>
<span class="s1">    &#39;&#39;&#39;</span><span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">target</span></div>

<span class="k">def</span> <span class="nf">msvc_version</span><span class="p">(</span><span class="n">compiler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return version major and minor of compiler instance if it is</span>
<span class="sd">    MSVC, raise an exception otherwise.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compiler</span><span class="o">.</span><span class="n">compiler_type</span> <span class="o">==</span> <span class="s2">&quot;msvc&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Compiler instance is not msvc (</span><span class="si">%s</span><span class="s2">)&quot;</span>\
                         <span class="o">%</span> <span class="n">compiler</span><span class="o">.</span><span class="n">compiler_type</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">compiler</span><span class="o">.</span><span class="n">_MSVCCompiler__version</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s1">&#39;2.5&#39;</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">get_build_architecture</span><span class="p">():</span>
        <span class="kn">from</span> <span class="nn">distutils.msvccompiler</span> <span class="kn">import</span> <span class="n">get_build_architecture</span>
        <span class="k">return</span> <span class="n">get_build_architecture</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1">#copied from python 2.5.1 distutils/msvccompiler.py</span>
    <span class="k">def</span> <span class="nf">get_build_architecture</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Return the processor architecture.</span>

<span class="sd">        Possible results are &quot;Intel&quot;, &quot;Itanium&quot;, or &quot;AMD64&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot; bit (&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Intel&quot;</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span><span class="n">j</span><span class="p">]</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>